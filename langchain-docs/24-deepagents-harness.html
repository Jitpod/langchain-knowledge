<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="DeepAgents Harness ç³»ç»Ÿ - Agent è¿è¡Œæ—¶æ¡†æ¶å’Œç”Ÿäº§çº§ç‰¹æ€§">
    <title>DeepAgents Harness ç³»ç»Ÿ | LangChain 1.0 Python çŸ¥è¯†æ–‡æ¡£</title>
    <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
    <button class="mobile-menu-button" aria-label="æ‰“å¼€èœå•">â˜°</button>

    <div class="container">
        <!-- ä¾§è¾¹æ å¯¼èˆª -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <h1 class="sidebar-title">ğŸ¦œ LangChain 1.0</h1>
                <p class="sidebar-subtitle">Python å®Œæ•´å­¦ä¹ æŒ‡å—</p>
            </div>

            <ul class="nav-menu">
                <li class="nav-section">
                    <div class="nav-section-title">å¼€å§‹</div>
                    <ul>
                        <li class="nav-item">
                            <a href="index.html" class="nav-link">
                                <span class="nav-icon">ğŸ </span>
                                ä¸»é¡µ
                            </a>
                        </li>
                    </ul>
                </li>

                <li class="nav-section">
                    <div class="nav-section-title">åŸºç¡€ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="01-introduction.html" class="nav-link">
                                <span class="nav-icon">ğŸ“–</span>
                                LangChain ç®€ä»‹
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="02-architecture.html" class="nav-link">
                                <span class="nav-icon">ğŸ—ï¸</span>
                                æ ¸å¿ƒæ¶æ„
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="03-models.html" class="nav-link">
                                <span class="nav-icon">ğŸ¤–</span>
                                æ¨¡å‹æ¥å£
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="04-messages.html" class="nav-link">
                                <span class="nav-icon">ğŸ’¬</span>
                                æ¶ˆæ¯ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="05-tools.html" class="nav-link">
                                <span class="nav-icon">ğŸ”§</span>
                                å·¥å…·ç³»ç»Ÿ
                            </a>
                        </li>
                    </ul>
                </li>

                <li class="nav-section">
                    <div class="nav-section-title">è¿›é˜¶ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="06-agents.html" class="nav-link">
                                <span class="nav-icon">ğŸ¯</span>
                                Agent åŸºç¡€
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="07-middleware.html" class="nav-link">
                                <span class="nav-icon">âš™ï¸</span>
                                ä¸­é—´ä»¶ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="08-rag.html" class="nav-link">
                                <span class="nav-icon">ğŸ”</span>
                                RAG è¯¦è§£
                                <span class="nav-badge">é‡ç‚¹</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="09-lcel.html" class="nav-link">
                                <span class="nav-icon">ğŸ”—</span>
                                LCEL è¡¨è¾¾å¼
                            </a>
                        </li>
                    </ul>
                </li>

                <li class="nav-section">
                    <div class="nav-section-title">é«˜çº§åº”ç”¨</div>
                    <ul>
                        <li class="nav-item">
                            <a href="10-runtime.html" class="nav-link">
                                <span class="nav-icon">ğŸ”Œ</span>
                                Runtime ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="11-checkpointer.html" class="nav-link">
                                <span class="nav-icon">ğŸ’¾</span>
                                æŒä¹…åŒ–ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="12-streaming.html" class="nav-link">
                                <span class="nav-icon">ğŸŒŠ</span>
                                æµå¼è¾“å‡º
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="13-human-in-loop.html" class="nav-link">
                                <span class="nav-icon">ğŸ‘¤</span>
                                äººå·¥ä»‹å…¥
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="14-long-term-memory.html" class="nav-link">
                                <span class="nav-icon">ğŸ—„ï¸</span>
                                é•¿æœŸè®°å¿†
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="15-langgraph.html" class="nav-link">
                                <span class="nav-icon">ğŸ“Š</span>
                                LangGraph
                            </a>
                        </li>
                    </ul>
                </li>

                <li class="nav-section">
                    <div class="nav-section-title">å®æˆ˜ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="16-customer-service.html" class="nav-link">
                                <span class="nav-icon">ğŸ‘¥</span>
                                å®¢æœæœºå™¨äºº
                                <span class="nav-badge">é‡ç‚¹</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="17-best-practices.html" class="nav-link">
                                <span class="nav-icon">âœ¨</span>
                                æœ€ä½³å®è·µ
                            </a>
                        </li>
                    </ul>
                </li>

                <li class="nav-section">
                    <div class="nav-section-title">å‚è€ƒç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="18-api-reference.html" class="nav-link">
                                <span class="nav-icon">ğŸ“š</span>
                                API é€ŸæŸ¥è¡¨
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="19-troubleshooting.html" class="nav-link">
                                <span class="nav-icon">ğŸ›</span>
                                æ•…éšœæ’é™¤
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="20-migration.html" class="nav-link">
                                <span class="nav-icon">ğŸ”„</span>
                                è¿ç§»æŒ‡å—
                            </a>
                        </li>
                    </ul>
                </li>

                <li class="nav-section">
                    <div class="nav-section-title">æ‰©å±•ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="21-structured-output.html" class="nav-link">
                                <span class="nav-icon">ğŸ“Š</span>
                                ç»“æ„åŒ–è¾“å‡º
                            </a>
                        </li>
                    </ul>
                </li>

                <li class="nav-section">
                    <div class="nav-section-title">DeepAgents ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="22-deepagents-quickstart.html" class="nav-link">
                                <span class="nav-icon">ğŸš€</span>
                                å¿«é€Ÿå¼€å§‹
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="23-deepagents-customization.html" class="nav-link">
                                <span class="nav-icon">ğŸ¨</span>
                                å®šåˆ¶åŒ–
                            </a>
                        </li>
                        <li class="nav-item active">
                            <a href="24-deepagents-harness.html" class="nav-link">
                                <span class="nav-icon">ğŸ›ï¸</span>
                                Harness ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="25-deepagents-backends.html" class="nav-link">
                                <span class="nav-icon">ğŸ”§</span>
                                åç«¯é…ç½®
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="26-deepagents-subagents.html" class="nav-link">
                                <span class="nav-icon">ğŸ‘¥</span>
                                å­ä»£ç†
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="27-deepagents-hitl.html" class="nav-link">
                                <span class="nav-icon">ğŸ¤</span>
                                äººå·¥ä»‹å…¥
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="28-deepagents-memory.html" class="nav-link">
                                <span class="nav-icon">ğŸ§ </span>
                                é•¿æœŸè®°å¿†
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="29-deepagents-middleware.html" class="nav-link">
                                <span class="nav-icon">âš™ï¸</span>
                                ä¸­é—´ä»¶
                            </a>
                        </li>
                    </ul>
                </li>

                <li class="nav-section">
                    <div class="nav-section-title">Multi-Agent ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="30-multi-agent-index.html" class="nav-link">
                                <span class="nav-icon">ğŸŒ</span>
                                æ¦‚è¿°
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="31-multi-agent-subagents.html" class="nav-link">
                                <span class="nav-icon">ğŸ‘¥</span>
                                å­ä»£ç†
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="32-multi-agent-handoffs.html" class="nav-link">
                                <span class="nav-icon">ğŸ”„</span>
                                äº¤æ¥æœºåˆ¶
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="33-multi-agent-skills.html" class="nav-link">
                                <span class="nav-icon">ğŸ¯</span>
                                æŠ€èƒ½ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="34-multi-agent-router.html" class="nav-link">
                                <span class="nav-icon">ğŸ§­</span>
                                è·¯ç”±æœºåˆ¶
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="35-multi-agent-workflow.html" class="nav-link">
                                <span class="nav-icon">ğŸ”€</span>
                                è‡ªå®šä¹‰å·¥ä½œæµ
                            </a>
                        </li>
                    </ul>
                </li>
            </ul>
        </nav>

        <!-- ä¸»å†…å®¹åŒºåŸŸ -->
        <main class="main-content">
            <div class="content-wrapper">
                <!-- é¢åŒ…å±‘å¯¼èˆª -->
                <nav class="breadcrumb">
                    <span class="breadcrumb-item">
                        <a href="index.html" class="breadcrumb-link">ä¸»é¡µ</a>
                    </span>
                    <span class="breadcrumb-item">
                        DeepAgents ç¯‡
                    </span>
                    <span class="breadcrumb-item">
                        Harness ç³»ç»Ÿ
                    </span>
                </nav>

                <!-- é¡µé¢æ ‡é¢˜ -->
                <header class="page-header">
                    <h1 class="page-title">ğŸ›ï¸ DeepAgents Harness ç³»ç»Ÿ</h1>
                    <p class="page-subtitle">
                        ç”Ÿäº§çº§ Agent è¿è¡Œæ—¶æ¡†æ¶ï¼Œæä¾›æ–‡ä»¶ç³»ç»Ÿç®¡ç†ã€ä¸Šä¸‹æ–‡ä¼˜åŒ–ã€
                        å­ä»£ç†å§”æ´¾ã€äººå·¥ä»‹å…¥ç­‰ä¼ä¸šçº§ç‰¹æ€§ï¼Œè®© Agent å¯é ã€é«˜æ•ˆåœ°è¿è¡Œã€‚
                    </p>
                </header>

                <!-- ä»€ä¹ˆæ˜¯ Harness --><section class="content-section">
                    <h2 class="section-title">ğŸ“š ä»€ä¹ˆæ˜¯ Harnessï¼Ÿ</h2>
                    <p>
                        <strong>Harness</strong>ï¼ˆä»£ç†æ¡†æ¶ï¼‰æ˜¯ DeepAgents çš„<strong>è¿è¡Œæ—¶ç¯å¢ƒ</strong>ï¼Œ
                        å®ƒä¸æ˜¯ä¸€ä¸ªç®€å•çš„æ¡†æ¶ï¼Œè€Œæ˜¯ä¸€ä¸ªå®Œæ•´çš„<strong>ç”Ÿäº§çº§ Agent æ‰§è¡Œå¼•æ“</strong>ã€‚
                    </p>

                    <div class="info-box note">
                        <div class="info-box-title">ğŸ’¡ Harness æ ¸å¿ƒç‰¹æ€§</div>
                        <table style="margin-top: 0.5rem;">
                            <thead>
                                <tr>
                                    <th>ç‰¹æ€§</th>
                                    <th>è¯´æ˜</th>
                                    <th>åº”ç”¨åœºæ™¯</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>æ–‡ä»¶ç³»ç»Ÿå·¥å…·</strong></td>
                                    <td>6 ä¸ªå†…ç½®æ–‡ä»¶æ“ä½œå·¥å…·</td>
                                    <td>æ–‡æ¡£å¤„ç†ã€ä»£ç å·¥ä½œ</td>
                                </tr>
                                <tr>
                                    <td><strong>å¤§ç»“æœé©±é€</strong></td>
                                    <td>è‡ªåŠ¨ç®¡ç†è¶…å¤§å·¥å…·è¾“å‡ºï¼ˆ20,000 Tokenï¼‰</td>
                                    <td>é¿å…ä¸Šä¸‹æ–‡æº¢å‡º</td>
                                </tr>
                                <tr>
                                    <td><strong>å­˜å‚¨æŠ½è±¡</strong></td>
                                    <td>4 ç§å¯æ’æ‹”å­˜å‚¨åç«¯</td>
                                    <td>ä¸´æ—¶æ•°æ® + æŒä¹…åŒ–</td>
                                </tr>
                                <tr>
                                    <td><strong>å­ä»£ç†å§”æ´¾</strong></td>
                                    <td>é€šè¿‡ task å·¥å…·åˆ›å»ºä¸“é—¨åŒ– Agent</td>
                                    <td>ä»»åŠ¡åˆ†è§£ã€å¹¶è¡Œæ‰§è¡Œ</td>
                                </tr>
                                <tr>
                                    <td><strong>å†å²æ‘˜è¦</strong></td>
                                    <td>170,000 Token è‡ªåŠ¨å‹ç¼©å¯¹è¯å†å²</td>
                                    <td>é•¿æœŸè¿è¡Œ Agent</td>
                                </tr>
                                <tr>
                                    <td><strong>å·¥å…·è°ƒç”¨ä¿®å¤</strong></td>
                                    <td>æ£€æµ‹å¹¶ä¿®å¤æ‚¬ç©ºå·¥å…·è°ƒç”¨</td>
                                    <td>ä¿è¯å¯¹è¯è¿è´¯æ€§</td>
                                </tr>
                                <tr>
                                    <td><strong>å¾…åŠåˆ—è¡¨</strong></td>
                                    <td>write_todos å·¥å…·è¿½è¸ªä»»åŠ¡è¿›åº¦</td>
                                    <td>å¤æ‚å·¥ä½œæµç®¡ç†</td>
                                </tr>
                                <tr>
                                    <td><strong>äººå·¥ä»‹å…¥</strong></td>
                                    <td>ç‰¹å®šå·¥å…·è°ƒç”¨å‰æš‚åœç­‰å¾…å®¡æ‰¹</td>
                                    <td>å®‰å…¨é—¨æ§ã€æˆæœ¬æ§åˆ¶</td>
                                </tr>
                                <tr>
                                    <td><strong>æç¤ºè¯ç¼“å­˜</strong></td>
                                    <td>Anthropic æ¨¡å‹ç¼“å­˜ç³»ç»Ÿæç¤ºè¯</td>
                                    <td>10 å€åŠ é€Ÿå’Œæˆæœ¬é™ä½</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="info-box tip">
                        <div class="info-box-title">âœ¨ Harness æ ¸å¿ƒç†å¿µ</div>
                        <p>
                            Harness å®ç°äº†<strong>"æ ‡å‡†å·¥å…·è°ƒç”¨å¾ªç¯ + ç”Ÿäº§çº§å¢å¼º"</strong>çš„ç†å¿µï¼š
                        </p>
                        <ul>
                            <li><strong>æ ¸å¿ƒå¾ªç¯</strong>ï¼šæ ‡å‡†çš„è¯·æ±‚ â†’ å·¥å…·è°ƒç”¨ â†’ ç»“æœå¤„ç†</li>
                            <li><strong>å¢å¼ºå±‚</strong>ï¼šè‡ªåŠ¨ç»“æœç›‘æ§ã€Token ç®¡ç†ã€ä¸Šä¸‹æ–‡ä¼˜åŒ–ã€é”™è¯¯æ¢å¤</li>
                            <li><strong>å­˜å‚¨æŠ½è±¡</strong>ï¼šå¯æ’æ‹”çš„åç«¯ç­–ç•¥ï¼Œæ— éœ€æ”¹ä»£ç å³å¯åˆ‡æ¢</li>
                        </ul>
                    </div>
                </section>

                <!-- Harness æ¶æ„ -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ—ï¸ Harness æ¶æ„</h2>
                    <p>
                        Harness é‡‡ç”¨<strong>åˆ†å±‚æ¶æ„</strong>ï¼Œåœ¨æ ‡å‡† Agent æ‰§è¡Œå¾ªç¯ä¹‹ä¸Š
                        æ·»åŠ äº†å¤šä¸ªå¢å¼ºå±‚ï¼š
                    </p>

                    <div class="mermaid-wrapper">
                        <div class="mermaid">
graph TB
    User["ç”¨æˆ·è¯·æ±‚"] --> Core["æ ¸å¿ƒå·¥å…·è°ƒç”¨å¾ªç¯<br/>Agent æ‰§è¡Œå¼•æ“"]

    Core --> Enhance["å¢å¼ºå±‚"]

    Enhance --> FileTools["æ–‡ä»¶ç³»ç»Ÿå·¥å…·<br/>ls, read, write, edit, glob, grep"]
    Enhance --> ResultEviction["å¤§ç»“æœé©±é€<br/>>20K Token è‡ªåŠ¨å†™å…¥å­˜å‚¨"]
    Enhance --> History["å†å²æ‘˜è¦<br/>170K Token è‡ªåŠ¨å‹ç¼©"]
    Enhance --> Repair["å·¥å…·è°ƒç”¨ä¿®å¤<br/>æ‚¬ç©ºè°ƒç”¨å¤„ç†"]

    FileTools --> Storage["å­˜å‚¨æŠ½è±¡å±‚"]
    ResultEviction --> Storage

    Storage --> State["StateBackend<br/>å†…å­˜å­˜å‚¨"]
    Storage --> FS["FilesystemBackend<br/>ç£ç›˜å­˜å‚¨"]
    Storage --> Store["StoreBackend<br/>æŒä¹…åŒ–å­˜å‚¨"]
    Storage --> Composite["CompositeBackend<br/>æ··åˆè·¯ç”±"]

    Core --> Advanced["é«˜çº§ç‰¹æ€§"]
    Advanced --> Subagents["å­ä»£ç†å§”æ´¾<br/>task å·¥å…·"]
    Advanced --> HITL["äººå·¥ä»‹å…¥<br/>å®¡æ‰¹é—¨æ§"]
    Advanced --> Caching["æç¤ºè¯ç¼“å­˜<br/>Anthropic åŠ é€Ÿ"]
    Advanced --> Todos["å¾…åŠåˆ—è¡¨<br/>write_todos"]

    style Core fill:#3b82f6,color:#fff
    style Enhance fill:#10b981,color:#fff
    style Storage fill:#f59e0b,color:#fff
    style Advanced fill:#8b5cf6,color:#fff
                        </div>
                    </div>
                </section>

                <!-- æ–‡ä»¶ç³»ç»Ÿå·¥å…· -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ“ æ–‡ä»¶ç³»ç»Ÿå·¥å…·</h2>
                    <p>
                        Harness æä¾›<strong>6 ä¸ªå†…ç½®æ–‡ä»¶æ“ä½œå·¥å…·</strong>ï¼Œè®© Agent å¯ä»¥
                        åƒæ“ä½œæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸€æ ·ç®¡ç†æ•°æ®ï¼š
                    </p>

                    <table>
                        <thead>
                            <tr>
                                <th>å·¥å…·</th>
                                <th>åŠŸèƒ½</th>
                                <th>å…¸å‹ç”¨é€”</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>ls</code></td>
                                <td>åˆ—å‡ºç›®å½•å†…å®¹ï¼ˆå¸¦å…ƒæ•°æ®ï¼‰</td>
                                <td>æµè§ˆæ–‡ä»¶ç»“æ„ã€æŸ¥çœ‹å¤§å°å’Œä¿®æ”¹æ—¶é—´</td>
                            </tr>
                            <tr>
                                <td><code>read_file</code></td>
                                <td>è¯»å–æ–‡ä»¶å†…å®¹ï¼ˆå¸¦è¡Œå·å’Œåç§»ï¼‰</td>
                                <td>åŠ è½½å·²ä¿å­˜çš„æœç´¢ç»“æœã€è¯»å–ä¸­é—´æ•°æ®</td>
                            </tr>
                            <tr>
                                <td><code>write_file</code></td>
                                <td>åˆ›å»ºæ–°æ–‡ä»¶</td>
                                <td>ä¿å­˜å¤§é‡å·¥å…·è¾“å‡ºã€ä¸´æ—¶æ•°æ®</td>
                            </tr>
                            <tr>
                                <td><code>edit_file</code></td>
                                <td>ç²¾ç¡®å­—ç¬¦ä¸²æ›¿æ¢ï¼ˆæ”¯æŒå…¨å±€æ›¿æ¢ï¼‰</td>
                                <td>ä¿®æ”¹é…ç½®ã€æ›´æ–°å·²ä¿å­˜æ•°æ®</td>
                            </tr>
                            <tr>
                                <td><code>glob</code></td>
                                <td>åŸºäºæ¨¡å¼çš„æ–‡ä»¶å‘ç°</td>
                                <td>æŸ¥æ‰¾ç‰¹å®šç±»å‹çš„æ–‡ä»¶ï¼ˆ*.txt, **/*.jsonï¼‰</td>
                            </tr>
                            <tr>
                                <td><code>grep</code></td>
                                <td>å†…å®¹æœç´¢ï¼ˆå¤šç§è¾“å‡ºæ¨¡å¼ï¼‰</td>
                                <td>åœ¨æ–‡ä»¶ä¸­æœç´¢å…³é”®å­—ã€æå–ä¿¡æ¯</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty basic">ğŸŸ¢ åŸºç¡€</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
æ–‡ä»¶ç³»ç»Ÿå·¥å…· - Agent è‡ªåŠ¨ä½¿ç”¨ç¤ºä¾‹
"""
from deepagents import create_deep_agent

# åˆ›å»º Agentï¼ˆæ–‡ä»¶ç³»ç»Ÿå·¥å…·è‡ªåŠ¨å¯ç”¨ï¼‰
agent = create_deep_agent(
    model="gpt-4o",
    system_prompt="""ä½ æ˜¯æ•°æ®åˆ†æåŠ©æ‰‹ã€‚ä½ å¯ä»¥ï¼š

1. ä½¿ç”¨ write_file ä¿å­˜å¤§é‡æœç´¢ç»“æœ
2. ä½¿ç”¨ read_file åŠ è½½å·²ä¿å­˜çš„æ•°æ®è¿›è¡Œåˆ†æ
3. ä½¿ç”¨ ls æŸ¥çœ‹å·²ä¿å­˜çš„æ–‡ä»¶
4. ä½¿ç”¨ edit_file æ›´æ–°æ•°æ®
5. ä½¿ç”¨ glob æŸ¥æ‰¾ç‰¹å®šæ–‡ä»¶
6. ä½¿ç”¨ grep æœç´¢æ–‡ä»¶å†…å®¹

å·¥ä½œæµç¨‹ï¼š
- æ”¶é›†æ•°æ® â†’ write_file ä¿å­˜
- åˆ†ææ•°æ® â†’ read_file è¯»å–
- æ›´æ–°æ•°æ® â†’ edit_file ä¿®æ”¹
"""
)

# Agent ä¼šè‡ªåŠ¨ä½¿ç”¨æ–‡ä»¶å·¥å…·ç®¡ç†æ•°æ®
result = agent.invoke({
    "messages": [{
        "role": "user",
        "content": "æ”¶é›† 2024 å¹´ AI ç ”ç©¶çš„æœ€æ–°è¿›å±•ï¼Œä¿å­˜åˆ°æ–‡ä»¶ï¼Œç„¶ååˆ†æè¶‹åŠ¿"
    }]
})

# Agent æ‰§è¡Œæµç¨‹ï¼š
# 1. ä½¿ç”¨ç½‘ç»œæœç´¢æ”¶é›†ä¿¡æ¯
# 2. ä½¿ç”¨ write_file ä¿å­˜å¤§é‡æ•°æ®ï¼ˆé¿å…ä¸Šä¸‹æ–‡æº¢å‡ºï¼‰
# 3. ä½¿ç”¨ read_file é€æ­¥è¯»å–å’Œåˆ†æ
# 4. ç”Ÿæˆæœ€ç»ˆæŠ¥å‘Š</code></pre>
                    </div>
                </section>

                <!-- å­˜å‚¨åç«¯ -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ’¾ å­˜å‚¨åç«¯</h2>
                    <p>
                        Harness æä¾›<strong>4 ç§å¯æ’æ‹”çš„å­˜å‚¨åç«¯</strong>ï¼Œ
                        æ”¯æŒä¸åŒçš„æ•°æ®æŒä¹…åŒ–ç­–ç•¥ï¼š
                    </p>

                    <h3 class="subsection-title">1. StateBackendï¼ˆå†…å­˜å­˜å‚¨ï¼‰</h3>
                    <p>
                        <strong>ä¸´æ—¶å†…å­˜å­˜å‚¨</strong>ï¼Œæ•°æ®ä¿å­˜åœ¨ Agent çŠ¶æ€ä¸­ï¼Œ
                        éšå¯¹è¯ä¸€èµ· checkpointã€‚
                    </p>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty basic">ğŸŸ¢ åŸºç¡€</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
StateBackend - å†…å­˜å­˜å‚¨ï¼ˆé»˜è®¤ï¼‰
"""
from deepagents import create_deep_agent
from deepagents.harness import StateBackend

agent = create_deep_agent(
    model="gpt-4o",
    storage_backend=StateBackend()  # æ•°æ®ä¿å­˜åœ¨å†…å­˜ä¸­
)

# ç‰¹ç‚¹ï¼š
# - æ•°æ®éšå¯¹è¯çŠ¶æ€ä¸€èµ· checkpoint
# - å¯¹è¯ç»“æŸåæ•°æ®æ¶ˆå¤±
# - é€‚ç”¨äºä¸´æ—¶å·¥ä½œç©ºé—´</code></pre>
                    </div>

                    <h3 class="subsection-title">2. FilesystemBackendï¼ˆç£ç›˜å­˜å‚¨ï¼‰</h3>
                    <p>
                        <strong>çœŸå®ç£ç›˜è®¿é—®</strong>ï¼Œæ”¯æŒè·¯å¾„éªŒè¯ã€å¤§å°é™åˆ¶ã€
                        symlink é˜²æŠ¤ç­‰å®‰å…¨ç‰¹æ€§ã€‚
                    </p>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty intermediate">ğŸŸ¡ ä¸­çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
FilesystemBackend - ç£ç›˜å­˜å‚¨
"""
from deepagents.harness import FilesystemBackend

agent = create_deep_agent(
    model="gpt-4o",
    storage_backend=FilesystemBackend(
        root_path="/data/agent_workspace",  # æ ¹ç›®å½•
        max_file_size=10 * 1024 * 1024,     # 10MB é™åˆ¶
        allow_symlinks=False                # ç¦æ­¢ç¬¦å·é“¾æ¥
    )
)

# ç‰¹ç‚¹ï¼š
# - æ•°æ®æŒä¹…åŒ–åˆ°ç£ç›˜
# - è·¨å¯¹è¯æ•°æ®å…±äº«
# - è·¯å¾„éªŒè¯å’Œå®‰å…¨æ£€æŸ¥
# - é€‚ç”¨äºéœ€è¦çœŸå®æ–‡ä»¶æ“ä½œçš„åœºæ™¯</code></pre>
                    </div>

                    <h3 class="subsection-title">3. StoreBackendï¼ˆæŒä¹…åŒ–å­˜å‚¨ï¼‰</h3>
                    <p>
                        <strong>è·¨å¯¹è¯æŒä¹…åŒ–</strong>ï¼Œä½¿ç”¨ LangGraph çš„ BaseStoreï¼Œ
                        æ”¯æŒæ•°æ®åº“å­˜å‚¨ã€‚
                    </p>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty intermediate">ğŸŸ¡ ä¸­çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
StoreBackend - æŒä¹…åŒ–å­˜å‚¨
"""
from deepagents.harness import StoreBackend
from langgraph.store.memory import InMemoryStore

# åˆ›å»ºæŒä¹…åŒ– store
store = InMemoryStore()  # å¯æ›¿æ¢ä¸º PostgresStore ç­‰

agent = create_deep_agent(
    model="gpt-4o",
    storage_backend=StoreBackend(store=store)
)

# ç‰¹ç‚¹ï¼š
# - è·¨å¯¹è¯æ•°æ®æŒä¹…åŒ–
# - æ”¯æŒæ•°æ®åº“åç«¯
# - é€‚ç”¨äºçŸ¥è¯†åº“ã€é•¿æœŸè®°å¿†</code></pre>
                    </div>

                    <h3 class="subsection-title">4. CompositeBackendï¼ˆæ··åˆè·¯ç”±ï¼‰</h3>
                    <p>
                        <strong>æœ€çµæ´»çš„æ–¹æ¡ˆ</strong>ï¼Œæ ¹æ®è·¯å¾„å‰ç¼€å°†ä¸åŒè·¯å¾„è·¯ç”±åˆ°
                        ä¸åŒçš„åç«¯ã€‚
                    </p>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty advanced">ğŸ”´ é«˜çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
CompositeBackend - æ··åˆè·¯ç”±ç­–ç•¥
"""
from deepagents.harness import (
    CompositeBackend,
    StateBackend,
    StoreBackend,
    FilesystemBackend
)

# åˆ›å»ºæ··åˆåç«¯
composite = CompositeBackend(
    backends={
        "/tmp": StateBackend(),              # ä¸´æ—¶æ•°æ® â†’ å†…å­˜
        "/knowledge": StoreBackend(store),   # çŸ¥è¯†åº“ â†’ æŒä¹…åŒ–
        "/workspace": FilesystemBackend(root_path="/data")  # å·¥ä½œåŒº â†’ ç£ç›˜
    },
    default_backend=StateBackend()  # é»˜è®¤ä½¿ç”¨å†…å­˜
)

agent = create_deep_agent(
    model="gpt-4o",
    storage_backend=composite
)

# ä½¿ç”¨ç¤ºä¾‹ï¼š
# - write_file("/tmp/search_results.txt", ...)    â†’ å†…å­˜
# - write_file("/knowledge/faq.txt", ...)         â†’ æŒä¹…åŒ–
# - write_file("/workspace/report.pdf", ...)      â†’ ç£ç›˜
# - write_file("other.txt", ...)                  â†’ é»˜è®¤å†…å­˜</code></pre>
                    </div>

                    <div class="info-box tip">
                        <div class="info-box-title">âœ¨ åç«¯é€‰æ‹©å»ºè®®</div>
                        <table style="margin-top: 0.5rem;">
                            <thead>
                                <tr>
                                    <th>åç«¯</th>
                                    <th>é€‚ç”¨åœºæ™¯</th>
                                    <th>æ•°æ®ç”Ÿå‘½å‘¨æœŸ</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><code>StateBackend</code></td>
                                    <td>ä¸´æ—¶å·¥ä½œç©ºé—´ã€å•æ¬¡å¯¹è¯</td>
                                    <td>å¯¹è¯ç»“æŸåæ¶ˆå¤±</td>
                                </tr>
                                <tr>
                                    <td><code>FilesystemBackend</code></td>
                                    <td>çœŸå®æ–‡ä»¶æ“ä½œã€ä»£ç å·¥ä½œ</td>
                                    <td>æŒä¹…åŒ–ï¼Œæ‰‹åŠ¨åˆ é™¤</td>
                                </tr>
                                <tr>
                                    <td><code>StoreBackend</code></td>
                                    <td>çŸ¥è¯†åº“ã€è·¨å¯¹è¯å…±äº«</td>
                                    <td>æ°¸ä¹…æŒä¹…åŒ–</td>
                                </tr>
                                <tr>
                                    <td><code>CompositeBackend</code></td>
                                    <td>æ··åˆåœºæ™¯ï¼ˆæ¨èï¼‰</td>
                                    <td>æŒ‰è·¯å¾„åˆ†ç±»</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- å¤§ç»“æœé©±é€ -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ”„ å¤§ç»“æœé©±é€</h2>
                    <p>
                        å½“å·¥å…·è¾“å‡ºè¶…è¿‡<strong>20,000 Token</strong>æ—¶ï¼ŒHarness ä¼š
                        <strong>è‡ªåŠ¨å°†ç»“æœå†™å…¥å­˜å‚¨</strong>ï¼Œå¹¶ç”¨æ–‡ä»¶å¼•ç”¨æ›¿æ¢åŸå§‹è¾“å‡ºã€‚
                    </p>

                    <div class="mermaid-wrapper">
                        <div class="mermaid">
graph LR
    Tool["å·¥å…·è°ƒç”¨<br/>è¿”å›å¤§é‡æ•°æ®"] --> Check{"ç»“æœå¤§å°<br/>> 20K Token?"}

    Check -->|å¦| Direct["ç›´æ¥è¿”å›<br/>ç»“æœ"]
    Check -->|æ˜¯| Evict["é©±é€åˆ°å­˜å‚¨<br/>write_file(data)"]

    Evict --> Replace["æ›¿æ¢ä¸ºå¼•ç”¨<br/>'ç»“æœå·²ä¿å­˜åˆ° file.txt'"]
    Replace --> Agent["Agent ç»§ç»­æ‰§è¡Œ<br/>éœ€è¦æ—¶ read_file()"]

    Direct --> Agent

    style Tool fill:#3b82f6,color:#fff
    style Check fill:#f59e0b,color:#fff
    style Evict fill:#ef4444,color:#fff
    style Replace fill:#10b981,color:#fff
                        </div>
                    </div>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty intermediate">ğŸŸ¡ ä¸­çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
å¤§ç»“æœé©±é€ - è‡ªåŠ¨ç®¡ç†
"""
from deepagents import create_deep_agent

# åœºæ™¯ï¼šæœç´¢å·¥å…·è¿”å›å¤§é‡ç»“æœ
def massive_search(query: str) -> str:
    """æœç´¢å·¥å…·ï¼Œå¯èƒ½è¿”å›è¶…å¤§ç»“æœ"""
    # å‡è®¾è¿”å› 50,000 Token çš„ç»“æœ
    results = search_api(query, max_results=1000)
    return "\n".join([f"{i}. {r}" for i, r in enumerate(results)])

agent = create_deep_agent(
    model="gpt-4o",
    tools=[massive_search]
)

result = agent.invoke({
    "messages": [{
        "role": "user",
        "content": "æœç´¢æ‰€æœ‰å…³äº LangChain çš„æ–‡æ¡£"
    }]
})

# æ‰§è¡Œè¿‡ç¨‹ï¼š
# 1. Agent è°ƒç”¨ massive_search å·¥å…·
# 2. å·¥å…·è¿”å› 50,000 Token çš„ç»“æœ
# 3. Harness æ£€æµ‹åˆ°è¶…è¿‡ 20,000 Token é˜ˆå€¼
# 4. è‡ªåŠ¨æ‰§è¡Œ write_file("search_results.txt", data)
# 5. å°†å·¥å…·æ¶ˆæ¯æ›¿æ¢ä¸ºï¼š"æœç´¢ç»“æœå·²ä¿å­˜åˆ° search_results.txt"
# 6. Agent çœ‹åˆ°æ–‡ä»¶å¼•ç”¨ï¼Œå¯ä»¥åç»­ä½¿ç”¨ read_file è¯»å–

# ä¼˜åŠ¿ï¼š
# - é¿å…ä¸Šä¸‹æ–‡çª—å£æº¢å‡º
# - Agent å¯ä»¥é€‰æ‹©æ€§åœ°è¯»å–éƒ¨åˆ†æ•°æ®
# - è‡ªåŠ¨åŒ–ï¼Œæ— éœ€æ‰‹åŠ¨ç®¡ç†</code></pre>
                    </div>
                </section>

                <!-- å­ä»£ç†å§”æ´¾ -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ‘¥ å­ä»£ç†å§”æ´¾</h2>
                    <p>
                        ä¸» Agent å¯ä»¥ä½¿ç”¨å†…ç½®çš„<strong>task å·¥å…·</strong>åˆ›å»º
                        <strong>ç‹¬ç«‹çš„å­ä»£ç†</strong>æ¥æ‰§è¡Œä¸“é—¨åŒ–ä»»åŠ¡ã€‚
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty advanced">ğŸ”´ é«˜çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
å­ä»£ç†å§”æ´¾ - task å·¥å…·ä½¿ç”¨
"""
from deepagents import create_deep_agent

# ä¸» Agent çš„ç³»ç»Ÿæç¤ºè¯
main_prompt = """ä½ æ˜¯é¡¹ç›®ç»ç† Agentã€‚ä½ å¯ä»¥ï¼š

1. ä½¿ç”¨ task å·¥å…·å§”æ´¾ä¸“é—¨åŒ–ä»»åŠ¡ç»™å­ Agent
2. å­ Agent ä¼šç‹¬ç«‹æ‰§è¡Œï¼Œè¿”å›å‹ç¼©çš„ç»“æœ
3. ä½ å¯ä»¥å¹¶è¡Œåˆ›å»ºå¤šä¸ªå­ Agent

ç¤ºä¾‹ï¼š
- task("ç ”ç©¶ LangChain æ¶æ„", agent_type="researcher")
- task("ç¼–å†™ä»£ç ç¤ºä¾‹", agent_type="coder")
- task("ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹", agent_type="tester")

æ¯ä¸ªå­ Agent éƒ½æœ‰ç‹¬ç«‹çš„ä¸Šä¸‹æ–‡ï¼Œä¸ä¼šæ±¡æŸ“ä¸» Agent çš„å¯¹è¯å†å²ã€‚
"""

agent = create_deep_agent(
    model="gpt-4o",
    system_prompt=main_prompt
)

# ä½¿ç”¨ Agent
result = agent.invoke({
    "messages": [{
        "role": "user",
        "content": """åˆ›å»ºä¸€ä¸ªå®Œæ•´çš„ LangChain RAG é¡¹ç›®ï¼š
        1. ç ”ç©¶ RAG æœ€ä½³å®è·µ
        2. ç¼–å†™ä»£ç å®ç°
        3. ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹
        """
    }]
})

# Agent æ‰§è¡Œæµç¨‹ï¼š
# 1. ä¸» Agent åˆ†æä»»åŠ¡
# 2. è°ƒç”¨ task("ç ”ç©¶ RAG æœ€ä½³å®è·µ", agent_type="researcher")
#    â†’ å­ Agent 1 ç‹¬ç«‹æ‰§è¡Œç ”ç©¶ä»»åŠ¡
#    â†’ è¿”å›å‹ç¼©çš„ç ”ç©¶æŠ¥å‘Š
# 3. è°ƒç”¨ task("ç¼–å†™ RAG ä»£ç ", agent_type="coder", context="ç ”ç©¶ç»“æœ...")
#    â†’ å­ Agent 2 ç‹¬ç«‹ç¼–å†™ä»£ç 
#    â†’ è¿”å›ä»£ç 
# 4. è°ƒç”¨ task("ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹", agent_type="tester", code="...")
#    â†’ å­ Agent 3 ç”Ÿæˆæµ‹è¯•
#    â†’ è¿”å›æµ‹è¯•ç”¨ä¾‹
# 5. ä¸» Agent æ•´åˆæ‰€æœ‰å­ Agent çš„ç»“æœï¼Œç”Ÿæˆæœ€ç»ˆè¾“å‡º

# ä¼˜åŠ¿ï¼š
# - ä¸Šä¸‹æ–‡éš”ç¦»ï¼šæ¯ä¸ªå­ Agent æœ‰ç‹¬ç«‹çš„å¯¹è¯å†å²
# - å¹¶è¡Œæ‰§è¡Œï¼šå¯ä»¥åŒæ—¶è¿è¡Œå¤šä¸ªå­ Agent
# - ä¸“é—¨åŒ–ï¼šæ¯ä¸ªå­ Agent ä¸“æ³¨äºç‰¹å®šä»»åŠ¡
# - Token æ•ˆç‡ï¼šå­ Agent è¿”å›å‹ç¼©ç»“æœï¼ŒèŠ‚çœä¸» Agent ä¸Šä¸‹æ–‡</code></pre>
                    </div>

                    <div class="info-box tip">
                        <div class="info-box-title">âœ¨ å­ä»£ç†ä½¿ç”¨å»ºè®®</div>
                        <ul>
                            <li><strong>ç‹¬ç«‹ä»»åŠ¡</strong>ï¼šé€‚åˆå¯ä»¥ç‹¬ç«‹å®Œæˆçš„ä»»åŠ¡ï¼ˆç ”ç©¶ã€ç¼–ç ã€æµ‹è¯•ï¼‰</li>
                            <li><strong>ä¸Šä¸‹æ–‡éš”ç¦»</strong>ï¼šå­ Agent ä¸ä¼šæ±¡æŸ“ä¸» Agent çš„å¯¹è¯å†å²</li>
                            <li><strong>å¹¶è¡Œæ‰§è¡Œ</strong>ï¼šå¤šä¸ªå­ Agent å¯ä»¥åŒæ—¶è¿è¡Œï¼Œæå‡æ•ˆç‡</li>
                            <li><strong>å‹ç¼©è¿”å›</strong>ï¼šå­ Agent åªè¿”å›å…³é”®ç»“æœï¼ŒèŠ‚çœ Token</li>
                        </ul>
                    </div>
                </section>

                <!-- å†å²æ‘˜è¦ -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ“ å¯¹è¯å†å²æ‘˜è¦</h2>
                    <p>
                        å½“å¯¹è¯å†å²è¶…è¿‡<strong>170,000 Token</strong>æ—¶ï¼ŒHarness ä¼š
                        <strong>è‡ªåŠ¨å‹ç¼©æ—§æ¶ˆæ¯</strong>ï¼Œä¿ç•™æœ€è¿‘ 6 æ¡æ¶ˆæ¯ä¸å˜ã€‚
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty basic">ğŸŸ¢ åŸºç¡€</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
å†å²æ‘˜è¦ - è‡ªåŠ¨å‹ç¼©
"""
from deepagents import create_deep_agent

agent = create_deep_agent(
    model="gpt-4o",
    system_prompt="ä½ æ˜¯é•¿æœŸè¿è¡Œçš„åŠ©æ‰‹"
)

# é•¿æœŸè¿è¡Œçš„å¯¹è¯
for i in range(100):
    result = agent.invoke({
        "messages": [{
            "role": "user",
            "content": f"ä»»åŠ¡ {i}: æ‰§è¡Œä¸€äº›å¤æ‚çš„æ“ä½œ"
        }]
    })

# æ‰§è¡Œè¿‡ç¨‹ï¼š
# 1. å¯¹è¯ä¸æ–­ç§¯ç´¯æ¶ˆæ¯
# 2. å½“è¾¾åˆ° 170,000 Token æ—¶ï¼ŒHarness è§¦å‘æ‘˜è¦
# 3. ä¿ç•™æœ€è¿‘ 6 æ¡æ¶ˆæ¯ä¸å˜
# 4. æ—§æ¶ˆæ¯è¢«å‹ç¼©æˆæ‘˜è¦ï¼š"å‰ 94 ä¸ªä»»åŠ¡çš„æ€»ç»“..."
# 5. ç»§ç»­æ‰§è¡Œï¼Œä¸Šä¸‹æ–‡ä¿æŒå¯æ§

# é…ç½®ï¼ˆå¯é€‰ï¼‰ï¼š
# - æ‘˜è¦è§¦å‘é˜ˆå€¼ï¼š170,000 Tokenï¼ˆé»˜è®¤ï¼‰
# - ä¿ç•™æœ€è¿‘æ¶ˆæ¯æ•°ï¼š6 æ¡ï¼ˆé»˜è®¤ï¼‰
# - æ‘˜è¦ç”±æ¨¡å‹ç”Ÿæˆï¼Œç¡®ä¿å…³é”®ä¿¡æ¯ä¸ä¸¢å¤±</code></pre>
                    </div>
                </section>

                <!-- å·¥å…·è°ƒç”¨ä¿®å¤ -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ”§ æ‚¬ç©ºå·¥å…·è°ƒç”¨ä¿®å¤</h2>
                    <p>
                        Harness ä¼šæ£€æµ‹<strong>AIMessage åŒ…å« tool_calls ä½†æ²¡æœ‰å¯¹åº”çš„ ToolMessage</strong>
                        çš„æƒ…å†µï¼Œå¹¶è‡ªåŠ¨åˆ›å»ºåˆæˆå“åº”ã€‚
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty intermediate">ğŸŸ¡ ä¸­çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
å·¥å…·è°ƒç”¨ä¿®å¤ - è‡ªåŠ¨å¤„ç†
"""
# åœºæ™¯ï¼šAgent ä¸­æ–­æˆ–é”™è¯¯å¯¼è‡´å·¥å…·è°ƒç”¨æ²¡æœ‰å“åº”

# é”™è¯¯çš„å¯¹è¯åºåˆ—ï¼š
# 1. HumanMessage: "æœç´¢ LangChain"
# 2. AIMessage: tool_calls=[search("LangChain")]
# 3. [ä¸­æ–­ï¼Œæ²¡æœ‰ ToolMessage]
# 4. HumanMessage: "ç»§ç»­"

# Harness è‡ªåŠ¨ä¿®å¤ï¼š
# 1. æ£€æµ‹åˆ° AIMessage æœ‰ tool_calls ä½†æ²¡æœ‰å“åº”
# 2. åˆ›å»ºåˆæˆ ToolMessage: "å·¥å…·è°ƒç”¨è¢«ä¸­æ–­ï¼Œè¯·é‡è¯•"
# 3. å¯¹è¯åºåˆ—å˜ä¸ºå®Œæ•´ï¼š
#    - HumanMessage: "æœç´¢ LangChain"
#    - AIMessage: tool_calls=[search("LangChain")]
#    - ToolMessage: "å·¥å…·è°ƒç”¨è¢«ä¸­æ–­ï¼Œè¯·é‡è¯•" [åˆæˆ]
#    - HumanMessage: "ç»§ç»­"
# 4. Agent å¯ä»¥æ­£å¸¸ç»§ç»­æ‰§è¡Œ

# ä¼˜åŠ¿ï¼š
# - ä¿è¯å¯¹è¯åºåˆ—çš„å®Œæ•´æ€§
# - é¿å…æ¨¡å‹æ··æ·†
# - è‡ªåŠ¨æ¢å¤é”™è¯¯çŠ¶æ€</code></pre>
                    </div>
                </section>

                <!-- å¾…åŠåˆ—è¡¨ -->
                <section class="content-section">
                    <h2 class="section-title">âœ… å¾…åŠåˆ—è¡¨è¿½è¸ª</h2>
                    <p>
                        Agent å¯ä»¥ä½¿ç”¨<strong>write_todos å·¥å…·</strong>ç»´æŠ¤ç»“æ„åŒ–çš„
                        ä»»åŠ¡åˆ—è¡¨ï¼Œè¿½è¸ªå¤æ‚å·¥ä½œæµçš„è¿›åº¦ã€‚
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty intermediate">ğŸŸ¡ ä¸­çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
å¾…åŠåˆ—è¡¨ - write_todos å·¥å…·
"""
from deepagents import create_deep_agent

agent = create_deep_agent(
    model="gpt-4o",
    system_prompt="""ä½ æ˜¯é¡¹ç›®ç®¡ç†åŠ©æ‰‹ã€‚ä½¿ç”¨ write_todos å·¥å…·è¿½è¸ªä»»åŠ¡è¿›åº¦ã€‚

ä»»åŠ¡çŠ¶æ€ï¼š
- pending: å¾…å¤„ç†
- in_progress: è¿›è¡Œä¸­
- completed: å·²å®Œæˆ

å·¥ä½œæµç¨‹ï¼š
1. æ”¶åˆ°ä»»åŠ¡åï¼Œä½¿ç”¨ write_todos åˆ›å»ºä»»åŠ¡åˆ—è¡¨
2. å¼€å§‹ä»»åŠ¡æ—¶ï¼Œæ›´æ–°çŠ¶æ€ä¸º in_progress
3. å®Œæˆä»»åŠ¡åï¼Œæ›´æ–°çŠ¶æ€ä¸º completed
"""
)

result = agent.invoke({
    "messages": [{
        "role": "user",
        "content": "åˆ›å»ºä¸€ä¸ªå®Œæ•´çš„ Web åº”ç”¨ï¼šå‰ç«¯ã€åç«¯ã€æ•°æ®åº“ã€éƒ¨ç½²"
    }]
})

# Agent æ‰§è¡Œè¿‡ç¨‹ï¼š
# 1. è°ƒç”¨ write_todosï¼š
#    [
#        {"task": "è®¾è®¡æ•°æ®åº“ schema", "status": "pending"},
#        {"task": "å®ç°åç«¯ API", "status": "pending"},
#        {"task": "å¼€å‘å‰ç«¯ç•Œé¢", "status": "pending"},
#        {"task": "é…ç½®éƒ¨ç½²", "status": "pending"}
#    ]
#
# 2. å¼€å§‹ç¬¬ä¸€ä¸ªä»»åŠ¡ï¼Œæ›´æ–°ï¼š
#    [
#        {"task": "è®¾è®¡æ•°æ®åº“ schema", "status": "in_progress"},
#        ...
#    ]
#
# 3. å®Œæˆç¬¬ä¸€ä¸ªä»»åŠ¡ï¼Œæ›´æ–°ï¼š
#    [
#        {"task": "è®¾è®¡æ•°æ®åº“ schema", "status": "completed"},
#        {"task": "å®ç°åç«¯ API", "status": "in_progress"},
#        ...
#    ]
#
# 4. å¾ªç¯æ‰§è¡Œï¼Œç›´åˆ°æ‰€æœ‰ä»»åŠ¡å®Œæˆ

# ä¼˜åŠ¿ï¼š
# - ç»“æ„åŒ–è¿½è¸ªå¤æ‚å·¥ä½œæµ
# - ç”¨æˆ·å¯è§ä»»åŠ¡è¿›åº¦
# - Agent å¯ä»¥æ ¹æ®ä»»åŠ¡çŠ¶æ€å†³ç­–</code></pre>
                    </div>
                </section>

                <!-- äººå·¥ä»‹å…¥ -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ‘¤ äººå·¥ä»‹å…¥ï¼ˆHITLï¼‰</h2>
                    <p>
                        é…ç½® Harness åœ¨ç‰¹å®šå·¥å…·è°ƒç”¨å‰<strong>æš‚åœå¹¶ç­‰å¾…äººå·¥å®¡æ‰¹</strong>ï¼Œ
                        å®ç°å®‰å…¨é—¨æ§å’Œæˆæœ¬æ§åˆ¶ã€‚
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty advanced">ğŸ”´ é«˜çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
äººå·¥ä»‹å…¥ - HITL é…ç½®
"""
from deepagents import create_deep_agent

# å®šä¹‰éœ€è¦å®¡æ‰¹çš„å·¥å…·
def delete_file(path: str) -> str:
    """åˆ é™¤æ–‡ä»¶ï¼ˆå±é™©æ“ä½œï¼‰"""
    import os
    os.remove(path)
    return f"å·²åˆ é™¤æ–‡ä»¶ï¼š{path}"

def expensive_api_call(query: str) -> str:
    """è°ƒç”¨æ˜‚è´µçš„ API"""
    # å‡è®¾è¿™æ˜¯ä¸€ä¸ªæ¯æ¬¡è°ƒç”¨èŠ±è´¹ $10 çš„ API
    return external_api.query(query)

agent = create_deep_agent(
    model="gpt-4o",
    tools=[delete_file, expensive_api_call],
    # é…ç½®äººå·¥ä»‹å…¥
    interrupt_before=["delete_file", "expensive_api_call"],
    system_prompt="ä½ æ˜¯æ–‡ä»¶ç®¡ç†å’Œæ•°æ®æŸ¥è¯¢åŠ©æ‰‹"
)

# ä½¿ç”¨ Agent
result = agent.invoke({
    "messages": [{
        "role": "user",
        "content": "æ¸…ç†ä¸´æ—¶æ–‡ä»¶ï¼Œå¹¶æŸ¥è¯¢æœ€æ–°æ•°æ®"
    }]
})

# æ‰§è¡Œæµç¨‹ï¼š
# 1. Agent å†³å®šè°ƒç”¨ delete_file("/tmp/cache")
# 2. Harness æ£€æµ‹åˆ° interrupt_before é…ç½®
# 3. æš‚åœæ‰§è¡Œï¼Œè¿”å›ä¸­æ–­ä¿¡å·
# 4. ç”¨æˆ·å®¡æ‰¹æˆ–æ‹’ç»ï¼š
#    - å®¡æ‰¹ï¼šagent.resume() ç»§ç»­æ‰§è¡Œ
#    - æ‹’ç»ï¼šagent.cancel() å–æ¶ˆæ“ä½œ
# 5. ç»§ç»­æ‰§è¡Œåç»­ä»»åŠ¡

# å®¡æ‰¹ç¤ºä¾‹ï¼š
if result.get("interrupt"):
    print(f"Agent è¯·æ±‚æ‰§è¡Œï¼š{result['next_tool_call']}")
    approval = input("æ˜¯å¦æ‰¹å‡†ï¼Ÿ(y/n): ")

    if approval.lower() == "y":
        result = agent.resume()
    else:
        result = agent.cancel("ç”¨æˆ·æ‹’ç»æ“ä½œ")

# åº”ç”¨åœºæ™¯ï¼š
# - å±é™©æ“ä½œï¼ˆåˆ é™¤ã€ä¿®æ”¹ç”Ÿäº§æ•°æ®ï¼‰
# - æ˜‚è´µçš„ API è°ƒç”¨
# - éœ€è¦äººå·¥åˆ¤æ–­çš„å†³ç­–</code></pre>
                    </div>
                </section>

                <!-- æç¤ºè¯ç¼“å­˜ -->
                <section class="content-section">
                    <h2 class="section-title">âš¡ æç¤ºè¯ç¼“å­˜ï¼ˆAnthropicï¼‰</h2>
                    <p>
                        å¯¹äº Anthropic æ¨¡å‹ï¼ŒHarness ä¼š<strong>è‡ªåŠ¨ç¼“å­˜ç³»ç»Ÿæç¤ºè¯</strong>ï¼Œ
                        å®ç°<strong>10 å€åŠ é€Ÿå’Œæˆæœ¬é™ä½</strong>ã€‚
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty basic">ğŸŸ¢ åŸºç¡€</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
æç¤ºè¯ç¼“å­˜ - è‡ªåŠ¨å¯ç”¨ï¼ˆAnthropicï¼‰
"""
from deepagents import create_deep_agent

# ä½¿ç”¨ Anthropic æ¨¡å‹æ—¶è‡ªåŠ¨å¯ç”¨ç¼“å­˜
agent = create_deep_agent(
    model="claude-sonnet-4-5-20250929",  # Anthropic æ¨¡å‹
    system_prompt="""ä½ æ˜¯ä¸“ä¸šçš„ä»£ç å®¡æŸ¥åŠ©æ‰‹...

    [éå¸¸é•¿çš„ç³»ç»Ÿæç¤ºè¯ï¼ŒåŒ…å«è¯¦ç»†çš„å®¡æŸ¥æ ‡å‡†ã€ä»£ç è§„èŒƒã€è¾“å‡ºæ ¼å¼ç­‰]

    æ€»å…± 5000+ Token çš„ç³»ç»Ÿæç¤ºè¯
    """
)

# ç¬¬ä¸€æ¬¡è°ƒç”¨ï¼šç³»ç»Ÿæç¤ºè¯è¢«ç¼“å­˜
result1 = agent.invoke({
    "messages": [{"role": "user", "content": "å®¡æŸ¥è¿™æ®µä»£ç ..."}]
})

# ç¬¬äºŒæ¬¡è°ƒç”¨ï¼šç›´æ¥ä½¿ç”¨ç¼“å­˜ï¼Œ10 å€åŠ é€Ÿ
result2 = agent.invoke({
    "messages": [{"role": "user", "content": "å®¡æŸ¥å¦ä¸€æ®µä»£ç ..."}]
})

# æ•ˆæœï¼š
# - ç¬¬ä¸€æ¬¡è°ƒç”¨ï¼šæ­£å¸¸é€Ÿåº¦å’Œæˆæœ¬
# - åç»­è°ƒç”¨ï¼š
#   - å»¶è¿Ÿé™ä½ ~90%ï¼ˆ10 å€åŠ é€Ÿï¼‰
#   - æˆæœ¬é™ä½ ~90%ï¼ˆç³»ç»Ÿæç¤ºè¯ä¸é‡å¤è®¡è´¹ï¼‰

# æ³¨æ„ï¼š
# - ä»…é€‚ç”¨äº Anthropic Claude æ¨¡å‹
# - ç¼“å­˜æœ‰æ•ˆæœŸï¼š5 åˆ†é’Ÿï¼ˆAnthropic é™åˆ¶ï¼‰
# - ç³»ç»Ÿæç¤ºè¯å¿…é¡»ä¿æŒä¸å˜æ‰èƒ½ä½¿ç”¨ç¼“å­˜</code></pre>
                    </div>
                </section>

                <!-- æœ€ä½³å®è·µ -->
                <section class="content-section">
                    <h2 class="section-title">âœ¨ Harness æœ€ä½³å®è·µ</h2>

                    <h3 class="subsection-title">1. å­˜å‚¨ç­–ç•¥é€‰æ‹©</h3>
                    <ul>
                        <li><strong>æ¨èä½¿ç”¨ CompositeBackend</strong>ï¼šçµæ´»è·¯ç”±ä¸åŒç±»å‹çš„æ•°æ®</li>
                        <li><strong>ä¸´æ—¶æ•°æ®</strong> â†’ StateBackendï¼ˆå†…å­˜ï¼‰</li>
                        <li><strong>çŸ¥è¯†åº“</strong> â†’ StoreBackendï¼ˆæŒä¹…åŒ–ï¼‰</li>
                        <li><strong>çœŸå®æ–‡ä»¶æ“ä½œ</strong> â†’ FilesystemBackendï¼ˆç£ç›˜ï¼‰</li>
                    </ul>

                    <h3 class="subsection-title">2. Token ç®¡ç†</h3>
                    <ul>
                        <li><strong>ä¿¡ä»»å¤§ç»“æœé©±é€</strong>ï¼šè®© Harness è‡ªåŠ¨ç®¡ç†è¶…å¤§è¾“å‡º</li>
                        <li><strong>ä½¿ç”¨å­ä»£ç†</strong>ï¼šéš”ç¦»ä¸Šä¸‹æ–‡ï¼Œé¿å…ä¸» Agent æ±¡æŸ“</li>
                        <li><strong>å†å²æ‘˜è¦</strong>ï¼šå¯¹é•¿æœŸè¿è¡Œçš„ Agent è‡ªåŠ¨ç”Ÿæ•ˆ</li>
                    </ul>

                    <h3 class="subsection-title">3. å®‰å…¨å’Œæˆæœ¬æ§åˆ¶</h3>
                    <ul>
                        <li><strong>é…ç½® interrupt_before</strong>ï¼šä¸ºå±é™©/æ˜‚è´µæ“ä½œæ·»åŠ äººå·¥å®¡æ‰¹</li>
                        <li><strong>FilesystemBackend å®‰å…¨</strong>ï¼šè®¾ç½® max_file_sizeã€ç¦ç”¨ symlinks</li>
                        <li><strong>ç›‘æ§ Token ä½¿ç”¨</strong>ï¼šé…åˆ LangSmith è¿½è¸ª</li>
                    </ul>

                    <h3 class="subsection-title">4. æ€§èƒ½ä¼˜åŒ–</h3>
                    <ul>
                        <li><strong>Anthropic æ¨¡å‹</strong>ï¼šå¯ç”¨æç¤ºè¯ç¼“å­˜ï¼Œ10 å€åŠ é€Ÿ</li>
                        <li><strong>å¹¶è¡Œå­ä»£ç†</strong>ï¼šä½¿ç”¨ task å·¥å…·å¹¶è¡Œæ‰§è¡Œç‹¬ç«‹ä»»åŠ¡</li>
                        <li><strong>é€‚æ—¶ä½¿ç”¨æ–‡ä»¶å·¥å…·</strong>ï¼šé¿å…é‡å¤ä¼ è¾“å¤§é‡æ•°æ®</li>
                    </ul>
                </section>

                <!-- å¸¸è§é—®é¢˜ -->
                <section class="content-section">
                    <h2 class="section-title">â“ å¸¸è§é—®é¢˜</h2>

                    <h3 class="subsection-subtitle">Q1: Harness å’Œæ™®é€š Agent æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>ç‰¹æ€§</th>
                                <th>æ™®é€š Agent</th>
                                <th>Harnessï¼ˆDeepAgentï¼‰</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>æ–‡ä»¶æ“ä½œ</strong></td>
                                <td>éœ€è¦æ‰‹åŠ¨å®šä¹‰å·¥å…·</td>
                                <td>6 ä¸ªå†…ç½®å·¥å…·</td>
                            </tr>
                            <tr>
                                <td><strong>å¤§ç»“æœå¤„ç†</strong></td>
                                <td>ä¸Šä¸‹æ–‡æº¢å‡ºé£é™©</td>
                                <td>è‡ªåŠ¨é©±é€åˆ°å­˜å‚¨</td>
                            </tr>
                            <tr>
                                <td><strong>å­ä»£ç†</strong></td>
                                <td>ä¸æ”¯æŒ</td>
                                <td>å†…ç½® task å·¥å…·</td>
                            </tr>
                            <tr>
                                <td><strong>å†å²ç®¡ç†</strong></td>
                                <td>æ‰‹åŠ¨å¤„ç†</td>
                                <td>è‡ªåŠ¨æ‘˜è¦å‹ç¼©</td>
                            </tr>
                            <tr>
                                <td><strong>é”™è¯¯æ¢å¤</strong></td>
                                <td>éœ€è¦æ‰‹åŠ¨å¤„ç†</td>
                                <td>è‡ªåŠ¨ä¿®å¤æ‚¬ç©ºè°ƒç”¨</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3 class="subsection-subtitle">Q2: å¦‚ä½•é€‰æ‹©å­˜å‚¨åç«¯ï¼Ÿ</h3>
                    <p>
                        <strong>æ¨èä½¿ç”¨ CompositeBackend</strong>ï¼Œæ ¹æ®æ•°æ®ç±»å‹è·¯ç”±ï¼š
                    </p>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python"># æ¨èé…ç½®
composite = CompositeBackend({
    "/tmp": StateBackend(),          # ä¸´æ—¶æ•°æ®
    "/knowledge": StoreBackend(),    # æ°¸ä¹…çŸ¥è¯†åº“
    "/workspace": FilesystemBackend()  # çœŸå®æ–‡ä»¶
})</code></pre>
                    </div>

                    <h3 class="subsection-subtitle">Q3: å¤§ç»“æœé©±é€çš„é˜ˆå€¼å¯ä»¥è°ƒæ•´å—ï¼Ÿ</h3>
                    <p>
                        <strong>å½“å‰ä¸ºå›ºå®šå€¼ 20,000 Token</strong>ã€‚å¦‚éœ€è°ƒæ•´ï¼Œ
                        éœ€è¦è‡ªå®šä¹‰ Harness é…ç½®ï¼ˆé«˜çº§ç”¨æ³•ï¼‰ã€‚
                    </p>

                    <h3 class="subsection-subtitle">Q4: å­ä»£ç†ä¼šæ¶ˆè€—æ›´å¤šæˆæœ¬å—ï¼Ÿ</h3>
                    <p>
                        <strong>ä¼š</strong>ï¼Œæ¯ä¸ªå­ä»£ç†éƒ½æ˜¯ç‹¬ç«‹çš„æ¨¡å‹è°ƒç”¨ã€‚ä½†ç”±äºï¼š
                    </p>
                    <ul>
                        <li>å­ä»£ç†ä¸Šä¸‹æ–‡éš”ç¦»ï¼Œé¿å…ä¸» Agent ä¸Šä¸‹æ–‡è†¨èƒ€</li>
                        <li>å­ä»£ç†è¿”å›å‹ç¼©ç»“æœï¼ŒèŠ‚çœ Token</li>
                        <li>å¯ä»¥å¹¶è¡Œæ‰§è¡Œï¼Œæå‡æ•ˆç‡</li>
                    </ul>
                    <p>æ€»ä½“ä¸Š<strong>æˆæœ¬æ•ˆç›Šæ›´é«˜</strong>ã€‚</p>

                    <h3 class="subsection-subtitle">Q5: äººå·¥ä»‹å…¥ä¼šé˜»å¡ Agent æ‰§è¡Œå—ï¼Ÿ</h3>
                    <p>
                        <strong>æ˜¯çš„</strong>ã€‚é…ç½® <code>interrupt_before</code> çš„å·¥å…·è°ƒç”¨ä¼šæš‚åœæ‰§è¡Œï¼Œ
                        éœ€è¦è°ƒç”¨ <code>agent.resume()</code> æˆ– <code>agent.cancel()</code> æ‰èƒ½ç»§ç»­ã€‚
                        è¿™æ˜¯è®¾è®¡è¡Œä¸ºï¼Œç”¨äºå®‰å…¨é—¨æ§ã€‚
                    </p>
                </section>

                <!-- å‚è€ƒèµ„æº -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ“– å‚è€ƒèµ„æº</h2>
                    <ul>
                        <li>
                            <a href="https://docs.langchain.com/oss/python/deepagents/harness" target="_blank">
                                DeepAgents Harness å®˜æ–¹æ–‡æ¡£
                            </a>
                        </li>
                        <li>
                            <a href="22-deepagents-quickstart.html">
                                DeepAgents å¿«é€Ÿå¼€å§‹
                            </a>
                        </li>
                        <li>
                            <a href="23-deepagents-customization.html">
                                DeepAgents å®šåˆ¶åŒ–
                            </a>
                        </li>
                        <li>
                            <a href="25-deepagents-backends.html">
                                DeepAgents åç«¯é…ç½®
                            </a>
                        </li>
                    </ul>
                </section>

                <!-- é¡µé¢å¯¼èˆª -->
                                <nav class="page-navigation">
                    <a href="23-deepagents-customization.html" class="nav-button prev">
                        â† ä¸Šä¸€é¡µï¼šDeepAgents å®šåˆ¶åŒ–
                    </a>
                    <a href="25-deepagents-backends.html" class="nav-button next">
                        ä¸‹ä¸€é¡µï¼šDeepAgents åç«¯é…ç½® â†’
                    </a>
                </nav>
            </div>
        </main>
    </div>

    <!-- è¿”å›é¡¶éƒ¨æŒ‰é’® -->
    <button class="back-to-top" aria-label="è¿”å›é¡¶éƒ¨">â†‘</button>

    <!-- JavaScript -->
    <script src="assets/js/mermaid-init.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
</body>
</html>
