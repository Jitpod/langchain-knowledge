<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="DeepAgents äººå·¥ä»‹å…¥ - Human-in-the-Loop å®‰å…¨å®¡æ‰¹æœºåˆ¶">
    <title>DeepAgents äººå·¥ä»‹å…¥ | LangChain 1.0 Python çŸ¥è¯†æ–‡æ¡£</title>
    <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
    <button class="mobile-menu-button" aria-label="æ‰“å¼€èœå•">â˜°</button>

    <div class="container">
        <!-- ä¾§è¾¹æ å¯¼èˆª -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <h1 class="sidebar-title">ğŸ¦œ LangChain 1.0</h1>
                <p class="sidebar-subtitle">Python å®Œæ•´å­¦ä¹ æŒ‡å—</p>
            </div>

            <ul class="nav-menu">
                <li class="nav-section">
                    <div class="nav-section-title">å¼€å§‹</div>
                    <ul>
                        <li class="nav-item">
                            <a href="index.html" class="nav-link">
                                <span class="nav-icon">ğŸ </span>
                                ä¸»é¡µ
                            </a>
                        </li>
                    </ul>
                </li>

                <li class="nav-section">
                    <div class="nav-section-title">åŸºç¡€ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="01-introduction.html" class="nav-link">
                                <span class="nav-icon">ğŸ“–</span>
                                LangChain ç®€ä»‹
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="02-architecture.html" class="nav-link">
                                <span class="nav-icon">ğŸ—ï¸</span>
                                æ ¸å¿ƒæ¶æ„
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="03-models.html" class="nav-link">
                                <span class="nav-icon">ğŸ¤–</span>
                                æ¨¡å‹æ¥å£
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="04-messages.html" class="nav-link">
                                <span class="nav-icon">ğŸ’¬</span>
                                æ¶ˆæ¯ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="05-tools.html" class="nav-link">
                                <span class="nav-icon">ğŸ”§</span>
                                å·¥å…·ç³»ç»Ÿ
                            </a>
                        </li>
                    </ul>
                </li>

                <li class="nav-section">
                    <div class="nav-section-title">è¿›é˜¶ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="06-agents.html" class="nav-link">
                                <span class="nav-icon">ğŸ¯</span>
                                Agent åŸºç¡€
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="07-middleware.html" class="nav-link">
                                <span class="nav-icon">âš™ï¸</span>
                                ä¸­é—´ä»¶ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="08-rag.html" class="nav-link">
                                <span class="nav-icon">ğŸ”</span>
                                RAG è¯¦è§£
                                <span class="nav-badge">é‡ç‚¹</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="09-lcel.html" class="nav-link">
                                <span class="nav-icon">ğŸ”—</span>
                                LCEL è¡¨è¾¾å¼
                            </a>
                        </li>
                    </ul>
                </li>

                <li class="nav-section">
                    <div class="nav-section-title">é«˜çº§åº”ç”¨</div>
                    <ul>
                        <li class="nav-item">
                            <a href="10-runtime.html" class="nav-link">
                                <span class="nav-icon">ğŸ”Œ</span>
                                Runtime ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="11-checkpointer.html" class="nav-link">
                                <span class="nav-icon">ğŸ’¾</span>
                                æŒä¹…åŒ–ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="12-streaming.html" class="nav-link">
                                <span class="nav-icon">ğŸŒŠ</span>
                                æµå¼è¾“å‡º
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="13-human-in-loop.html" class="nav-link">
                                <span class="nav-icon">ğŸ‘¤</span>
                                äººå·¥ä»‹å…¥
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="14-long-term-memory.html" class="nav-link">
                                <span class="nav-icon">ğŸ—„ï¸</span>
                                é•¿æœŸè®°å¿†
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="15-langgraph.html" class="nav-link">
                                <span class="nav-icon">ğŸ“Š</span>
                                LangGraph
                            </a>
                        </li>
                    </ul>
                </li>

                <li class="nav-section">
                    <div class="nav-section-title">å®æˆ˜ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="16-customer-service.html" class="nav-link">
                                <span class="nav-icon">ğŸ‘¥</span>
                                å®¢æœæœºå™¨äºº
                                <span class="nav-badge">é‡ç‚¹</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="17-best-practices.html" class="nav-link">
                                <span class="nav-icon">âœ¨</span>
                                æœ€ä½³å®è·µ
                            </a>
                        </li>
                    </ul>
                </li>

                <li class="nav-section">
                    <div class="nav-section-title">å‚è€ƒç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="18-api-reference.html" class="nav-link">
                                <span class="nav-icon">ğŸ“š</span>
                                API é€ŸæŸ¥è¡¨
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="19-troubleshooting.html" class="nav-link">
                                <span class="nav-icon">ğŸ›</span>
                                æ•…éšœæ’é™¤
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="20-migration.html" class="nav-link">
                                <span class="nav-icon">ğŸ”„</span>
                                è¿ç§»æŒ‡å—
                            </a>
                        </li>
                    </ul>
                </li>

                <li class="nav-section">
                    <div class="nav-section-title">æ‰©å±•ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="21-structured-output.html" class="nav-link">
                                <span class="nav-icon">ğŸ“Š</span>
                                ç»“æ„åŒ–è¾“å‡º
                            </a>
                        </li>
                    </ul>
                </li>

                <li class="nav-section">
                    <div class="nav-section-title">DeepAgents ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="22-deepagents-quickstart.html" class="nav-link">
                                <span class="nav-icon">ğŸš€</span>
                                å¿«é€Ÿå¼€å§‹
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="23-deepagents-customization.html" class="nav-link">
                                <span class="nav-icon">ğŸ¨</span>
                                å®šåˆ¶åŒ–
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="24-deepagents-harness.html" class="nav-link">
                                <span class="nav-icon">ğŸ›ï¸</span>
                                Harness ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="25-deepagents-backends.html" class="nav-link">
                                <span class="nav-icon">ğŸ”§</span>
                                åç«¯é…ç½®
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="26-deepagents-subagents.html" class="nav-link">
                                <span class="nav-icon">ğŸ‘¥</span>
                                å­ä»£ç†
                            </a>
                        </li>
                        <li class="nav-item active">
                            <a href="27-deepagents-hitl.html" class="nav-link">
                                <span class="nav-icon">ğŸ¤</span>
                                äººå·¥ä»‹å…¥
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="28-deepagents-memory.html" class="nav-link">
                                <span class="nav-icon">ğŸ§ </span>
                                é•¿æœŸè®°å¿†
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="29-deepagents-middleware.html" class="nav-link">
                                <span class="nav-icon">âš™ï¸</span>
                                ä¸­é—´ä»¶
                            </a>
                        </li>
                    </ul>
                </li>

                <li class="nav-section">
                    <div class="nav-section-title">Multi-Agent ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="30-multi-agent-index.html" class="nav-link">
                                <span class="nav-icon">ğŸŒ</span>
                                æ¦‚è¿°
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="31-multi-agent-subagents.html" class="nav-link">
                                <span class="nav-icon">ğŸ‘¥</span>
                                å­ä»£ç†
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="32-multi-agent-handoffs.html" class="nav-link">
                                <span class="nav-icon">ğŸ”„</span>
                                äº¤æ¥æœºåˆ¶
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="33-multi-agent-skills.html" class="nav-link">
                                <span class="nav-icon">ğŸ¯</span>
                                æŠ€èƒ½ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="34-multi-agent-router.html" class="nav-link">
                                <span class="nav-icon">ğŸ§­</span>
                                è·¯ç”±æœºåˆ¶
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="35-multi-agent-workflow.html" class="nav-link">
                                <span class="nav-icon">ğŸ”€</span>
                                è‡ªå®šä¹‰å·¥ä½œæµ
                            </a>
                        </li>
                    </ul>
                </li>
            </ul>
        </nav>

        <!-- ä¸»å†…å®¹åŒºåŸŸ -->
        <main class="main-content">
            <div class="content-wrapper">
                <!-- é¢åŒ…å±‘å¯¼èˆª -->
                <nav class="breadcrumb">
                    <span class="breadcrumb-item">
                        <a href="index.html" class="breadcrumb-link">ä¸»é¡µ</a>
                    </span>
                    <span class="breadcrumb-item">
                        DeepAgents ç¯‡
                    </span>
                    <span class="breadcrumb-item">
                        äººå·¥ä»‹å…¥
                    </span>
                </nav>

                <!-- é¡µé¢æ ‡é¢˜ -->
                <header class="page-header">
                    <h1 class="page-title">ğŸ¤ DeepAgents äººå·¥ä»‹å…¥</h1>
                    <p class="page-subtitle">
                        é€šè¿‡ Human-in-the-Loopï¼ˆHITLï¼‰æœºåˆ¶ï¼Œåœ¨æ‰§è¡Œæ•æ„Ÿå·¥å…·æ“ä½œå‰è¿›è¡Œäººå·¥å®¡æ‰¹ï¼Œ
                        ç¡®ä¿å®‰å…¨æ€§ã€åˆè§„æ€§å’Œæˆæœ¬æ§åˆ¶ã€‚
                    </p>
                </header>

                <!-- ä»€ä¹ˆæ˜¯ HITL -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ“š ä»€ä¹ˆæ˜¯ Human-in-the-Loopï¼Ÿ</h2>
                    <p>
                        <strong>Human-in-the-Loopï¼ˆHITLï¼Œäººå·¥ä»‹å…¥ï¼‰</strong>æ˜¯ä¸€ç§å®‰å…¨æœºåˆ¶ï¼Œ
                        å…è®¸åœ¨ Agent æ‰§è¡Œ<strong>æ•æ„Ÿå·¥å…·æ“ä½œå‰æš‚åœæ‰§è¡Œ</strong>ï¼Œ
                        ç­‰å¾…äººå·¥å®¡æ‰¹ã€ä¿®æ”¹æˆ–æ‹’ç»ã€‚è¿™å¯¹äºä»¥ä¸‹åœºæ™¯è‡³å…³é‡è¦ï¼š
                    </p>

                    <ul>
                        <li><strong>å±é™©æ“ä½œ</strong>ï¼šåˆ é™¤æ–‡ä»¶ã€ä¿®æ”¹æ•°æ®åº“ã€å‘é€é‚®ä»¶ç­‰ä¸å¯é€†æ“ä½œ</li>
                        <li><strong>æ˜‚è´µæ“ä½œ</strong>ï¼šè°ƒç”¨ä»˜è´¹ APIã€å‘èµ·å¤§é‡è¯·æ±‚ã€è§¦å‘å¤–éƒ¨æœåŠ¡</li>
                        <li><strong>åˆè§„è¦æ±‚</strong>ï¼šé‡‘èäº¤æ˜“ã€æ³•å¾‹æ–‡æ¡£å®¡æ‰¹ã€åŒ»ç–—å†³ç­–ç­‰éœ€è¦äººå·¥ç¡®è®¤</li>
                        <li><strong>è´¨é‡æ§åˆ¶</strong>ï¼šç¡®ä¿è¾“å‡ºç¬¦åˆé¢„æœŸæ ‡å‡†</li>
                    </ul>

                    <div class="info-box note">
                        <div class="info-box-title">ğŸ’¡ HITL æ ¸å¿ƒç‰¹æ€§</div>
                        <table style="margin-top: 0.5rem;">
                            <thead>
                                <tr>
                                    <th>ç‰¹æ€§</th>
                                    <th>è¯´æ˜</th>
                                    <th>ä»·å€¼</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>æ‰§è¡Œå‰ä¸­æ–­</strong></td>
                                    <td>å·¥å…·æ‰§è¡Œå‰æš‚åœï¼Œä¸æ˜¯æ‰§è¡Œå</td>
                                    <td>å®Œå…¨é˜»æ­¢ä¸å½“æ“ä½œ</td>
                                </tr>
                                <tr>
                                    <td><strong>ä¸‰ç§å†³ç­–</strong></td>
                                    <td>æ‰¹å‡†ã€ç¼–è¾‘ã€æ‹’ç»</td>
                                    <td>çµæ´»çš„å®¡æ‰¹æ§åˆ¶</td>
                                </tr>
                                <tr>
                                    <td><strong>æ‰¹é‡å¤„ç†</strong></td>
                                    <td>å¤šä¸ªå·¥å…·è°ƒç”¨ä¸€æ¬¡ä¸­æ–­</td>
                                    <td>æé«˜å®¡æ‰¹æ•ˆç‡</td>
                                </tr>
                                <tr>
                                    <td><strong>çŠ¶æ€æŒä¹…åŒ–</strong></td>
                                    <td>åŸºäº Checkpointer</td>
                                    <td>è·¨ä¼šè¯æ¢å¤</td>
                                </tr>
                                <tr>
                                    <td><strong>åˆ†å±‚é…ç½®</strong></td>
                                    <td>ä¸» Agent å’Œå­ Agent ç‹¬ç«‹é…ç½®</td>
                                    <td>ç²¾ç»†åŒ–æ§åˆ¶</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="mermaid-wrapper">
                        <div class="mermaid">
graph TB
    User["ç”¨æˆ·è¯·æ±‚"] --> Agent["DeepAgent<br/>æ‰§è¡Œ"]
    Agent -->|å·¥å…·è°ƒç”¨| Check{éœ€è¦<br/>å®¡æ‰¹?}

    Check -->|å¦| Execute1["ç›´æ¥æ‰§è¡Œ<br/>å·¥å…·"]
    Check -->|æ˜¯| Interrupt["â¸ï¸ ä¸­æ–­<br/>æš‚åœæ‰§è¡Œ"]

    Interrupt --> Review["äººå·¥å®¡æŸ¥"]
    Review --> Decision{å†³ç­–}

    Decision -->|æ‰¹å‡†| Execute2["âœ… æ‰§è¡Œ<br/>åŸå§‹å‚æ•°"]
    Decision -->|ç¼–è¾‘| Execute3["âœï¸ æ‰§è¡Œ<br/>ä¿®æ”¹åå‚æ•°"]
    Decision -->|æ‹’ç»| Skip["âŒ è·³è¿‡<br/>ä¸æ‰§è¡Œ"]

    Execute1 --> Result["ç»§ç»­æ‰§è¡Œ"]
    Execute2 --> Result
    Execute3 --> Result
    Skip --> Result

    Result --> Final["è¿”å›ç»“æœ"]

    style Check fill:#f59e0b,color:#fff
    style Interrupt fill:#ef4444,color:#fff
    style Review fill:#3b82f6,color:#fff
    style Execute2 fill:#10b981,color:#fff
    style Execute3 fill:#8b5cf6,color:#fff
    style Skip fill:#6b7280,color:#fff
                        </div>
                    </div>
                </section>

                <!-- interrupt_on é…ç½® -->
                <section class="content-section">
                    <h2 class="section-title">âš™ï¸ interrupt_on å‚æ•°é…ç½®</h2>
                    <p>
                        é€šè¿‡ <code>interrupt_on</code> å‚æ•°æŒ‡å®šå“ªäº›å·¥å…·éœ€è¦äººå·¥å®¡æ‰¹ã€‚
                        æ”¯æŒå¤šç§é…ç½®æ–¹å¼ï¼š
                    </p>

                    <h3 class="subsection-title">åŸºç¡€é…ç½®æ–¹å¼</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty basic">ğŸŸ¢ åŸºç¡€</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
interrupt_on åŸºç¡€é…ç½®
"""
from deepagents import create_deep_agent

# æ–¹å¼ 1ï¼šå¸ƒå°”å€¼ï¼ˆæ¨èç”¨äºç®€å•åœºæ™¯ï¼‰
agent = create_deep_agent(
    model="gpt-4o",
    tools=[delete_file, read_file, send_email],
    interrupt_on={
        "delete_file": True,   # å¯ç”¨ä¸­æ–­
        "read_file": False,    # ç¦ç”¨ä¸­æ–­
        "send_email": True,    # å¯ç”¨ä¸­æ–­
    }
)

# æ–¹å¼ 2ï¼šå­—å…¸å½¢å¼ï¼ˆé«˜çº§æ§åˆ¶ï¼‰
agent = create_deep_agent(
    model="gpt-4o",
    tools=[delete_file, send_email, modify_database],
    interrupt_on={
        # å…è®¸æ‰€æœ‰ä¸‰ç§å†³ç­–
        "delete_file": {
            "allowed_decisions": ["approve", "edit", "reject"]
        },

        # ä»…å…è®¸æ‰¹å‡†æˆ–æ‹’ç»ï¼Œä¸å…è®¸ç¼–è¾‘
        "send_email": {
            "allowed_decisions": ["approve", "reject"]
        },

        # ä»…å…è®¸æ‰¹å‡†ï¼ˆå¼ºåˆ¶æ‰§è¡Œï¼Œä½†éœ€è¦ç¡®è®¤ï¼‰
        "modify_database": {
            "allowed_decisions": ["approve"]
        },
    }
)</code></pre>
                    </div>

                    <h3 class="subsection-title">é…ç½®å­—æ®µè¯´æ˜</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>é…ç½®æ–¹å¼</th>
                                <th>è¯´æ˜</th>
                                <th>é€‚ç”¨åœºæ™¯</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>True</code></td>
                                <td>å¯ç”¨ä¸­æ–­ï¼Œå…è®¸æ‰€æœ‰å†³ç­–ç±»å‹</td>
                                <td>é€šç”¨åœºæ™¯ï¼Œæœ€å¤§çµæ´»æ€§</td>
                            </tr>
                            <tr>
                                <td><code>False</code></td>
                                <td>ç¦ç”¨ä¸­æ–­ï¼Œå·¥å…·ç›´æ¥æ‰§è¡Œ</td>
                                <td>å®‰å…¨æ“ä½œï¼Œæ— éœ€å®¡æ‰¹</td>
                            </tr>
                            <tr>
                                <td><code>{"allowed_decisions": [...]}</code></td>
                                <td>ç²¾ç¡®æ§åˆ¶å…è®¸çš„å†³ç­–ç±»å‹</td>
                                <td>ä¸åŒé£é™©ç­‰çº§çš„æ“ä½œ</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3 class="subsection-title">ä¸‰ç§å†³ç­–ç±»å‹</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>å†³ç­–ç±»å‹</th>
                                <th>è¡Œä¸º</th>
                                <th>ä½¿ç”¨åœºæ™¯</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>approve</code></td>
                                <td>ä½¿ç”¨åŸå§‹å‚æ•°æ‰§è¡Œå·¥å…·</td>
                                <td>å‚æ•°æ­£ç¡®ï¼Œæ‰¹å‡†æ‰§è¡Œ</td>
                            </tr>
                            <tr>
                                <td><code>edit</code></td>
                                <td>ä¿®æ”¹å·¥å…·å‚æ•°åæ‰§è¡Œ</td>
                                <td>å‚æ•°éœ€è¦è°ƒæ•´ï¼ˆå¦‚é‚®ä»¶åœ°å€é”™è¯¯ï¼‰</td>
                            </tr>
                            <tr>
                                <td><code>reject</code></td>
                                <td>å®Œå…¨è·³è¿‡å·¥å…·æ‰§è¡Œ</td>
                                <td>æ“ä½œä¸å®‰å…¨æˆ–ä¸å¿…è¦</td>
                            </tr>
                        </tbody>
                    </table>
                </section>

                <!-- å®Œæ•´ HITL å·¥ä½œæµ -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ”„ å®Œæ•´ HITL å·¥ä½œæµ</h2>
                    <p>
                        å®ç° Human-in-the-Loop éœ€è¦ä»¥ä¸‹æ­¥éª¤ï¼š
                    </p>

                    <div class="mermaid-wrapper">
                        <div class="mermaid">
sequenceDiagram
    participant User as ç”¨æˆ·
    participant Agent as DeepAgent
    participant Tool as æ•æ„Ÿå·¥å…·
    participant Review as äººå·¥å®¡æŸ¥

    User->>Agent: å‘èµ·è¯·æ±‚
    Agent->>Agent: å†³å®šè°ƒç”¨å·¥å…·
    Agent->>Tool: å‡†å¤‡è°ƒç”¨<br/>delete_file()

    Note over Agent,Tool: â¸ï¸ æ£€æµ‹åˆ°éœ€è¦å®¡æ‰¹
    Agent->>Agent: ä¿å­˜çŠ¶æ€<br/>(Checkpointer)
    Agent-->>User: è¿”å›ä¸­æ–­ä¿¡å·<br/>__interrupt__

    User->>Review: å±•ç¤ºå¾…å®¡æ‰¹æ“ä½œ
    Review->>Review: å®¡æŸ¥å‚æ•°<br/>è¯„ä¼°é£é™©
    Review->>User: åšå‡ºå†³ç­–<br/>(approve/edit/reject)

    User->>Agent: æ¢å¤æ‰§è¡Œ<br/>Command(resume={...})

    alt æ‰¹å‡†
        Agent->>Tool: âœ… æ‰§è¡ŒåŸå§‹æ“ä½œ
        Tool-->>Agent: è¿”å›ç»“æœ
    else ç¼–è¾‘
        Agent->>Tool: âœï¸ æ‰§è¡Œä¿®æ”¹åæ“ä½œ
        Tool-->>Agent: è¿”å›ç»“æœ
    else æ‹’ç»
        Agent->>Agent: âŒ è·³è¿‡æ‰§è¡Œ
    end

    Agent-->>User: è¿”å›æœ€ç»ˆç»“æœ
                        </div>
                    </div>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty intermediate">ğŸŸ¡ ä¸­çº§ - å®Œæ•´ç¤ºä¾‹</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
å®Œæ•´çš„ Human-in-the-Loop å·¥ä½œæµ
"""
import os
import uuid
from langchain.tools import tool
from deepagents import create_deep_agent
from langgraph.checkpoint.memory import MemorySaver
from langgraph.types import Command

# æ­¥éª¤ 1: å®šä¹‰éœ€è¦å®¡æ‰¹çš„å·¥å…·
@tool
def delete_file(path: str) -> str:
    """åˆ é™¤æ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶"""
    # å®é™…ä¼šæ‰§è¡Œåˆ é™¤æ“ä½œ
    import os
    os.remove(path)
    return f"å·²åˆ é™¤æ–‡ä»¶ï¼š{path}"

@tool
def send_email(to: str, subject: str, body: str) -> str:
    """å‘é€ç”µå­é‚®ä»¶"""
    # å®é™…ä¼šè°ƒç”¨é‚®ä»¶æœåŠ¡
    return f"å·²å‘é€é‚®ä»¶åˆ° {to}"

# æ­¥éª¤ 2: åˆ›å»º Checkpointerï¼ˆå¿…éœ€ï¼ï¼‰
checkpointer = MemorySaver()

# æ­¥éª¤ 3: é…ç½® Agent çš„ interrupt_on
agent = create_deep_agent(
    model="claude-sonnet-4-5-20250929",
    tools=[delete_file, send_email],
    interrupt_on={
        "delete_file": True,    # éœ€è¦å®¡æ‰¹
        "send_email": True,     # éœ€è¦å®¡æ‰¹
    },
    checkpointer=checkpointer,  # å¿…éœ€ï¼šçŠ¶æ€æŒä¹…åŒ–
    system_prompt="ä½ æ˜¯æ–‡ä»¶ç®¡ç†åŠ©æ‰‹ï¼Œå¯ä»¥åˆ é™¤æ–‡ä»¶å’Œå‘é€é€šçŸ¥é‚®ä»¶ã€‚"
)

# æ­¥éª¤ 4: é…ç½®çº¿ç¨‹ IDï¼ˆç”¨äºçŠ¶æ€ç®¡ç†ï¼‰
config = {"configurable": {"thread_id": str(uuid.uuid4())}}

# æ­¥éª¤ 5: è°ƒç”¨ Agent
print("=== æ­¥éª¤ 1: è°ƒç”¨ Agent ===")
result = agent.invoke({
    "messages": [{
        "role": "user",
        "content": "åˆ é™¤ä¸´æ—¶æ–‡ä»¶ /tmp/cache.txt å¹¶å‘é‚®ä»¶é€šçŸ¥ç®¡ç†å‘˜"
    }]
}, config=config)

# æ­¥éª¤ 6: æ£€æŸ¥æ˜¯å¦å‘ç”Ÿä¸­æ–­
if result.get("__interrupt__"):
    print("\n=== æ­¥éª¤ 2: æ£€æµ‹åˆ°ä¸­æ–­ ===")

    # æå–ä¸­æ–­ä¿¡æ¯
    interrupts = result["__interrupt__"][0].value
    action_requests = interrupts["action_requests"]
    review_configs = interrupts["review_configs"]

    print(f"éœ€è¦å®¡æ‰¹çš„æ“ä½œæ•°é‡: {len(action_requests)}")

    # æ­¥éª¤ 7: å±•ç¤ºå¾…å®¡æ‰¹æ“ä½œ
    print("\n=== æ­¥éª¤ 3: å¾…å®¡æ‰¹æ“ä½œ ===")
    for i, action in enumerate(action_requests, 1):
        print(f"\næ“ä½œ {i}:")
        print(f"  å·¥å…·åç§°: {action['name']}")
        print(f"  å·¥å…·å‚æ•°: {action['args']}")

    # æ­¥éª¤ 8: äººå·¥å†³ç­–ï¼ˆè¿™é‡Œæ¨¡æ‹Ÿç”¨æˆ·è¾“å…¥ï¼‰
    print("\n=== æ­¥éª¤ 4: äººå·¥å†³ç­– ===")
    decisions = []

    for action in action_requests:
        if action['name'] == 'delete_file':
            # æ‰¹å‡†åˆ é™¤æ“ä½œ
            decisions.append({"type": "approve"})
            print(f"âœ… æ‰¹å‡†æ‰§è¡Œ: {action['name']}")

        elif action['name'] == 'send_email':
            # ç¼–è¾‘é‚®ä»¶åœ°å€
            decisions.append({
                "type": "edit",
                "edited_action": {
                    "name": "send_email",
                    "args": {
                        "to": "admin@company.com",  # ä¿®æ”¹æ”¶ä»¶äºº
                        "subject": action['args']['subject'],
                        "body": action['args']['body']
                    }
                }
            })
            print(f"âœï¸ ç¼–è¾‘åæ‰§è¡Œ: {action['name']}")

    # æ­¥éª¤ 9: æ¢å¤æ‰§è¡Œï¼ˆä½¿ç”¨ç›¸åŒçš„ configï¼ï¼‰
    print("\n=== æ­¥éª¤ 5: æ¢å¤æ‰§è¡Œ ===")
    result = agent.invoke(
        Command(resume={"decisions": decisions}),
        config=config  # âš ï¸ å¿…é¡»ä½¿ç”¨ç›¸åŒçš„ thread_id
    )

    print("\n=== æ­¥éª¤ 6: æ‰§è¡Œå®Œæˆ ===")
    print(f"æœ€ç»ˆç»“æœ:\n{result['messages'][-1].content}")

else:
    print("æ— éœ€å®¡æ‰¹ï¼Œç›´æ¥æ‰§è¡Œå®Œæˆ")
    print(f"ç»“æœ:\n{result['messages'][-1].content}")

# è¾“å‡ºç¤ºä¾‹ï¼š
# === æ­¥éª¤ 1: è°ƒç”¨ Agent ===
# === æ­¥éª¤ 2: æ£€æµ‹åˆ°ä¸­æ–­ ===
# éœ€è¦å®¡æ‰¹çš„æ“ä½œæ•°é‡: 2
#
# === æ­¥éª¤ 3: å¾…å®¡æ‰¹æ“ä½œ ===
# æ“ä½œ 1:
#   å·¥å…·åç§°: delete_file
#   å·¥å…·å‚æ•°: {'path': '/tmp/cache.txt'}
#
# æ“ä½œ 2:
#   å·¥å…·åç§°: send_email
#   å·¥å…·å‚æ•°: {'to': 'admin@example.com', 'subject': '...', 'body': '...'}
#
# === æ­¥éª¤ 4: äººå·¥å†³ç­– ===
# âœ… æ‰¹å‡†æ‰§è¡Œ: delete_file
# âœï¸ ç¼–è¾‘åæ‰§è¡Œ: send_email
#
# === æ­¥éª¤ 5: æ¢å¤æ‰§è¡Œ ===
# === æ­¥éª¤ 6: æ‰§è¡Œå®Œæˆ ===
# æœ€ç»ˆç»“æœ:
# å·²æˆåŠŸåˆ é™¤æ–‡ä»¶å¹¶å‘é€é€šçŸ¥é‚®ä»¶ã€‚</code></pre>
                    </div>
                </section>

                <!-- ä¸‰ç§å†³ç­–ç±»å‹ç¤ºä¾‹ -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ¯ ä¸‰ç§å†³ç­–ç±»å‹è¯¦è§£</h2>

                    <h3 class="subsection-title">å†³ç­– 1: Approveï¼ˆæ‰¹å‡†ï¼‰</h3>
                    <p>
                        <strong>ä½¿ç”¨åŸå§‹å‚æ•°æ‰§è¡Œå·¥å…·</strong>ï¼Œä¸åšä»»ä½•ä¿®æ”¹ï¼š
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty basic">ğŸŸ¢ åŸºç¡€</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
å†³ç­–ç±»å‹ 1: Approve
"""
# æ‰¹å‡†æ‰§è¡Œï¼Œä½¿ç”¨åŸå§‹å‚æ•°
decisions = [{"type": "approve"}]

result = agent.invoke(
    Command(resume={"decisions": decisions}),
    config=config
)

# Agent ä¼šä½¿ç”¨åŸå§‹å‚æ•°æ‰§è¡Œå·¥å…·ï¼š
# delete_file(path="/tmp/cache.txt")</code></pre>
                    </div>

                    <h3 class="subsection-title">å†³ç­– 2: Editï¼ˆç¼–è¾‘ï¼‰</h3>
                    <p>
                        <strong>ä¿®æ”¹å·¥å…·å‚æ•°åæ‰§è¡Œ</strong>ï¼Œé€‚ç”¨äºå‚æ•°éœ€è¦è°ƒæ•´çš„åœºæ™¯ï¼š
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty intermediate">ğŸŸ¡ ä¸­çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
å†³ç­–ç±»å‹ 2: Edit
"""
# ç¼–è¾‘å‚æ•°åæ‰§è¡Œ
decisions = [{
    "type": "edit",
    "edited_action": {
        "name": "send_email",  # å¿…é¡»æŒ‡å®šå·¥å…·åç§°
        "args": {               # å®Œæ•´çš„æ–°å‚æ•°
            "to": "correct@company.com",  # ä¿®æ”¹åçš„æ”¶ä»¶äºº
            "subject": "System Alert",
            "body": "File deleted successfully."
        }
    }
}]

result = agent.invoke(
    Command(resume={"decisions": decisions}),
    config=config
)

# Agent ä¼šä½¿ç”¨ä¿®æ”¹åçš„å‚æ•°æ‰§è¡Œå·¥å…·ï¼š
# send_email(to="correct@company.com", ...)</code></pre>
                    </div>

                    <h3 class="subsection-title">å†³ç­– 3: Rejectï¼ˆæ‹’ç»ï¼‰</h3>
                    <p>
                        <strong>å®Œå…¨è·³è¿‡å·¥å…·æ‰§è¡Œ</strong>ï¼Œå·¥å…·ä¸ä¼šè¢«è°ƒç”¨ï¼š
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty basic">ğŸŸ¢ åŸºç¡€</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
å†³ç­–ç±»å‹ 3: Reject
"""
# æ‹’ç»æ‰§è¡Œï¼Œè·³è¿‡å·¥å…·è°ƒç”¨
decisions = [{"type": "reject"}]

result = agent.invoke(
    Command(resume={"decisions": decisions}),
    config=config
)

# Agent ä¼šè·³è¿‡å·¥å…·æ‰§è¡Œï¼Œä¸è°ƒç”¨ delete_file()
# Agent ä¼šçŸ¥é“æ“ä½œè¢«æ‹’ç»ï¼Œå¯ä»¥ç»§ç»­æ‰§è¡Œå…¶ä»–ä»»åŠ¡</code></pre>
                    </div>
                </section>

                <!-- å¤šå·¥å…·ä¸­æ–­å¤„ç† -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ“¦ å¤šå·¥å…·ä¸­æ–­å¤„ç†</h2>
                    <p>
                        å½“ Agent éœ€è¦è°ƒç”¨<strong>å¤šä¸ªéœ€è¦å®¡æ‰¹çš„å·¥å…·</strong>æ—¶ï¼Œ
                        å®ƒä»¬ä¼š<strong>æ‰¹é‡æ‰“åŒ…åœ¨ä¸€æ¬¡ä¸­æ–­</strong>ä¸­ã€‚
                        å†³ç­–åˆ—è¡¨çš„é¡ºåºå¿…é¡»ä¸ action_requests çš„é¡ºåºä¸€è‡´ã€‚
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty advanced">ğŸ”´ é«˜çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
å¤šå·¥å…·ä¸­æ–­å¤„ç†
"""
import uuid
from langchain.tools import tool
from deepagents import create_deep_agent
from langgraph.checkpoint.memory import MemorySaver
from langgraph.types import Command

@tool
def delete_file(path: str) -> str:
    """åˆ é™¤æ–‡ä»¶"""
    return f"å·²åˆ é™¤ï¼š{path}"

@tool
def send_email(to: str, subject: str) -> str:
    """å‘é€é‚®ä»¶"""
    return f"å·²å‘é€é‚®ä»¶åˆ°ï¼š{to}"

@tool
def backup_database() -> str:
    """å¤‡ä»½æ•°æ®åº“"""
    return "æ•°æ®åº“å·²å¤‡ä»½"

# é…ç½® Agent
checkpointer = MemorySaver()
agent = create_deep_agent(
    model="gpt-4o",
    tools=[delete_file, send_email, backup_database],
    interrupt_on={
        "delete_file": True,
        "send_email": True,
        "backup_database": True,
    },
    checkpointer=checkpointer
)

config = {"configurable": {"thread_id": str(uuid.uuid4())}}

# è°ƒç”¨ Agentï¼ˆéœ€è¦å¤šä¸ªå·¥å…·ï¼‰
result = agent.invoke({
    "messages": [{
        "role": "user",
        "content": "åˆ é™¤æ—§æ—¥å¿—æ–‡ä»¶ã€å¤‡ä»½æ•°æ®åº“ã€ç„¶åå‘é‚®ä»¶é€šçŸ¥"
    }]
}, config=config)

# æ£€æŸ¥ä¸­æ–­
if result.get("__interrupt__"):
    interrupts = result["__interrupt__"][0].value
    action_requests = interrupts["action_requests"]

    print(f"éœ€è¦å®¡æ‰¹ {len(action_requests)} ä¸ªæ“ä½œ\n")

    # å±•ç¤ºæ‰€æœ‰å¾…å®¡æ‰¹æ“ä½œ
    for i, action in enumerate(action_requests, 1):
        print(f"æ“ä½œ {i}: {action['name']}")
        print(f"  å‚æ•°: {action['args']}\n")

    # âš ï¸ å…³é”®ï¼šå†³ç­–é¡ºåºå¿…é¡»ä¸ action_requests é¡ºåºä¸€è‡´
    decisions = [
        {"type": "approve"},     # ç¬¬ 1 ä¸ªå·¥å…·ï¼šdelete_file
        {"type": "reject"},      # ç¬¬ 2 ä¸ªå·¥å…·ï¼šbackup_databaseï¼ˆæ‹’ç»ï¼‰
        {"type": "approve"},     # ç¬¬ 3 ä¸ªå·¥å…·ï¼šsend_email
    ]

    # æ¢å¤æ‰§è¡Œ
    result = agent.invoke(
        Command(resume={"decisions": decisions}),
        config=config
    )

    print("æ‰§è¡Œç»“æœ:")
    print(result["messages"][-1].content)

# è¾“å‡ºç¤ºä¾‹ï¼š
# éœ€è¦å®¡æ‰¹ 3 ä¸ªæ“ä½œ
#
# æ“ä½œ 1: delete_file
#   å‚æ•°: {'path': '/var/log/old.log'}
#
# æ“ä½œ 2: backup_database
#   å‚æ•°: {}
#
# æ“ä½œ 3: send_email
#   å‚æ•°: {'to': 'admin@company.com', 'subject': 'Maintenance Complete'}
#
# æ‰§è¡Œç»“æœ:
# å·²åˆ é™¤æ—§æ—¥å¿—æ–‡ä»¶ï¼Œè·³è¿‡äº†æ•°æ®åº“å¤‡ä»½ï¼Œå¹¶å‘é€äº†é€šçŸ¥é‚®ä»¶ã€‚</code></pre>
                    </div>

                    <div class="info-box warning">
                        <div class="info-box-title">âš ï¸ å†³ç­–é¡ºåºçš„é‡è¦æ€§</div>
                        <ul>
                            <li><strong>é¡ºåºå¿…é¡»ä¸€è‡´</strong>ï¼šdecisions åˆ—è¡¨çš„é¡ºåºå¿…é¡»ä¸ action_requests é¡ºåºä¸€è‡´</li>
                            <li><strong>æ•°é‡å¿…é¡»åŒ¹é…</strong>ï¼šdecisions çš„é•¿åº¦å¿…é¡»ç­‰äº action_requests çš„é•¿åº¦</li>
                            <li><strong>ä¸èƒ½é—æ¼</strong>ï¼šæ¯ä¸ªæ“ä½œéƒ½å¿…é¡»æœ‰å¯¹åº”çš„å†³ç­–</li>
                        </ul>
                    </div>
                </section>

                <!-- å­ä»£ç†ä¸­æ–­é…ç½® -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ¯ å­ä»£ç†ä¸­æ–­é…ç½®</h2>
                    <p>
                        æ¯ä¸ª<strong>å­ä»£ç†å¯ä»¥è¦†ç›–ä¸» Agent çš„ interrupt_on è®¾ç½®</strong>ï¼Œ
                        å®ç°ç²¾ç»†åŒ–çš„å®¡æ‰¹æ§åˆ¶ï¼š
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty advanced">ğŸ”´ é«˜çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
å­ä»£ç†ä¸­æ–­é…ç½® - åˆ†å±‚æ§åˆ¶
"""
from langchain.tools import tool
from deepagents import create_deep_agent
from langgraph.checkpoint.memory import MemorySaver

@tool
def delete_file(path: str) -> str:
    """åˆ é™¤æ–‡ä»¶"""
    return f"å·²åˆ é™¤ï¼š{path}"

@tool
def read_file(path: str) -> str:
    """è¯»å–æ–‡ä»¶"""
    with open(path, 'r') as f:
        return f.read()

# åˆ›å»º Agent
checkpointer = MemorySaver()

agent = create_deep_agent(
    model="gpt-4o",
    tools=[delete_file, read_file],

    # ä¸» Agent çš„ä¸­æ–­é…ç½®
    interrupt_on={
        "delete_file": True,    # ä¸» Agent ä¸­éœ€è¦å®¡æ‰¹
        "read_file": False,     # ä¸» Agent ä¸­æ— éœ€å®¡æ‰¹
    },

    # å­ä»£ç†é…ç½®
    subagents=[{
        "name": "file-manager",
        "description": "ç®¡ç†æ–‡ä»¶çš„ä¸“é—¨ä»£ç†",
        "tools": [delete_file, read_file],
        "system_prompt": "ä½ æ˜¯æ–‡ä»¶ç®¡ç†ä¸“å®¶ã€‚",

        # å­ä»£ç†çš„ä¸­æ–­é…ç½®ï¼ˆè¦†ç›–ä¸» Agentï¼‰
        "interrupt_on": {
            "delete_file": True,     # å­ä»£ç†ä¸­ä¹Ÿéœ€è¦å®¡æ‰¹
            "read_file": True,       # âš ï¸ å­ä»£ç†ä¸­éœ€è¦å®¡æ‰¹ï¼ˆä¸ä¸» Agent ä¸åŒï¼‰
        }
    }],

    checkpointer=checkpointer
)

# ä½¿ç”¨åœºæ™¯ï¼š
# 1. ä¸» Agent ç›´æ¥è°ƒç”¨ delete_file â†’ éœ€è¦å®¡æ‰¹
# 2. ä¸» Agent ç›´æ¥è°ƒç”¨ read_file â†’ æ— éœ€å®¡æ‰¹
# 3. ä¸» Agent å§”æ´¾ç»™ file-manager å­ä»£ç†
#    â†’ å­ä»£ç†è°ƒç”¨ delete_file â†’ éœ€è¦å®¡æ‰¹
#    â†’ å­ä»£ç†è°ƒç”¨ read_file â†’ éœ€è¦å®¡æ‰¹ï¼ˆä¸åŒäºä¸» Agentï¼‰

# ä¸ºä»€ä¹ˆå­ä»£ç†é…ç½®ä¸åŒï¼Ÿ
# - å­ä»£ç†å¯èƒ½åœ¨æ›´æ•æ„Ÿçš„ä¸Šä¸‹æ–‡ä¸­æ“ä½œ
# - å­ä»£ç†å¯èƒ½å¤„ç†æ›´å…³é”®çš„æ•°æ®
# - ä¸åŒçš„å­ä»£ç†æœ‰ä¸åŒçš„å®¡æ‰¹ç­–ç•¥</code></pre>
                    </div>
                </section>

                <!-- é£é™©ç­‰çº§é…ç½®ç­–ç•¥ -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ›¡ï¸ é£é™©ç­‰çº§é…ç½®ç­–ç•¥</h2>
                    <p>
                        æ ¹æ®æ“ä½œçš„<strong>æ•æ„Ÿç¨‹åº¦å’Œé£é™©ç­‰çº§</strong>ï¼Œ
                        é…ç½®ä¸åŒçš„å®¡æ‰¹ç­–ç•¥ï¼š
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty advanced">ğŸ”´ é«˜çº§ - ç”Ÿäº§çº§é…ç½®</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
é£é™©ç­‰çº§é…ç½®ç­–ç•¥
"""
from langchain.tools import tool
from deepagents import create_deep_agent
from langgraph.checkpoint.memory import MemorySaver

# å®šä¹‰ä¸åŒé£é™©ç­‰çº§çš„å·¥å…·
@tool
def delete_production_data(table: str) -> str:
    """åˆ é™¤ç”Ÿäº§ç¯å¢ƒæ•°æ®ï¼ˆé«˜é£é™©ï¼‰"""
    return f"å·²åˆ é™¤ç”Ÿäº§è¡¨ï¼š{table}"

@tool
def send_marketing_email(recipients: list, content: str) -> str:
    """å‘é€è¥é”€é‚®ä»¶ï¼ˆä¸­ç­‰é£é™©ï¼‰"""
    return f"å·²å‘é€é‚®ä»¶ç»™ {len(recipients)} ä¸ªæ”¶ä»¶äºº"

@tool
def read_log_file(path: str) -> str:
    """è¯»å–æ—¥å¿—æ–‡ä»¶ï¼ˆä½é£é™©ï¼‰"""
    return f"æ—¥å¿—å†…å®¹ï¼š..."

@tool
def update_cache(key: str, value: str) -> str:
    """æ›´æ–°ç¼“å­˜ï¼ˆæ— é£é™©ï¼‰"""
    return f"ç¼“å­˜å·²æ›´æ–°ï¼š{key}"

# é£é™©ç­‰çº§é…ç½®
checkpointer = MemorySaver()

agent = create_deep_agent(
    model="claude-sonnet-4-5-20250929",
    tools=[
        delete_production_data,
        send_marketing_email,
        read_log_file,
        update_cache
    ],
    interrupt_on={
        # ğŸ”´ é«˜é£é™©ï¼šå®Œå…¨æ§åˆ¶ï¼ˆæ‰¹å‡†ã€ç¼–è¾‘ã€æ‹’ç»ï¼‰
        "delete_production_data": {
            "allowed_decisions": ["approve", "edit", "reject"]
        },

        # ğŸŸ¡ ä¸­ç­‰é£é™©ï¼šä»…æ‰¹å‡†/æ‹’ç»ï¼Œä¸å…è®¸ç¼–è¾‘
        "send_marketing_email": {
            "allowed_decisions": ["approve", "reject"]
        },

        # ğŸŸ¢ ä½é£é™©ï¼šä»…éœ€ç¡®è®¤ï¼ˆåªèƒ½æ‰¹å‡†ï¼‰
        "read_log_file": {
            "allowed_decisions": ["approve"]
        },

        # âšª æ— é£é™©ï¼šæ— éœ€å®¡æ‰¹
        "update_cache": False,
    },
    checkpointer=checkpointer,
    system_prompt="""ä½ æ˜¯ç³»ç»Ÿç®¡ç†åŠ©æ‰‹ã€‚æ‰§è¡Œæ“ä½œæ—¶éœ€è¦éµå¾ªä¸¥æ ¼çš„å®¡æ‰¹ç­–ç•¥ï¼š

- åˆ é™¤ç”Ÿäº§æ•°æ®ï¼šé«˜é£é™©ï¼Œå¿…é¡»äººå·¥å®¡æ‰¹
- å‘é€è¥é”€é‚®ä»¶ï¼šä¸­ç­‰é£é™©ï¼Œéœ€è¦ç¡®è®¤
- è¯»å–æ—¥å¿—æ–‡ä»¶ï¼šä½é£é™©ï¼Œä»…éœ€ç¡®è®¤
- æ›´æ–°ç¼“å­˜ï¼šæ— é£é™©ï¼Œè‡ªåŠ¨æ‰§è¡Œ
"""
)

# é…ç½®è¡¨æ ¼
print("é£é™©ç­‰çº§é…ç½®ç­–ç•¥ï¼š\n")
print("| å·¥å…·                    | é£é™©ç­‰çº§ | å…è®¸çš„å†³ç­–              | è¯´æ˜")
print("|------------------------|---------|------------------------|--------")
print("| delete_production_data | ğŸ”´ é«˜   | approve, edit, reject  | å®Œå…¨æ§åˆ¶")
print("| send_marketing_email   | ğŸŸ¡ ä¸­   | approve, reject        | ä»…æ‰¹å‡†/æ‹’ç»")
print("| read_log_file          | ğŸŸ¢ ä½   | approve                | ä»…éœ€ç¡®è®¤")
print("| update_cache           | âšª æ—    | -                      | è‡ªåŠ¨æ‰§è¡Œ")</code></pre>
                    </div>

                    <h3 class="subsection-title">é£é™©ç­‰çº§åˆ†ç±»æŒ‡å—</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>é£é™©ç­‰çº§</th>
                                <th>æ“ä½œç±»å‹</th>
                                <th>æ¨èé…ç½®</th>
                                <th>ç¤ºä¾‹</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>ğŸ”´ <strong>é«˜é£é™©</strong></td>
                                <td>ä¸å¯é€†çš„ç ´åæ€§æ“ä½œ</td>
                                <td>approve, edit, reject</td>
                                <td>åˆ é™¤æ•°æ®ã€è½¬è´¦ã€å‘å¸ƒä»£ç </td>
                            </tr>
                            <tr>
                                <td>ğŸŸ¡ <strong>ä¸­ç­‰é£é™©</strong></td>
                                <td>å¯é€†ä½†éœ€è°¨æ…çš„æ“ä½œ</td>
                                <td>approve, reject</td>
                                <td>å‘é€é‚®ä»¶ã€ä¿®æ”¹é…ç½®</td>
                            </tr>
                            <tr>
                                <td>ğŸŸ¢ <strong>ä½é£é™©</strong></td>
                                <td>éœ€è¦ç¡®è®¤ä½†å®‰å…¨çš„æ“ä½œ</td>
                                <td>approve</td>
                                <td>è¯»å–æ•æ„Ÿæ•°æ®ã€æŸ¥çœ‹æ—¥å¿—</td>
                            </tr>
                            <tr>
                                <td>âšª <strong>æ— é£é™©</strong></td>
                                <td>å®Œå…¨å®‰å…¨çš„æ“ä½œ</td>
                                <td>Falseï¼ˆæ— éœ€å®¡æ‰¹ï¼‰</td>
                                <td>æ›´æ–°ç¼“å­˜ã€è®°å½•æ—¥å¿—</td>
                            </tr>
                        </tbody>
                    </table>
                </section>

                <!-- æœ€ä½³å®è·µ -->
                <section class="content-section">
                    <h2 class="section-title">âœ¨ HITL æœ€ä½³å®è·µ</h2>

                    <h3 class="subsection-title">1. å¿…é¡»ä½¿ç”¨ Checkpointer</h3>
                    <div class="info-box warning">
                        <div class="info-box-title">âš ï¸ Checkpointer æ˜¯å¼ºåˆ¶æ€§è¦æ±‚</div>
                        <p>
                            Human-in-the-Loop åŠŸèƒ½<strong>å¿…é¡»é…åˆ Checkpointer ä½¿ç”¨</strong>ï¼Œ
                            ç”¨äºåœ¨ä¸­æ–­å’Œæ¢å¤ä¹‹é—´æŒä¹…åŒ– Agent çŠ¶æ€ã€‚
                        </p>
                    </div>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python"># âŒ é”™è¯¯ï¼šæ²¡æœ‰ Checkpointer
agent = create_deep_agent(
    interrupt_on={"delete_file": True}
    # ç¼ºå°‘ checkpointer å‚æ•°
)
# ä¼šå¯¼è‡´è¿è¡Œæ—¶é”™è¯¯ï¼

# âœ… æ­£ç¡®ï¼šåŒ…å« Checkpointer
from langgraph.checkpoint.memory import MemorySaver

checkpointer = MemorySaver()
agent = create_deep_agent(
    interrupt_on={"delete_file": True},
    checkpointer=checkpointer  # å¿…éœ€ï¼
)</code></pre>
                    </div>

                    <h3 class="subsection-title">2. çº¿ç¨‹ ID ä¸€è‡´æ€§</h3>
                    <p>
                        <strong>æ¢å¤æ‰§è¡Œæ—¶å¿…é¡»ä½¿ç”¨ç›¸åŒçš„ thread_id</strong>ï¼Œ
                        å¦åˆ™æ— æ³•æ¢å¤æ­£ç¡®çš„çŠ¶æ€ã€‚
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python"># âŒ é”™è¯¯ï¼šä½¿ç”¨ä¸åŒçš„ thread_id
config1 = {"configurable": {"thread_id": "thread-1"}}
result = agent.invoke({...}, config=config1)

# ä¸­æ–­å...
config2 = {"configurable": {"thread_id": "thread-2"}}  # ä¸åŒçš„ IDï¼
result = agent.invoke(Command(resume={...}), config=config2)  # ä¼šå¤±è´¥

# âœ… æ­£ç¡®ï¼šä½¿ç”¨ç›¸åŒçš„ thread_id
config = {"configurable": {"thread_id": "thread-1"}}
result = agent.invoke({...}, config=config)

# ä¸­æ–­å...
result = agent.invoke(Command(resume={...}), config=config)  # ç›¸åŒçš„ config</code></pre>
                    </div>

                    <h3 class="subsection-title">3. å†³ç­–é¡ºåºä¸æ•°é‡</h3>
                    <ul>
                        <li><strong>é¡ºåºä¸€è‡´</strong>ï¼šdecisions åˆ—è¡¨é¡ºåºå¿…é¡»ä¸ action_requests ä¸€è‡´</li>
                        <li><strong>æ•°é‡åŒ¹é…</strong>ï¼šæ¯ä¸ªæ“ä½œéƒ½å¿…é¡»æœ‰å¯¹åº”çš„å†³ç­–</li>
                        <li><strong>ç±»å‹éªŒè¯</strong>ï¼šç¡®ä¿å†³ç­–ç±»å‹åœ¨ allowed_decisions èŒƒå›´å†…</li>
                    </ul>

                    <h3 class="subsection-title">4. ç¼–è¾‘å‚æ•°çš„å®Œæ•´æ€§</h3>
                    <p>
                        ä½¿ç”¨ <code>edit</code> å†³ç­–æ—¶ï¼Œå¿…é¡»æä¾›<strong>å®Œæ•´çš„å·¥å…·å‚æ•°</strong>ï¼š
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python"># âŒ é”™è¯¯ï¼šå‚æ•°ä¸å®Œæ•´
decisions = [{
    "type": "edit",
    "edited_action": {
        "name": "send_email",
        "args": {"to": "new@example.com"}  # ç¼ºå°‘ subject å’Œ body
    }
}]

# âœ… æ­£ç¡®ï¼šå®Œæ•´å‚æ•°
decisions = [{
    "type": "edit",
    "edited_action": {
        "name": "send_email",
        "args": {
            "to": "new@example.com",
            "subject": "Updated Subject",
            "body": "Updated content"
        }
    }
}]</code></pre>
                    </div>

                    <h3 class="subsection-title">5. å®¡æ‰¹ UI é›†æˆ</h3>
                    <p>
                        åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œåº”è¯¥æ„å»º<strong>å‹å¥½çš„å®¡æ‰¹ç•Œé¢</strong>ï¼š
                    </p>

                    <ul>
                        <li>æ¸…æ™°å±•ç¤ºå¾…å®¡æ‰¹æ“ä½œçš„<strong>å·¥å…·åç§°ã€å‚æ•°ã€é£é™©ç­‰çº§</strong></li>
                        <li>æä¾›<strong>æ‰¹å‡†ã€ç¼–è¾‘ã€æ‹’ç»</strong>æŒ‰é’®</li>
                        <li>ç¼–è¾‘æ¨¡å¼å…è®¸ç”¨æˆ·<strong>ä¿®æ”¹å‚æ•°</strong></li>
                        <li>è®°å½•<strong>å®¡æ‰¹å†å²</strong>å’Œå†³ç­–åŸå› </li>
                        <li>æ”¯æŒ<strong>æ‰¹é‡å®¡æ‰¹</strong>å¤šä¸ªæ“ä½œ</li>
                    </ul>
                </section>

                <!-- å¸¸è§é—®é¢˜ -->
                <section class="content-section">
                    <h2 class="section-title">â“ å¸¸è§é—®é¢˜</h2>

                    <h3 class="subsection-subtitle">Q1: ä¸ºä»€ä¹ˆå¿…é¡»ä½¿ç”¨ Checkpointerï¼Ÿ</h3>
                    <p>
                        <strong>Checkpointer ç”¨äºæŒä¹…åŒ– Agent çŠ¶æ€</strong>ã€‚
                        ä¸­æ–­å‘ç”Ÿæ—¶ï¼ŒAgent çš„æ‰§è¡ŒçŠ¶æ€ï¼ˆåŒ…æ‹¬æ¶ˆæ¯å†å²ã€å·¥å…·è°ƒç”¨è¯·æ±‚ç­‰ï¼‰
                        éœ€è¦ä¿å­˜ä¸‹æ¥ï¼Œä»¥ä¾¿æ¢å¤æ—¶èƒ½ç»§ç»­æ‰§è¡Œã€‚æ²¡æœ‰ Checkpointerï¼Œ
                        çŠ¶æ€ä¼šä¸¢å¤±ï¼Œæ— æ³•æ¢å¤ã€‚
                    </p>

                    <h3 class="subsection-subtitle">Q2: å¯ä»¥è·¨ä¼šè¯æ¢å¤ä¸­æ–­çš„ Agent å—ï¼Ÿ</h3>
                    <p>
                        <strong>å¯ä»¥</strong>ï¼Œå¦‚æœä½¿ç”¨<strong>æŒä¹…åŒ–çš„ Checkpointer</strong>
                        ï¼ˆå¦‚ PostgresSaverã€RedisSaverï¼‰ï¼ŒçŠ¶æ€ä¼šä¿å­˜åˆ°æ•°æ®åº“ä¸­ã€‚
                        åªè¦ä½¿ç”¨ç›¸åŒçš„ thread_idï¼Œå³ä½¿åœ¨ä¸åŒçš„è¿›ç¨‹æˆ–æœåŠ¡å™¨å®ä¾‹ä¸­ï¼Œ
                        ä¹Ÿå¯ä»¥æ¢å¤æ‰§è¡Œã€‚
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python"># ä½¿ç”¨æŒä¹…åŒ– Checkpointer
from langgraph.checkpoint.postgres import PostgresSaver

checkpointer = PostgresSaver(connection_string="postgresql://...")

agent = create_deep_agent(
    interrupt_on={"delete_file": True},
    checkpointer=checkpointer
)

# è¿›ç¨‹ 1ï¼šè§¦å‘ä¸­æ–­
config = {"configurable": {"thread_id": "user-123-task-456"}}
result = agent.invoke({...}, config=config)

# ... è¿›ç¨‹é€€å‡º ...

# è¿›ç¨‹ 2ï¼šæ¢å¤æ‰§è¡Œï¼ˆå¯èƒ½åœ¨ä¸åŒæœåŠ¡å™¨ï¼‰
config = {"configurable": {"thread_id": "user-123-task-456"}}  # ç›¸åŒ ID
result = agent.invoke(Command(resume={...}), config=config)  # æˆåŠŸæ¢å¤</code></pre>
                    </div>

                    <h3 class="subsection-subtitle">Q3: å¦‚ä½•åœ¨ä¸­æ–­åå–æ¶ˆæ•´ä¸ªä»»åŠ¡ï¼Ÿ</h3>
                    <p>
                        <strong>æ‹’ç»æ‰€æœ‰å·¥å…·è°ƒç”¨</strong>å³å¯ï¼š
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python"># æ‹’ç»æ‰€æœ‰æ“ä½œ
if result.get("__interrupt__"):
    interrupts = result["__interrupt__"][0].value
    action_requests = interrupts["action_requests"]

    # å…¨éƒ¨æ‹’ç»
    decisions = [{"type": "reject"} for _ in action_requests]

    result = agent.invoke(
        Command(resume={"decisions": decisions}),
        config=config
    )

    # Agent ä¼šçŸ¥é“æ‰€æœ‰æ“ä½œè¢«æ‹’ç»ï¼Œå¯ä»¥ç”Ÿæˆç›¸åº”çš„æ¶ˆæ¯</code></pre>
                    </div>

                    <h3 class="subsection-subtitle">Q4: å¯ä»¥ä¸ºä¸åŒç”¨æˆ·é…ç½®ä¸åŒçš„å®¡æ‰¹ç­–ç•¥å—ï¼Ÿ</h3>
                    <p>
                        <strong>å¯ä»¥</strong>ï¼Œé€šè¿‡<strong>åŠ¨æ€é…ç½® interrupt_on</strong>ï¼š
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">def create_user_agent(user_role: str):
    """æ ¹æ®ç”¨æˆ·è§’è‰²åˆ›å»º Agent"""

    if user_role == "admin":
        # ç®¡ç†å‘˜ï¼šæ— éœ€å®¡æ‰¹
        interrupt_on = {}
    elif user_role == "operator":
        # æ“ä½œå‘˜ï¼šä»…é«˜é£é™©æ“ä½œéœ€å®¡æ‰¹
        interrupt_on = {"delete_file": True}
    else:
        # æ™®é€šç”¨æˆ·ï¼šæ‰€æœ‰æ•æ„Ÿæ“ä½œéœ€å®¡æ‰¹
        interrupt_on = {
            "delete_file": True,
            "send_email": True,
            "modify_database": True
        }

    return create_deep_agent(
        interrupt_on=interrupt_on,
        checkpointer=checkpointer
    )

# ä½¿ç”¨
admin_agent = create_user_agent("admin")
user_agent = create_user_agent("user")</code></pre>
                    </div>

                    <h3 class="subsection-subtitle">Q5: ä¸­æ–­ä¼šå½±å“ Agent æ€§èƒ½å—ï¼Ÿ</h3>
                    <p>
                        <strong>ä¸­æ–­æœ¬èº«ä¸å½±å“æ€§èƒ½</strong>ã€‚ä½†è¦æ³¨æ„ï¼š
                    </p>
                    <ul>
                        <li><strong>Checkpointer å¼€é”€</strong>ï¼šæŒä¹…åŒ– Checkpointerï¼ˆå¦‚ PostgresSaverï¼‰æœ‰ I/O å¼€é”€</li>
                        <li><strong>äººå·¥å“åº”æ—¶é—´</strong>ï¼šç­‰å¾…å®¡æ‰¹æœŸé—´ï¼ŒAgent å¤„äºæš‚åœçŠ¶æ€</li>
                        <li><strong>å»ºè®®</strong>ï¼šåˆç†é…ç½®å“ªäº›å·¥å…·éœ€è¦å®¡æ‰¹ï¼Œé¿å…è¿‡åº¦ä¸­æ–­</li>
                    </ul>

                    <h3 class="subsection-subtitle">Q6: å¦‚ä½•å®ç°è¶…æ—¶è‡ªåŠ¨æ‹’ç»ï¼Ÿ</h3>
                    <p>
                        å¯ä»¥åœ¨åº”ç”¨å±‚å®ç°<strong>è¶…æ—¶é€»è¾‘</strong>ï¼š
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">import time

# è§¦å‘ä¸­æ–­
result = agent.invoke({...}, config=config)

if result.get("__interrupt__"):
    # è®°å½•ä¸­æ–­æ—¶é—´
    interrupt_time = time.time()
    timeout_seconds = 300  # 5 åˆ†é’Ÿè¶…æ—¶

    # ç­‰å¾…ç”¨æˆ·å†³ç­–ï¼ˆåº”è¯¥åœ¨å¼‚æ­¥ç¯å¢ƒä¸­å®ç°ï¼‰
    # ... ç­‰å¾…ç”¨æˆ·è¾“å…¥ ...

    # æ£€æŸ¥æ˜¯å¦è¶…æ—¶
    if time.time() - interrupt_time > timeout_seconds:
        # è¶…æ—¶ï¼Œè‡ªåŠ¨æ‹’ç»
        decisions = [{"type": "reject"} for _ in action_requests]
    else:
        # ä½¿ç”¨ç”¨æˆ·å†³ç­–
        decisions = user_decisions

    result = agent.invoke(
        Command(resume={"decisions": decisions}),
        config=config
    )</code></pre>
                    </div>
                </section>

                <!-- å‚è€ƒèµ„æº -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ“– å‚è€ƒèµ„æº</h2>
                    <ul>
                        <li>
                            <a href="https://docs.langchain.com/oss/python/deepagents/human-in-the-loop" target="_blank">
                                DeepAgents Human-in-the-Loop å®˜æ–¹æ–‡æ¡£
                            </a>
                        </li>
                        <li>
                            <a href="11-checkpointer.html">
                                æŒä¹…åŒ–ç³»ç»Ÿ - Checkpointer è¯¦è§£
                            </a>
                        </li>
                        <li>
                            <a href="13-human-in-loop.html">
                                äººå·¥ä»‹å…¥ - LangGraph HITL åŸºç¡€
                            </a>
                        </li>
                        <li>
                            <a href="24-deepagents-harness.html">
                                Harness ç³»ç»Ÿ - interrupt_on é…ç½®
                            </a>
                        </li>
                        <li>
                            <a href="22-deepagents-quickstart.html">
                                DeepAgents å¿«é€Ÿå¼€å§‹
                            </a>
                        </li>
                    </ul>
                </section>

                <!-- é¡µé¢å¯¼èˆª -->
                <nav class="page-navigation">
                    <a href="26-deepagents-subagents.html" class="nav-button prev">
                        â† ä¸Šä¸€é¡µï¼šå­ä»£ç†
                    </a>
                    <a href="28-deepagents-memory.html" class="nav-button next">
                        ä¸‹ä¸€é¡µï¼šé•¿æœŸè®°å¿† â†’
                    </a>
                </nav>
            </div>
        </main>
    </div>

    <!-- è¿”å›é¡¶éƒ¨æŒ‰é’® -->
    <button class="back-to-top" aria-label="è¿”å›é¡¶éƒ¨">â†‘</button>

    <!-- JavaScript -->
    <script src="assets/js/mermaid-init.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
</body>
</html>
