<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="LangChain 1.0 æ ¸å¿ƒæ¶æ„ - æ·±å…¥ç†è§£ LangChain çš„è®¾è®¡å“²å­¦å’Œæ¨¡å—ç»„ç»‡">
    <title>æ ¸å¿ƒæ¶æ„ | LangChain 1.0 Python çŸ¥è¯†æ–‡æ¡£</title>
    <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
    <button class="mobile-menu-button" aria-label="æ‰“å¼€èœå•">â˜°</button>

    <div class="container">
        <!-- ä¾§è¾¹æ å¯¼èˆª -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <h1 class="sidebar-title">ğŸ¦œ LangChain 1.0</h1>
                <p class="sidebar-subtitle">Python å®Œæ•´å­¦ä¹ æŒ‡å—</p>
            </div>

            <ul class="nav-menu">
                <li class="nav-section">
                    <div class="nav-section-title">å¼€å§‹</div>
                    <ul>
                        <li class="nav-item">
                            <a href="index.html" class="nav-link">
                                <span class="nav-icon">ğŸ </span>
                                ä¸»é¡µ
                            </a>
                        </li>
                    </ul>
                </li>

                <li class="nav-section">
                    <div class="nav-section-title">åŸºç¡€ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="01-introduction.html" class="nav-link">
                                <span class="nav-icon">ğŸ“–</span>
                                LangChain ç®€ä»‹
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="02-architecture.html" class="nav-link">
                                <span class="nav-icon">ğŸ—ï¸</span>
                                æ ¸å¿ƒæ¶æ„
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="03-models.html" class="nav-link">
                                <span class="nav-icon">ğŸ¤–</span>
                                æ¨¡å‹æ¥å£
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="04-messages.html" class="nav-link">
                                <span class="nav-icon">ğŸ’¬</span>
                                æ¶ˆæ¯ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="05-tools.html" class="nav-link">
                                <span class="nav-icon">ğŸ”§</span>
                                å·¥å…·ç³»ç»Ÿ
                            </a>
                        </li>
                    </ul>
                </li>

                <li class="nav-section">
                    <div class="nav-section-title">è¿›é˜¶ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="06-agents.html" class="nav-link">
                                <span class="nav-icon">ğŸ¯</span>
                                Agent åŸºç¡€
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="07-middleware.html" class="nav-link">
                                <span class="nav-icon">âš™ï¸</span>
                                ä¸­é—´ä»¶ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="08-rag.html" class="nav-link">
                                <span class="nav-icon">ğŸ”</span>
                                RAG è¯¦è§£
                                <span class="nav-badge">é‡ç‚¹</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="09-lcel.html" class="nav-link">
                                <span class="nav-icon">ğŸ”—</span>
                                LCEL è¡¨è¾¾å¼
                            </a>
                        </li>
                    </ul>
                </li>

                                <li class="nav-section">
                    <div class="nav-section-title">é«˜çº§åº”ç”¨</div>
                    <ul>
                        <li class="nav-item">
                            <a href="10-runtime.html" class="nav-link">
                                <span class="nav-icon">ğŸ”Œ</span>
                                Runtime ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="11-checkpointer.html" class="nav-link">
                                <span class="nav-icon">ğŸ’¾</span>
                                æŒä¹…åŒ–ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="12-streaming.html" class="nav-link">
                                <span class="nav-icon">ğŸŒŠ</span>
                                æµå¼è¾“å‡º
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="13-human-in-loop.html" class="nav-link">
                                <span class="nav-icon">ğŸ‘¤</span>
                                äººå·¥ä»‹å…¥
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="14-long-term-memory.html" class="nav-link">
                                <span class="nav-icon">ğŸ—„ï¸</span>
                                é•¿æœŸè®°å¿†
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="15-langgraph.html" class="nav-link">
                                <span class="nav-icon">ğŸ“Š</span>
                                LangGraph
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="16-context-engineering.html" class="nav-link">
                                <span class="nav-icon">ğŸ¯</span>
                                ä¸Šä¸‹æ–‡å·¥ç¨‹
                                <span class="nav-badge">é‡ç‚¹</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="17-mcp.html" class="nav-link">
                                <span class="nav-icon">ğŸ”Œ</span>
                                MCP åè®®
                            </a>
                        </li>
                    </ul>
                </li>


                                <li class="nav-section">
                    <div class="nav-section-title">å®æˆ˜ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="18-customer-service.html" class="nav-link">
                                <span class="nav-icon">ğŸ‘¥</span>
                                å®¢æœæœºå™¨äºº
                                <span class="nav-badge">é‡ç‚¹</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="19-best-practices.html" class="nav-link">
                                <span class="nav-icon">âœ¨</span>
                                æœ€ä½³å®è·µ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="38-chat.html" class="nav-link">
                                <span class="nav-icon">ğŸ’¬</span>
                                åœ¨çº¿å¯¹è¯åŠ©æ‰‹
                                <span class="nav-badge">NEW</span>
                            </a>
                        </li>
                    </ul>
                </li>


                                <li class="nav-section">
                    <div class="nav-section-title">å‚è€ƒç¯‡</div>
                    <ul>
                        <li class="nav-item active">
                            <a href="20-api-reference.html" class="nav-link">
                                <span class="nav-icon">ğŸ“š</span>
                                API é€ŸæŸ¥è¡¨
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="21-troubleshooting.html" class="nav-link">
                                <span class="nav-icon">ğŸ›</span>
                                æ•…éšœæ’é™¤
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="22-migration.html" class="nav-link">
                                <span class="nav-icon">ğŸ”„</span>
                                è¿ç§»æŒ‡å—
                            </a>
                        </li>
                    </ul>
                </li>


                                <li class="nav-section">
                    <div class="nav-section-title">æ‰©å±•ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="23-structured-output.html" class="nav-link">
                                <span class="nav-icon">ğŸ“Š</span>
                                ç»“æ„åŒ–è¾“å‡º
                            </a>
                        </li>
                    </ul>
                </li>


                                <li class="nav-section">
                    <div class="nav-section-title">DeepAgents ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="24-deepagents-quickstart.html" class="nav-link">
                                <span class="nav-icon">ğŸš€</span>
                                å¿«é€Ÿå¼€å§‹
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="25-deepagents-customization.html" class="nav-link">
                                <span class="nav-icon">ğŸ¨</span>
                                å®šåˆ¶åŒ–
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="26-deepagents-harness.html" class="nav-link">
                                <span class="nav-icon">ğŸ›ï¸</span>
                                Harness ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="27-deepagents-backends.html" class="nav-link">
                                <span class="nav-icon">ğŸ”§</span>
                                åç«¯é…ç½®
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="28-deepagents-subagents.html" class="nav-link">
                                <span class="nav-icon">ğŸ‘¥</span>
                                å­ä»£ç†
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="29-deepagents-hitl.html" class="nav-link">
                                <span class="nav-icon">ğŸ¤</span>
                                äººå·¥ä»‹å…¥
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="30-deepagents-memory.html" class="nav-link">
                                <span class="nav-icon">ğŸ§ </span>
                                é•¿æœŸè®°å¿†
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="31-deepagents-middleware.html" class="nav-link">
                                <span class="nav-icon">âš™ï¸</span>
                                ä¸­é—´ä»¶
                            </a>
                        </li>
                    </ul>
                </li>


                                <li class="nav-section">
                    <div class="nav-section-title">Multi-Agent ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="32-multi-agent-index.html" class="nav-link">
                                <span class="nav-icon">ğŸŒ</span>
                                æ¦‚è¿°
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="33-multi-agent-subagents.html" class="nav-link">
                                <span class="nav-icon">ğŸ‘¥</span>
                                å­ä»£ç†
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="34-multi-agent-handoffs.html" class="nav-link">
                                <span class="nav-icon">ğŸ”„</span>
                                äº¤æ¥æœºåˆ¶
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="35-multi-agent-skills.html" class="nav-link">
                                <span class="nav-icon">ğŸ¯</span>
                                æŠ€èƒ½ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="36-multi-agent-router.html" class="nav-link">
                                <span class="nav-icon">ğŸ§­</span>
                                è·¯ç”±æœºåˆ¶
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="37-multi-agent-workflow.html" class="nav-link">
                                <span class="nav-icon">ğŸ”€</span>
                                è‡ªå®šä¹‰å·¥ä½œæµ
                            </a>
                        </li>
                    </ul>
                </li>
            </ul>
        </nav>

        <!-- ä¸»å†…å®¹åŒºåŸŸ -->
        <!-- ä¸»å†…å®¹åŒºåŸŸ -->
        <main class="main-content">
            <div class="content-wrapper">
                <!-- é¢åŒ…å±‘å¯¼èˆª -->
                <nav class="breadcrumb">
                    <span class="breadcrumb-item">
                        <a href="index.html" class="breadcrumb-link">ä¸»é¡µ</a>
                    </span>
                    <span class="breadcrumb-item">
                        å‚è€ƒç¯‡
                    </span>
                    <span class="breadcrumb-item">
                        API é€ŸæŸ¥è¡¨
                    </span>
                </nav>

                <!-- é¡µé¢æ ‡é¢˜ -->
                <header class="page-header">
                    <h1 class="page-title">ğŸ“š LangChain 1.0 API é€ŸæŸ¥è¡¨</h1>
                    <p class="page-subtitle">
                        å¿«é€ŸæŸ¥è¯¢å¸¸ç”¨ API ç­¾åã€å¯¼å…¥è¯­å¥å’Œä»£ç ç‰‡æ®µï¼Œæå‡å¼€å‘æ•ˆç‡ã€‚
                    </p>
                </header>

                <!-- å¿«é€Ÿç´¢å¼• -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ” å¿«é€Ÿç´¢å¼•</h2>
                    <div class="info-box note">
                        <div class="info-box-title">ğŸ’¡ ä½¿ç”¨æ–¹æ³•</div>
                        <p>
                            ç‚¹å‡»ä¸‹æ–¹ç±»åˆ«å¿«é€Ÿè·³è½¬åˆ°å¯¹åº”çš„ API å‚è€ƒéƒ¨åˆ†ï¼š
                        </p>
                        <ul style="margin-top: 0.5rem;">
                            <li><a href="#models">æ¨¡å‹æ¥å£</a> - init_chat_model(), init_embeddings()</li>
                            <li><a href="#messages">æ¶ˆæ¯ç³»ç»Ÿ</a> - æ¶ˆæ¯ç±»å‹ã€content_blocks</li>
                            <li><a href="#tools">å·¥å…·ç³»ç»Ÿ</a> - @tool è£…é¥°å™¨ã€è‡ªå®šä¹‰å·¥å…·</li>
                            <li><a href="#agents">Agent åˆ›å»º</a> - create_agent()ã€é…ç½®å‚æ•°</li>
                            <li><a href="#middleware">ä¸­é—´ä»¶ç³»ç»Ÿ</a> - è‡ªå®šä¹‰ä¸­é—´ä»¶ã€é¢„ç½®ä¸­é—´ä»¶</li>
                            <li><a href="#runtime">Runtime ç³»ç»Ÿ</a> - ToolRuntimeã€ä¸Šä¸‹æ–‡æ³¨å…¥</li>
                            <li><a href="#checkpointer">æŒä¹…åŒ–ç³»ç»Ÿ</a> - Checkpointerã€é…ç½®</li>
                            <li><a href="#store">é•¿æœŸè®°å¿†</a> - Storeã€å‘½åç©ºé—´</li>
                            <li><a href="#streaming">æµå¼è¾“å‡º</a> - stream()ã€stream_mode</li>
                            <li><a href="#langgraph">LangGraph</a> - StateGraphã€èŠ‚ç‚¹å’Œè¾¹</li>
                            <li><a href="#rag">RAG ç³»ç»Ÿ</a> - æ–‡æ¡£åŠ è½½ã€åˆ†å‰²ã€æ£€ç´¢</li>
                            <li><a href="#imports">æ ¸å¿ƒå¯¼å…¥</a> - å¸¸ç”¨å¯¼å…¥è¯­å¥æ¸…å•</li>
                        </ul>
                    </div>
                </section>

                <!-- æ ¸å¿ƒå¯¼å…¥ -->
                <section class="content-section" id="imports">
                    <h2 class="section-title">ğŸ“¦ æ ¸å¿ƒå¯¼å…¥è¯­å¥</h2>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python"># æ¨¡å‹æ¥å£
from langchain import init_chat_model, init_embeddings
from langchain_openai import ChatOpenAI, OpenAIEmbeddings
from langchain_anthropic import ChatAnthropic
from langchain_google_genai import ChatGoogleGenerativeAI

# æ¶ˆæ¯ç³»ç»Ÿ
from langchain_core.messages import (
    SystemMessage,
    HumanMessage,
    AIMessage,
    ToolMessage
)

# å·¥å…·ç³»ç»Ÿ
from langchain.tools import tool, ToolRuntime

# Agent åˆ›å»º
from langchain.agents import create_agent

# ä¸­é—´ä»¶
from langchain.agents.middleware import (
    CustomMiddleware,
    PIIMiddleware,
    SummarizationMiddleware,
    HumanInTheLoopMiddleware
)

# Runtime å’Œä¸Šä¸‹æ–‡
from typing_extensions import TypedDict

# Checkpointer
from langgraph.checkpoint.memory import InMemorySaver
from langgraph.checkpoint.postgres import PostgresSaver

# Store
from langgraph.store.memory import InMemoryStore
from langgraph.store.postgres import PostgresStore

# æµå¼è¾“å‡º
# ä½¿ç”¨ agent.stream() æ–¹æ³•

# LangGraph
from langgraph.graph import StateGraph, MessagesState, START, END
from langgraph.types import Command

# RAG ç³»ç»Ÿ
from langchain_chroma import Chroma
from langchain_community.document_loaders import (
    PyPDFLoader,
    TextLoader,
    WebBaseLoader
)
from langchain_text_splitters import RecursiveCharacterTextSplitter</code></pre>
                    </div>
                </section>

                <!-- æ¨¡å‹æ¥å£ -->
                <section class="content-section" id="models">
                    <h2 class="section-title">ğŸ¤– æ¨¡å‹æ¥å£</h2>

                    <h3 class="subsection-title">init_chat_model()</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>å‚æ•°</th>
                                <th>ç±»å‹</th>
                                <th>è¯´æ˜</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>model</code></td>
                                <td>str</td>
                                <td>æ¨¡å‹åç§°ï¼Œå¦‚ "gpt-4o"ã€"claude-3-5-sonnet"</td>
                            </tr>
                            <tr>
                                <td><code>model_provider</code></td>
                                <td>str</td>
                                <td>æä¾›å•†ï¼Œå¦‚ "openai"ã€"anthropic"ã€"google"</td>
                            </tr>
                            <tr>
                                <td><code>temperature</code></td>
                                <td>float</td>
                                <td>æ¸©åº¦å‚æ•°ï¼Œ0.0-2.0ï¼Œé»˜è®¤ 0.7</td>
                            </tr>
                            <tr>
                                <td><code>streaming</code></td>
                                <td>bool</td>
                                <td>æ˜¯å¦å¯ç”¨æµå¼è¾“å‡ºï¼Œé»˜è®¤ False</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python"># åŸºç¡€ç”¨æ³•
from langchain import init_chat_model

model = init_chat_model("gpt-4o", model_provider="openai", temperature=0.7)

# å¸¦é…ç½®çš„ç”¨æ³•
model = init_chat_model(
    "claude-3-5-sonnet-20241022",
    model_provider="anthropic",
    temperature=0.5,
    max_tokens=4096
)</code></pre>
                    </div>

                    <h3 class="subsection-title">init_embeddings()</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>å‚æ•°</th>
                                <th>ç±»å‹</th>
                                <th>è¯´æ˜</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>model</code></td>
                                <td>str</td>
                                <td>åµŒå…¥æ¨¡å‹åç§°ï¼Œå¦‚ "text-embedding-3-small"</td>
                            </tr>
                            <tr>
                                <td><code>model_provider</code></td>
                                <td>str</td>
                                <td>æä¾›å•†ï¼Œå¦‚ "openai"</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">from langchain import init_embeddings

# åŸºç¡€ç”¨æ³•
embeddings = init_embeddings("text-embedding-3-small", model_provider="openai")

# ç”ŸæˆåµŒå…¥
vector = embeddings.embed_query("ç¤ºä¾‹æ–‡æœ¬")
vectors = embeddings.embed_documents(["æ–‡æœ¬1", "æ–‡æœ¬2"])</code></pre>
                    </div>
                </section>

                <!-- æ¶ˆæ¯ç³»ç»Ÿ -->
                <section class="content-section" id="messages">
                    <h2 class="section-title">ğŸ’¬ æ¶ˆæ¯ç³»ç»Ÿ</h2>

                    <h3 class="subsection-title">æ¶ˆæ¯ç±»å‹</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>ç±»å‹</th>
                                <th>ç”¨é€”</th>
                                <th>ç¤ºä¾‹</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>SystemMessage</code></td>
                                <td>ç³»ç»Ÿæç¤ºè¯</td>
                                <td>SystemMessage(content="ä½ æ˜¯AIåŠ©æ‰‹")</td>
                            </tr>
                            <tr>
                                <td><code>HumanMessage</code></td>
                                <td>ç”¨æˆ·æ¶ˆæ¯</td>
                                <td>HumanMessage(content="ä½ å¥½")</td>
                            </tr>
                            <tr>
                                <td><code>AIMessage</code></td>
                                <td>AI å›å¤</td>
                                <td>AIMessage(content="ä½ å¥½ï¼")</td>
                            </tr>
                            <tr>
                                <td><code>ToolMessage</code></td>
                                <td>å·¥å…·è°ƒç”¨ç»“æœ</td>
                                <td>ToolMessage(content="ç»“æœ", tool_call_id="123")</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">from langchain_core.messages import SystemMessage, HumanMessage, AIMessage

# åˆ›å»ºæ¶ˆæ¯
messages = [
    SystemMessage(content="ä½ æ˜¯ä¸“ä¸šçš„AIåŠ©æ‰‹"),
    HumanMessage(content="ä»€ä¹ˆæ˜¯LangChainï¼Ÿ"),
    AIMessage(content="LangChainæ˜¯ä¸€ä¸ªç”¨äºæ„å»ºAIåº”ç”¨çš„æ¡†æ¶")
]

# è®¿é—® content_blocksï¼ˆç»Ÿä¸€è·¨æä¾›å•†ï¼‰
for message in messages:
    for block in message.content_blocks:
        print(block.text)</code></pre>
                    </div>
                </section>

                <!-- å·¥å…·ç³»ç»Ÿ -->
                <section class="content-section" id="tools">
                    <h2 class="section-title">ğŸ”§ å·¥å…·ç³»ç»Ÿ</h2>

                    <h3 class="subsection-title">@tool è£…é¥°å™¨</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">from langchain.tools import tool

# åŸºç¡€å·¥å…·
@tool
def search_database(query: str) -> str:
    """æœç´¢æ•°æ®åº“ã€‚

    Args:
        query: æœç´¢å…³é”®è¯

    Returns:
        æœç´¢ç»“æœ
    """
    return f"æœç´¢ç»“æœï¼š{query}"

# å¸¦è¿è¡Œæ—¶ä¸Šä¸‹æ–‡çš„å·¥å…·
from langchain.tools import ToolRuntime
from typing_extensions import TypedDict

class MyContext(TypedDict):
    user_id: str

@tool
def get_user_data(runtime: ToolRuntime[MyContext]) -> str:
    """è·å–ç”¨æˆ·æ•°æ®"""
    user_id = runtime.context["user_id"]
    return f"ç”¨æˆ· {user_id} çš„æ•°æ®"

# è¿”å›å†…å®¹å’Œå…ƒæ•°æ®
from langchain.tools import content_and_artifact

@tool
def analyze_data(data: str) -> tuple[str, dict]:
    """åˆ†ææ•°æ®"""
    result = "åˆ†æç»“æœ"
    metadata = {"score": 0.95, "confidence": 0.88}
    return content_and_artifact(result, metadata)</code></pre>
                    </div>

                    <h3 class="subsection-title">å·¥å…·è°ƒç”¨</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python"># ç›´æ¥è°ƒç”¨å·¥å…·
result = search_database.invoke({"query": "LangChain"})

# å¸¦è¿è¡Œæ—¶ä¸Šä¸‹æ–‡è°ƒç”¨
result = get_user_data.invoke({
    "runtime": ToolRuntime(context={"user_id": "user_123"})
})</code></pre>
                    </div>
                </section>

                <!-- Agent åˆ›å»º -->
                <section class="content-section" id="agents">
                    <h2 class="section-title">ğŸ¯ Agent åˆ›å»º</h2>

                    <h3 class="subsection-title">create_agent() å‚æ•°</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>å‚æ•°</th>
                                <th>ç±»å‹</th>
                                <th>è¯´æ˜</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>model</code></td>
                                <td>str | ChatModel</td>
                                <td>æ¨¡å‹åç§°æˆ–å®ä¾‹</td>
                            </tr>
                            <tr>
                                <td><code>tools</code></td>
                                <td>list</td>
                                <td>å·¥å…·åˆ—è¡¨</td>
                            </tr>
                            <tr>
                                <td><code>system_prompt</code></td>
                                <td>str</td>
                                <td>ç³»ç»Ÿæç¤ºè¯</td>
                            </tr>
                            <tr>
                                <td><code>middleware</code></td>
                                <td>list</td>
                                <td>ä¸­é—´ä»¶åˆ—è¡¨</td>
                            </tr>
                            <tr>
                                <td><code>checkpointer</code></td>
                                <td>Checkpointer</td>
                                <td>çŠ¶æ€æŒä¹…åŒ–å™¨</td>
                            </tr>
                            <tr>
                                <td><code>store</code></td>
                                <td>Store</td>
                                <td>é•¿æœŸå­˜å‚¨</td>
                            </tr>
                            <tr>
                                <td><code>context_schema</code></td>
                                <td>TypedDict</td>
                                <td>è¿è¡Œæ—¶ä¸Šä¸‹æ–‡ Schema</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">from langchain.agents import create_agent
from langgraph.checkpoint.memory import InMemorySaver
from langgraph.store.memory import InMemoryStore

# åŸºç¡€ Agent
agent = create_agent(
    model="gpt-4o",
    tools=[search_database, get_user_data],
    system_prompt="ä½ æ˜¯ä¸“ä¸šçš„AIåŠ©æ‰‹"
)

# å®Œæ•´é…ç½®çš„ Agent
checkpointer = InMemorySaver()
store = InMemoryStore()

agent = create_agent(
    model="gpt-4o",
    tools=[search_database],
    middleware=[PIIMiddleware()],
    checkpointer=checkpointer,
    store=store,
    context_schema=MyContext,
    system_prompt="ä½ æ˜¯ä¸“ä¸šçš„AIåŠ©æ‰‹"
)

# è°ƒç”¨ Agent
result = agent.invoke({
    "messages": [{"role": "user", "content": "ä½ å¥½"}]
})

# å¸¦é…ç½®è°ƒç”¨
config = {
    "configurable": {"thread_id": "thread_001"},
    "context": {"user_id": "user_123"}
}
result = agent.invoke({"messages": [...]}, config=config)</code></pre>
                    </div>
                </section>

                <!-- ä¸­é—´ä»¶ç³»ç»Ÿ -->
                <section class="content-section" id="middleware">
                    <h2 class="section-title">âš™ï¸ ä¸­é—´ä»¶ç³»ç»Ÿ</h2>

                    <h3 class="subsection-title">è‡ªå®šä¹‰ä¸­é—´ä»¶é’©å­</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>é’©å­</th>
                                <th>è§¦å‘æ—¶æœº</th>
                                <th>å‚æ•°</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>before_agent</code></td>
                                <td>Agent æ‰§è¡Œå‰</td>
                                <td>(state, config)</td>
                            </tr>
                            <tr>
                                <td><code>after_agent</code></td>
                                <td>Agent æ‰§è¡Œå</td>
                                <td>(state, config)</td>
                            </tr>
                            <tr>
                                <td><code>before_model</code></td>
                                <td>æ¨¡å‹è°ƒç”¨å‰</td>
                                <td>(state, config)</td>
                            </tr>
                            <tr>
                                <td><code>after_model</code></td>
                                <td>æ¨¡å‹è°ƒç”¨å</td>
                                <td>(state, config)</td>
                            </tr>
                            <tr>
                                <td><code>wrap_model_call</code></td>
                                <td>åŒ…è£…æ¨¡å‹è°ƒç”¨</td>
                                <td>(call_model, state, config)</td>
                            </tr>
                            <tr>
                                <td><code>wrap_tool_call</code></td>
                                <td>åŒ…è£…å·¥å…·è°ƒç”¨</td>
                                <td>(call_tool, tool_req, config)</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">from langchain.agents.middleware import CustomMiddleware

class LoggingMiddleware(CustomMiddleware):
    """æ—¥å¿—ä¸­é—´ä»¶"""

    def before_agent(self, state, config):
        print("Agent å¼€å§‹æ‰§è¡Œ")
        return state

    def after_agent(self, state, config):
        print("Agent æ‰§è¡Œå®Œæˆ")
        return state

    def wrap_model_call(self, call_model, state, config):
        print("è°ƒç”¨æ¨¡å‹å‰")
        result = call_model(state, config)
        print("è°ƒç”¨æ¨¡å‹å")
        return result</code></pre>
                    </div>

                    <h3 class="subsection-title">é¢„ç½®ä¸­é—´ä»¶</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">from langchain.agents.middleware import (
    PIIMiddleware,
    SummarizationMiddleware,
    HumanInTheLoopMiddleware
)

# PII ä¿æŠ¤ä¸­é—´ä»¶
pii_middleware = PIIMiddleware(
    pii_types=["email", "phone_number", "credit_card"],
    strategy="redact"  # é€‰é¡¹ï¼šredact, mask, hash, block
)

# æ‘˜è¦ä¸­é—´ä»¶
summarization = SummarizationMiddleware(
    max_messages=10,
    summarize_older=True
)

# äººå·¥ä»‹å…¥ä¸­é—´ä»¶
hitl = HumanInTheLoopMiddleware(
    interrupt_on={
        "sensitive_tool": True,
        "normal_tool": False
    }
)</code></pre>
                    </div>
                </section>

                <!-- Runtime ç³»ç»Ÿ -->
                <section class="content-section" id="runtime">
                    <h2 class="section-title">ğŸ”Œ Runtime ç³»ç»Ÿ</h2>

                    <h3 class="subsection-title">å®šä¹‰ä¸Šä¸‹æ–‡ Schema</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">from typing_extensions import TypedDict

class UserContext(TypedDict):
    user_id: str
    session_id: str
    permissions: list[str]</code></pre>
                    </div>

                    <h3 class="subsection-title">ä½¿ç”¨ ToolRuntime</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">from langchain.tools import tool, ToolRuntime

@tool
def get_user_profile(runtime: ToolRuntime[UserContext]) -> str:
    """è·å–ç”¨æˆ·èµ„æ–™"""
    user_id = runtime.context["user_id"]

    # è®¿é—® Store
    profile = runtime.store.get(("users", user_id), "profile")

    return f"ç”¨æˆ· {user_id} çš„èµ„æ–™"</code></pre>
                    </div>

                    <h3 class="subsection-title">ä¼ é€’ä¸Šä¸‹æ–‡</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">config = {
    "configurable": {"thread_id": "thread_001"},
    "context": {
        "user_id": "user_123",
        "session_id": "session_456",
        "permissions": ["read", "write"]
    }
}

result = agent.invoke({"messages": [...]}, config=config)</code></pre>
                    </div>
                </section>

                <!-- Checkpointer -->
                <section class="content-section" id="checkpointer">
                    <h2 class="section-title">ğŸ’¾ æŒä¹…åŒ–ç³»ç»Ÿ</h2>

                    <h3 class="subsection-title">Checkpointer ç±»å‹</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>ç±»å‹</th>
                                <th>ç”¨é€”</th>
                                <th>å¯¼å…¥</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>InMemorySaver</code></td>
                                <td>å†…å­˜æŒä¹…åŒ–ï¼ˆå¼€å‘ï¼‰</td>
                                <td>langgraph.checkpoint.memory</td>
                            </tr>
                            <tr>
                                <td><code>PostgresSaver</code></td>
                                <td>PostgreSQL æŒä¹…åŒ–ï¼ˆç”Ÿäº§ï¼‰</td>
                                <td>langgraph.checkpoint.postgres</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python"># å¼€å‘ç¯å¢ƒï¼šå†…å­˜ Checkpointer
from langgraph.checkpoint.memory import InMemorySaver

checkpointer = InMemorySaver()

# ç”Ÿäº§ç¯å¢ƒï¼šPostgreSQL Checkpointer
from langgraph.checkpoint.postgres import PostgresSaver

DB_URI = "postgresql://user:pass@localhost:5432/langchain"

with PostgresSaver.from_conn_string(DB_URI) as checkpointer:
    checkpointer.setup()

    agent = create_agent(
        model="gpt-4o",
        tools=[...],
        checkpointer=checkpointer
    )</code></pre>
                    </div>

                    <h3 class="subsection-title">è·å–çŠ¶æ€å†å²</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">config = {"configurable": {"thread_id": "thread_001"}}

# è·å–æ‰€æœ‰å†å²çŠ¶æ€
history = agent.get_state_history(config)

for state in history:
    print(f"æ—¶é—´ï¼š{state.metadata['timestamp']}")
    print(f"æ¶ˆæ¯æ•°ï¼š{len(state.values['messages'])}")</code></pre>
                    </div>
                </section>

                <!-- Store -->
                <section class="content-section" id="store">
                    <h2 class="section-title">ğŸ—„ï¸ é•¿æœŸè®°å¿†ï¼ˆStoreï¼‰</h2>

                    <h3 class="subsection-title">Store ç±»å‹</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>ç±»å‹</th>
                                <th>ç”¨é€”</th>
                                <th>å¯¼å…¥</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>InMemoryStore</code></td>
                                <td>å†…å­˜å­˜å‚¨ï¼ˆå¼€å‘ï¼‰</td>
                                <td>langgraph.store.memory</td>
                            </tr>
                            <tr>
                                <td><code>PostgresStore</code></td>
                                <td>PostgreSQL å­˜å‚¨ï¼ˆç”Ÿäº§ï¼‰</td>
                                <td>langgraph.store.postgres</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python"># å¼€å‘ç¯å¢ƒ
from langgraph.store.memory import InMemoryStore

store = InMemoryStore()

# ç”Ÿäº§ç¯å¢ƒ
from langgraph.store.postgres import PostgresStore

DB_URI = "postgresql://user:pass@localhost:5432/langchain"

with PostgresStore.from_conn_string(DB_URI) as store:
    store.setup()

    agent = create_agent(
        model="gpt-4o",
        tools=[...],
        store=store
    )</code></pre>
                    </div>

                    <h3 class="subsection-title">Store æ“ä½œ</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python"># åœ¨å·¥å…·ä¸­ä½¿ç”¨ Store
@tool
def save_preference(
    key: str,
    value: str,
    runtime: ToolRuntime[UserContext]
) -> str:
    user_id = runtime.context["user_id"]
    store_obj = runtime.store

    # ä¿å­˜æ•°æ®
    store_obj.put(("users", user_id), key, value)

    return f"å·²ä¿å­˜ {key} = {value}"

@tool
def get_preference(
    key: str,
    runtime: ToolRuntime[UserContext]
) -> str:
    user_id = runtime.context["user_id"]
    store_obj = runtime.store

    # è·å–æ•°æ®
    item = store_obj.get(("users", user_id), key)

    if item:
        return f"{key} = {item.value}"
    else:
        return f"æœªè®¾ç½® {key}"</code></pre>
                    </div>
                </section>

                <!-- æµå¼è¾“å‡º -->
                <section class="content-section" id="streaming">
                    <h2 class="section-title">ğŸŒŠ æµå¼è¾“å‡º</h2>

                    <h3 class="subsection-title">stream_mode é€‰é¡¹</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>æ¨¡å¼</th>
                                <th>è¯´æ˜</th>
                                <th>è¿”å›æ ¼å¼</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>"messages"</code></td>
                                <td>æµå¼è¿”å›æ¶ˆæ¯ token</td>
                                <td>(token, metadata)</td>
                            </tr>
                            <tr>
                                <td><code>"updates"</code></td>
                                <td>èŠ‚ç‚¹æ‰§è¡Œæ›´æ–°</td>
                                <td>{node_name: data}</td>
                            </tr>
                            <tr>
                                <td><code>"values"</code></td>
                                <td>å®Œæ•´çŠ¶æ€å€¼</td>
                                <td>{"messages": [...], ...}</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python"># åŸºç¡€æµå¼è¾“å‡ºï¼ˆåªè¾“å‡ºæ¶ˆæ¯ï¼‰
for chunk in agent.stream({"messages": [...]}, stream_mode="messages"):
    token, metadata = chunk
    if token:
        print(token, end="", flush=True)

# å¤šæ¨¡å¼æµå¼è¾“å‡º
for stream_mode, chunk in agent.stream(
    {"messages": [...]},
    stream_mode=["messages", "updates"]
):
    if stream_mode == "messages":
        token, metadata = chunk
        if token:
            print(token, end="", flush=True)

    elif stream_mode == "updates":
        for node, data in chunk.items():
            print(f"\nèŠ‚ç‚¹ {node} æ‰§è¡Œå®Œæˆ")</code></pre>
                    </div>
                </section>

                <!-- LangGraph -->
                <section class="content-section" id="langgraph">
                    <h2 class="section-title">ğŸ“Š LangGraph</h2>

                    <h3 class="subsection-title">åˆ›å»º StateGraph</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">from langgraph.graph import StateGraph, MessagesState, START, END

# ä½¿ç”¨é¢„æ„å»ºçŠ¶æ€
graph = StateGraph(MessagesState)

# è‡ªå®šä¹‰çŠ¶æ€
from typing_extensions import TypedDict
from typing import Annotated
from operator import add

class CustomState(TypedDict):
    messages: Annotated[list, add]
    current_step: str
    count: int

graph = StateGraph(CustomState)</code></pre>
                    </div>

                    <h3 class="subsection-title">æ·»åŠ èŠ‚ç‚¹å’Œè¾¹</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python"># å®šä¹‰èŠ‚ç‚¹å‡½æ•°
def process_input(state):
    return {"current_step": "processed"}

def call_llm(state):
    return {"messages": [{"role": "ai", "content": "å“åº”"}]}

# æ·»åŠ èŠ‚ç‚¹
graph.add_node("process", process_input)
graph.add_node("llm", call_llm)

# æ·»åŠ æ™®é€šè¾¹
graph.add_edge(START, "process")
graph.add_edge("process", "llm")
graph.add_edge("llm", END)

# æ·»åŠ æ¡ä»¶è¾¹
def should_continue(state):
    if state.get("count", 0) < 5:
        return "continue"
    else:
        return "end"

graph.add_conditional_edges(
    "llm",
    should_continue,
    {"continue": "process", "end": END}
)

# ç¼–è¯‘å›¾
compiled = graph.compile()</code></pre>
                    </div>

                    <h3 class="subsection-title">Command æ§åˆ¶æµ</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">from langgraph.types import Command
from typing import Literal

def process_node(state) -> Command[Literal["success", "retry", "fail"]]:
    """èŠ‚ç‚¹è¿”å›çŠ¶æ€æ›´æ–°å’Œè·¯ç”±æŒ‡ä»¤"""

    if success:
        return Command(
            update={"result": "æˆåŠŸ"},
            goto="success"
        )
    elif can_retry:
        return Command(
            update={"retry_count": state["retry_count"] + 1},
            goto="retry"
        )
    else:
        return Command(
            update={"error": "å¤±è´¥"},
            goto="fail"
        )</code></pre>
                    </div>
                </section>

                <!-- RAG ç³»ç»Ÿ -->
                <section class="content-section" id="rag">
                    <h2 class="section-title">ğŸ” RAG ç³»ç»Ÿ</h2>

                    <h3 class="subsection-title">æ–‡æ¡£åŠ è½½</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">from langchain_community.document_loaders import (
    PyPDFLoader,
    TextLoader,
    WebBaseLoader
)

# PDF æ–‡æ¡£
pdf_loader = PyPDFLoader("document.pdf")
pdf_docs = pdf_loader.load()

# æ–‡æœ¬æ–‡ä»¶
text_loader = TextLoader("document.txt")
text_docs = text_loader.load()

# ç½‘é¡µ
web_loader = WebBaseLoader("https://example.com")
web_docs = web_loader.load()</code></pre>
                    </div>

                    <h3 class="subsection-title">æ–‡æ¡£åˆ†å‰²</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">from langchain_text_splitters import RecursiveCharacterTextSplitter

splitter = RecursiveCharacterTextSplitter(
    chunk_size=1000,
    chunk_overlap=200,
    separators=["\n\n", "\n", " ", ""]
)

chunks = splitter.split_documents(documents)</code></pre>
                    </div>

                    <h3 class="subsection-title">å‘é‡å­˜å‚¨å’Œæ£€ç´¢</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">from langchain_chroma import Chroma
from langchain_openai import OpenAIEmbeddings

# åˆ›å»º Embeddings
embeddings = OpenAIEmbeddings(model="text-embedding-3-small")

# åˆ›å»ºå‘é‡å­˜å‚¨
vectorstore = Chroma.from_documents(
    documents=chunks,
    embedding=embeddings,
    collection_name="my_collection"
)

# åˆ›å»ºæ£€ç´¢å™¨
retriever = vectorstore.as_retriever(
    search_type="similarity",
    search_kwargs={"k": 3}
)

# æ£€ç´¢
results = retriever.invoke("æŸ¥è¯¢æ–‡æœ¬")</code></pre>
                    </div>

                    <h3 class="subsection-title">RAG æ£€ç´¢å·¥å…·</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">from langchain.tools import tool

@tool
def search_knowledge_base(query: str) -> str:
    """æœç´¢çŸ¥è¯†åº“"""
    docs = retriever.invoke(query)

    if not docs:
        return "æœªæ‰¾åˆ°ç›¸å…³ä¿¡æ¯"

    context = "\n\n".join([doc.page_content for doc in docs])
    return f"ç›¸å…³ä¿¡æ¯ï¼š\n{context}"</code></pre>
                    </div>
                </section>

                <!-- å¸¸ç”¨ä»£ç ç‰‡æ®µ -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ’¡ å¸¸ç”¨ä»£ç ç‰‡æ®µ</h2>

                    <h3 class="subsection-title">å®Œæ•´çš„ Agent é…ç½®</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">from langchain.agents import create_agent
from langchain.agents.middleware import PIIMiddleware
from langgraph.checkpoint.memory import InMemorySaver
from langgraph.store.memory import InMemoryStore
from typing_extensions import TypedDict

# å®šä¹‰ä¸Šä¸‹æ–‡
class AppContext(TypedDict):
    user_id: str
    session_id: str

# å®šä¹‰å·¥å…·
@tool
def my_tool(param: str, runtime: ToolRuntime[AppContext]) -> str:
    """å·¥å…·æè¿°"""
    user_id = runtime.context["user_id"]
    return f"ç»“æœï¼š{param}"

# åˆå§‹åŒ–ç»„ä»¶
checkpointer = InMemorySaver()
store = InMemoryStore()
pii_middleware = PIIMiddleware(pii_types=["email"], strategy="redact")

# åˆ›å»º Agent
agent = create_agent(
    model="gpt-4o",
    tools=[my_tool],
    middleware=[pii_middleware],
    checkpointer=checkpointer,
    store=store,
    context_schema=AppContext,
    system_prompt="ä½ æ˜¯ä¸“ä¸šçš„AIåŠ©æ‰‹"
)

# è°ƒç”¨ Agent
config = {
    "configurable": {"thread_id": "thread_001"},
    "context": {"user_id": "user_123", "session_id": "session_456"}
}

result = agent.invoke(
    {"messages": [{"role": "user", "content": "ä½ å¥½"}]},
    config=config
)</code></pre>
                    </div>

                    <h3 class="subsection-title">æµå¼å¯¹è¯å¤„ç†</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">def chat_stream(user_message: str, thread_id: str, user_id: str):
    """æµå¼å¯¹è¯å¤„ç†å‡½æ•°"""

    config = {
        "configurable": {"thread_id": thread_id},
        "context": {"user_id": user_id, "session_id": thread_id}
    }

    print(f"ç”¨æˆ·: {user_message}")
    print("AI: ", end="", flush=True)

    full_response = ""

    for stream_mode, chunk in agent.stream(
        {"messages": [{"role": "user", "content": user_message}]},
        config=config,
        stream_mode=["messages", "updates"]
    ):
        if stream_mode == "messages":
            token, metadata = chunk
            if token:
                print(token, end="", flush=True)
                full_response += token

        elif stream_mode == "updates":
            for node, data in chunk.items():
                if "__interrupt__" in data:
                    print("\n[éœ€è¦äººå·¥å®¡æ ¸]")

    print("\n")
    return full_response</code></pre>
                    </div>
                </section>

                <!-- å‚è€ƒèµ„æº -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ“– å‚è€ƒèµ„æº</h2>
                    <ul>
                        <li>
                            <a href="https://reference.langchain.com/python/langchain/" target="_blank">
                                LangChain Python API å®Œæ•´å‚è€ƒ
                            </a>
                        </li>
                        <li>
                            <a href="https://docs.langchain.com/oss/python/langchain/overview" target="_blank">
                                LangChain å®˜æ–¹æ–‡æ¡£
                            </a>
                        </li>
                        <li>
                            <a href="https://langchain-ai.github.io/langgraph/" target="_blank">
                                LangGraph å®˜æ–¹ç½‘ç«™
                            </a>
                        </li>
                        <li>
                            <a href="https://docs.smith.langchain.com/" target="_blank">
                                LangSmith è°ƒè¯•å·¥å…·
                            </a>
                        </li>
                    </ul>
                </section>

                <!-- é¡µé¢å¯¼èˆª -->
                                <nav class="page-navigation">
                    <a href="38-chat.html" class="nav-button prev">
                        â† ä¸Šä¸€é¡µï¼šåœ¨çº¿å¯¹è¯åŠ©æ‰‹
                    </a>
                    <a href="21-troubleshooting.html" class="nav-button next">
                        ä¸‹ä¸€é¡µ:æ•…éšœæ’é™¤ â†’
                    </a>
                </nav>
            </div>
        </main>
    </div>

    <!-- è¿”å›é¡¶éƒ¨æŒ‰é’® -->
    <button class="back-to-top" aria-label="è¿”å›é¡¶éƒ¨">â†‘</button>

    <!-- JavaScript -->
    <script src="assets/js/mermaid-init.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
</body>
</html>
