<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Multi-Agent å­ä»£ç† - æ„å»ºç‹¬ç«‹åä½œçš„ä»£ç†ç½‘ç»œ">
    <title>Multi-Agent å­ä»£ç† | LangChain 1.0 Python çŸ¥è¯†æ–‡æ¡£</title>
    <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
    <button class="mobile-menu-button" aria-label="æ‰“å¼€èœå•">â˜°</button>

    <div class="container">
        <!-- ä¾§è¾¹æ å¯¼èˆª -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <h1 class="sidebar-title">ğŸ¦œ LangChain 1.0</h1>
                <p class="sidebar-subtitle">Python å®Œæ•´å­¦ä¹ æŒ‡å—</p>
            </div>

            <ul class="nav-menu">
                <li class="nav-section">
                    <div class="nav-section-title">å¼€å§‹</div>
                    <ul>
                        <li class="nav-item">
                            <a href="index.html" class="nav-link">
                                <span class="nav-icon">ğŸ </span>
                                ä¸»é¡µ
                            </a>
                        </li>
                    </ul>
                </li>

                <li class="nav-section">
                    <div class="nav-section-title">åŸºç¡€ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="01-introduction.html" class="nav-link">
                                <span class="nav-icon">ğŸ“–</span>
                                LangChain ç®€ä»‹
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="02-architecture.html" class="nav-link">
                                <span class="nav-icon">ğŸ—ï¸</span>
                                æ ¸å¿ƒæ¶æ„
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="03-models.html" class="nav-link">
                                <span class="nav-icon">ğŸ¤–</span>
                                æ¨¡å‹æ¥å£
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="04-messages.html" class="nav-link">
                                <span class="nav-icon">ğŸ’¬</span>
                                æ¶ˆæ¯ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="05-tools.html" class="nav-link">
                                <span class="nav-icon">ğŸ”§</span>
                                å·¥å…·ç³»ç»Ÿ
                            </a>
                        </li>
                    </ul>
                </li>

                <li class="nav-section">
                    <div class="nav-section-title">è¿›é˜¶ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="06-agents.html" class="nav-link">
                                <span class="nav-icon">ğŸ¯</span>
                                Agent åŸºç¡€
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="07-middleware.html" class="nav-link">
                                <span class="nav-icon">âš™ï¸</span>
                                ä¸­é—´ä»¶ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="08-rag.html" class="nav-link">
                                <span class="nav-icon">ğŸ”</span>
                                RAG è¯¦è§£
                                <span class="nav-badge">é‡ç‚¹</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="09-lcel.html" class="nav-link">
                                <span class="nav-icon">ğŸ”—</span>
                                LCEL è¡¨è¾¾å¼
                            </a>
                        </li>
                    </ul>
                </li>

                <li class="nav-section">
                    <div class="nav-section-title">é«˜çº§åº”ç”¨</div>
                    <ul>
                        <li class="nav-item">
                            <a href="10-runtime.html" class="nav-link">
                                <span class="nav-icon">ğŸ”Œ</span>
                                Runtime ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="11-checkpointer.html" class="nav-link">
                                <span class="nav-icon">ğŸ’¾</span>
                                æŒä¹…åŒ–ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="12-streaming.html" class="nav-link">
                                <span class="nav-icon">ğŸŒŠ</span>
                                æµå¼è¾“å‡º
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="13-human-in-loop.html" class="nav-link">
                                <span class="nav-icon">ğŸ‘¤</span>
                                äººå·¥ä»‹å…¥
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="14-long-term-memory.html" class="nav-link">
                                <span class="nav-icon">ğŸ—„ï¸</span>
                                é•¿æœŸè®°å¿†
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="15-langgraph.html" class="nav-link">
                                <span class="nav-icon">ğŸ“Š</span>
                                LangGraph
                            </a>
                        </li>
                    </ul>
                </li>

                <li class="nav-section">
                    <div class="nav-section-title">å®æˆ˜ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="16-customer-service.html" class="nav-link">
                                <span class="nav-icon">ğŸ‘¥</span>
                                å®¢æœæœºå™¨äºº
                                <span class="nav-badge">é‡ç‚¹</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="17-best-practices.html" class="nav-link">
                                <span class="nav-icon">âœ¨</span>
                                æœ€ä½³å®è·µ
                            </a>
                        </li>
                    </ul>
                </li>

                <li class="nav-section">
                    <div class="nav-section-title">å‚è€ƒç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="18-api-reference.html" class="nav-link">
                                <span class="nav-icon">ğŸ“š</span>
                                API é€ŸæŸ¥è¡¨
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="19-troubleshooting.html" class="nav-link">
                                <span class="nav-icon">ğŸ›</span>
                                æ•…éšœæ’é™¤
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="20-migration.html" class="nav-link">
                                <span class="nav-icon">ğŸ”„</span>
                                è¿ç§»æŒ‡å—
                            </a>
                        </li>
                    </ul>
                </li>

                <li class="nav-section">
                    <div class="nav-section-title">æ‰©å±•ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="21-structured-output.html" class="nav-link">
                                <span class="nav-icon">ğŸ“Š</span>
                                ç»“æ„åŒ–è¾“å‡º
                            </a>
                        </li>
                    </ul>
                </li>

                <li class="nav-section">
                    <div class="nav-section-title">DeepAgents ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="22-deepagents-quickstart.html" class="nav-link">
                                <span class="nav-icon">ğŸš€</span>
                                å¿«é€Ÿå¼€å§‹
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="23-deepagents-customization.html" class="nav-link">
                                <span class="nav-icon">ğŸ¨</span>
                                å®šåˆ¶åŒ–
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="24-deepagents-harness.html" class="nav-link">
                                <span class="nav-icon">ğŸ›ï¸</span>
                                Harness ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="25-deepagents-backends.html" class="nav-link">
                                <span class="nav-icon">ğŸ”§</span>
                                åç«¯é…ç½®
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="26-deepagents-subagents.html" class="nav-link">
                                <span class="nav-icon">ğŸ‘¥</span>
                                å­ä»£ç†
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="27-deepagents-hitl.html" class="nav-link">
                                <span class="nav-icon">ğŸ¤</span>
                                äººå·¥ä»‹å…¥
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="28-deepagents-memory.html" class="nav-link">
                                <span class="nav-icon">ğŸ§ </span>
                                é•¿æœŸè®°å¿†
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="29-deepagents-middleware.html" class="nav-link">
                                <span class="nav-icon">âš™ï¸</span>
                                ä¸­é—´ä»¶
                            </a>
                        </li>
                    </ul>
                </li>

                <li class="nav-section">
                    <div class="nav-section-title">Multi-Agent ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="30-multi-agent-index.html" class="nav-link">
                                <span class="nav-icon">ğŸŒ</span>
                                æ¦‚è¿°
                            </a>
                        </li>
                        <li class="nav-item active">
                            <a href="31-multi-agent-subagents.html" class="nav-link">
                                <span class="nav-icon">ğŸ‘¥</span>
                                å­ä»£ç†
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="32-multi-agent-handoffs.html" class="nav-link">
                                <span class="nav-icon">ğŸ”„</span>
                                äº¤æ¥æœºåˆ¶
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="33-multi-agent-skills.html" class="nav-link">
                                <span class="nav-icon">ğŸ¯</span>
                                æŠ€èƒ½ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="34-multi-agent-router.html" class="nav-link">
                                <span class="nav-icon">ğŸ§­</span>
                                è·¯ç”±æœºåˆ¶
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="35-multi-agent-workflow.html" class="nav-link">
                                <span class="nav-icon">ğŸ”€</span>
                                è‡ªå®šä¹‰å·¥ä½œæµ
                            </a>
                        </li>
                    </ul>
                </li>
            </ul>
        </nav>

        <!-- ä¸»å†…å®¹åŒºåŸŸ -->
        <main class="main-content">
            <div class="content-wrapper">
                <!-- é¢åŒ…å±‘å¯¼èˆª -->
                <nav class="breadcrumb">
                    <span class="breadcrumb-item">
                        <a href="index.html" class="breadcrumb-link">ä¸»é¡µ</a>
                    </span>
                    <span class="breadcrumb-item">
                        Multi-Agent ç¯‡
                    </span>
                    <span class="breadcrumb-item">
                        å­ä»£ç†
                    </span>
                </nav>

                <!-- é¡µé¢æ ‡é¢˜ -->
                <header class="page-header">
                    <h1 class="page-title">ğŸ‘¥ Multi-Agent å­ä»£ç†</h1>
                    <p class="page-subtitle">
                        æ„å»ºå¤šä¸ªç‹¬ç«‹çš„æ™ºèƒ½ä»£ç†ï¼Œé€šè¿‡ä¸“ä¸šåŒ–åˆ†å·¥å’Œåä½œæœºåˆ¶å…±åŒå®Œæˆå¤æ‚ä»»åŠ¡ï¼Œ
                        å®ç°å¯æ‰©å±•çš„ Agent ç½‘ç»œæ¶æ„ã€‚
                    </p>
                </header>

                <!-- ä»€ä¹ˆæ˜¯ Multi-Agent Subagents -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ“š ä»€ä¹ˆæ˜¯ Multi-Agent Subagentsï¼Ÿ</h2>
                    <p>
                        <strong>Multi-Agent Subagentsï¼ˆå¤šä»£ç†å­ä»£ç†ï¼‰</strong>æ˜¯ä¸€ç§æ¶æ„æ¨¡å¼ï¼Œ
                        é€šè¿‡åˆ›å»º<strong>å¤šä¸ªç‹¬ç«‹çš„ä¸“ä¸šåŒ–ä»£ç†</strong>ï¼Œæ¯ä¸ªä»£ç†ä¸“æ³¨äºç‰¹å®šé¢†åŸŸæˆ–ä»»åŠ¡ï¼Œ
                        é€šè¿‡åä½œæœºåˆ¶å…±åŒå®Œæˆå¤æ‚çš„ä¸šåŠ¡æµç¨‹ã€‚
                    </p>

                    <div class="info-box note">
                        <div class="info-box-title">ğŸ’¡ æ ¸å¿ƒç‰¹å¾</div>
                        <table style="margin-top: 0.5rem;">
                            <thead>
                                <tr>
                                    <th>ç‰¹æ€§</th>
                                    <th>DeepAgents Subagents</th>
                                    <th>Multi-Agent Subagents</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>ä¸»è¦ç›®çš„</strong></td>
                                    <td>ä¸Šä¸‹æ–‡éš”ç¦»ï¼ˆå• Agent å†…ï¼‰</td>
                                    <td>ä¸“ä¸šåŒ–åˆ†å·¥ï¼ˆå¤š Agent åä½œï¼‰</td>
                                </tr>
                                <tr>
                                    <td><strong>ä»£ç†ç‹¬ç«‹æ€§</strong></td>
                                    <td>ä»å±äºä¸» Agent</td>
                                    <td>æ¯ä¸ªä»£ç†å¯å®Œå…¨ç‹¬ç«‹</td>
                                </tr>
                                <tr>
                                    <td><strong>è°ƒç”¨æ–¹å¼</strong></td>
                                    <td>ä¸» Agent é€šè¿‡ task å·¥å…·è°ƒç”¨</td>
                                    <td>LangGraph èŠ‚ç‚¹å’Œè¾¹è°ƒç”¨</td>
                                </tr>
                                <tr>
                                    <td><strong>çŠ¶æ€ç®¡ç†</strong></td>
                                    <td>å…±äº«ä¸» Agent çŠ¶æ€</td>
                                    <td>ç‹¬ç«‹çŠ¶æ€æˆ–å…±äº« Graph çŠ¶æ€</td>
                                </tr>
                                <tr>
                                    <td><strong>å·¥ä½œæµæ§åˆ¶</strong></td>
                                    <td>ä¸» Agent å†³å®š</td>
                                    <td>Graph æµç¨‹ç¼–æ’</td>
                                </tr>
                                <tr>
                                    <td><strong>å…¸å‹åœºæ™¯</strong></td>
                                    <td>ç ”ç©¶åŠ©æ‰‹ã€æ•°æ®å¤„ç†</td>
                                    <td>å®¢æœç³»ç»Ÿã€å·¥ä½œæµå¼•æ“</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="mermaid-wrapper">
                        <div class="mermaid">
graph TB
    subgraph DeepAgents["DeepAgents æ¨¡å¼"]
        Main["ä¸» Agent"] -->|"task å·¥å…·"| Sub1["å­ä»£ç† 1<br/>ä¸Šä¸‹æ–‡éš”ç¦»"]
        Main -->|"task å·¥å…·"| Sub2["å­ä»£ç† 2<br/>ä¸Šä¸‹æ–‡éš”ç¦»"]
        Sub1 -->|"æ‘˜è¦è¿”å›"| Main
        Sub2 -->|"æ‘˜è¦è¿”å›"| Main
    end

    subgraph MultiAgent["Multi-Agent æ¨¡å¼"]
        Start["å¼€å§‹"] --> Agent1["Agent 1<br/>ç ”ç©¶ä¸“å‘˜"]
        Agent1 --> Agent2["Agent 2<br/>åˆ†æä¸“å‘˜"]
        Agent2 --> Agent3["Agent 3<br/>æŠ¥å‘Šä¸“å‘˜"]
        Agent3 --> End["ç»“æŸ"]
    end

    style Main fill:#3b82f6,color:#fff
    style Sub1 fill:#10b981,color:#fff
    style Sub2 fill:#10b981,color:#fff
    style Agent1 fill:#f59e0b,color:#fff
    style Agent2 fill:#8b5cf6,color:#fff
    style Agent3 fill:#ef4444,color:#fff
                        </div>
                    </div>

                    <h3 class="subsection-title">ä½•æ—¶ä½¿ç”¨ Multi-Agent Subagentsï¼Ÿ</h3>
                    <div class="info-box tip">
                        <div class="info-box-title">âœ… é€‚åˆä½¿ç”¨åœºæ™¯</div>
                        <ul>
                            <li><strong>æ˜ç¡®çš„è§’è‰²åˆ†å·¥</strong>ï¼šä¸åŒä»£ç†è´Ÿè´£ä¸åŒé¢†åŸŸï¼ˆå®¢æœã€æŠ€æœ¯ã€é”€å”®ï¼‰</li>
                            <li><strong>é¡ºåºå·¥ä½œæµ</strong>ï¼šä»»åŠ¡éœ€è¦æŒ‰ç‰¹å®šé¡ºåºæ‰§è¡Œï¼ˆç ”ç©¶ â†’ åˆ†æ â†’ æŠ¥å‘Šï¼‰</li>
                            <li><strong>å¹¶è¡Œå¤„ç†</strong>ï¼šå¤šä¸ªä»»åŠ¡å¯ä»¥åŒæ—¶è¿›è¡Œ</li>
                            <li><strong>ç‹¬ç«‹æµ‹è¯•</strong>ï¼šæ¯ä¸ªä»£ç†å¯ä»¥ç‹¬ç«‹å¼€å‘å’Œæµ‹è¯•</li>
                            <li><strong>å¯æ‰©å±•æ€§</strong>ï¼šå®¹æ˜“æ·»åŠ æ–°çš„ä»£ç†èŠ‚ç‚¹</li>
                        </ul>
                    </div>

                    <div class="info-box warning">
                        <div class="info-box-title">âŒ ä¸é€‚åˆä½¿ç”¨åœºæ™¯</div>
                        <ul>
                            <li><strong>ç®€å•å•æ­¥ä»»åŠ¡</strong>ï¼šä¸éœ€è¦å¤šä¸ªä»£ç†çš„å¼€é”€</li>
                            <li><strong>é«˜åº¦è€¦åˆçš„ä»»åŠ¡</strong>ï¼šæ‰€æœ‰æ­¥éª¤å¿…é¡»å…±äº«è¯¦ç»†ä¸Šä¸‹æ–‡</li>
                            <li><strong>å®æ—¶å“åº”è¦æ±‚</strong>ï¼šå¤šä»£ç†è°ƒç”¨ä¼šå¢åŠ å»¶è¿Ÿ</li>
                        </ul>
                    </div>
                </section>

                <!-- åœ¨ LangGraph ä¸­åˆ›å»º Subagents -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ”§ åœ¨ LangGraph ä¸­åˆ›å»º Subagents</h2>
                    <p>
                        Multi-Agent Subagents åŸºäº <strong>LangGraph</strong> çš„çŠ¶æ€å›¾å®ç°ï¼Œ
                        æ¯ä¸ªå­ä»£ç†æ˜¯å›¾ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹ã€‚
                    </p>

                    <h3 class="subsection-title">åŸºç¡€æ¨¡å¼ï¼šé¡ºåºæ‰§è¡Œ</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty basic">ğŸŸ¢ åŸºç¡€</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
é¡ºåºæ‰§è¡Œæ¨¡å¼ - å¤šä¸ªå­ä»£ç†æŒ‰é¡ºåºåä½œ
"""
from typing import TypedDict, Annotated
from langgraph.graph import StateGraph, START, END
from langgraph.graph.message import add_messages
from langchain_openai import ChatOpenAI
from langchain.tools import tool

# å®šä¹‰å…±äº«çŠ¶æ€
class AgentState(TypedDict):
    messages: Annotated[list, add_messages]
    research_data: str
    analysis_result: str
    final_report: str

# å·¥å…·å®šä¹‰
@tool
def search_internet(query: str) -> str:
    """æœç´¢ç½‘ç»œä¿¡æ¯"""
    # å®é™…ä¼šè°ƒç”¨æœç´¢ API
    return f"å…³äº {query} çš„æœç´¢ç»“æœ..."

@tool
def analyze_data(data: str) -> str:
    """åˆ†ææ•°æ®"""
    # å®é™…ä¼šæ‰§è¡Œæ•°æ®åˆ†æ
    return f"æ•°æ®åˆ†æç»“æœï¼š{data[:50]}..."

# å­ä»£ç† 1: ç ”ç©¶ä¸“å‘˜
def research_agent(state: AgentState):
    """ç ”ç©¶ä¸“å‘˜ï¼šæ”¶é›†ä¿¡æ¯"""
    llm = ChatOpenAI(model="gpt-4o")
    llm_with_tools = llm.bind_tools([search_internet])

    messages = state["messages"]
    response = llm_with_tools.invoke(messages)

    return {
        "messages": [response],
        "research_data": "å·²æ”¶é›†çš„ç ”ç©¶æ•°æ®..."
    }

# å­ä»£ç† 2: åˆ†æä¸“å‘˜
def analysis_agent(state: AgentState):
    """åˆ†æä¸“å‘˜ï¼šåˆ†ææ•°æ®"""
    llm = ChatOpenAI(model="claude-sonnet-4-5")
    llm_with_tools = llm.bind_tools([analyze_data])

    # åŸºäºç ”ç©¶æ•°æ®è¿›è¡Œåˆ†æ
    prompt = f"åˆ†æä»¥ä¸‹ç ”ç©¶æ•°æ®ï¼š{state['research_data']}"
    response = llm.invoke(prompt)

    return {
        "messages": [response],
        "analysis_result": "åˆ†æç»“æœï¼šå…³é”®å‘ç°..."
    }

# å­ä»£ç† 3: æŠ¥å‘Šä¸“å‘˜
def report_agent(state: AgentState):
    """æŠ¥å‘Šä¸“å‘˜ï¼šç”ŸæˆæŠ¥å‘Š"""
    llm = ChatOpenAI(model="gpt-4o")

    # åŸºäºåˆ†æç»“æœç”ŸæˆæŠ¥å‘Š
    prompt = f"åŸºäºä»¥ä¸‹åˆ†æç”ŸæˆæŠ¥å‘Šï¼š{state['analysis_result']}"
    response = llm.invoke(prompt)

    return {
        "messages": [response],
        "final_report": "æœ€ç»ˆæŠ¥å‘Šå†…å®¹..."
    }

# æ„å»ºå·¥ä½œæµ
workflow = StateGraph(AgentState)

# æ·»åŠ å­ä»£ç†èŠ‚ç‚¹
workflow.add_node("researcher", research_agent)
workflow.add_node("analyst", analysis_agent)
workflow.add_node("reporter", report_agent)

# å®šä¹‰æ‰§è¡Œé¡ºåºï¼ˆé¡ºåºå·¥ä½œæµï¼‰
workflow.add_edge(START, "researcher")
workflow.add_edge("researcher", "analyst")
workflow.add_edge("analyst", "reporter")
workflow.add_edge("reporter", END)

# ç¼–è¯‘
app = workflow.compile()

# ä½¿ç”¨
from langchain_core.messages import HumanMessage

result = app.invoke({
    "messages": [HumanMessage(content="ç ”ç©¶ AI çš„æœ€æ–°è¿›å±•")]
})

print("æœ€ç»ˆæŠ¥å‘Š:", result["final_report"])

# æ‰§è¡Œæµç¨‹ï¼š
# ç”¨æˆ·è¯·æ±‚ â†’ ç ”ç©¶ä¸“å‘˜ â†’ åˆ†æä¸“å‘˜ â†’ æŠ¥å‘Šä¸“å‘˜ â†’ è¿”å›ç»“æœ
# æ¯ä¸ªä»£ç†ä¸“æ³¨äºè‡ªå·±çš„ä»»åŠ¡ï¼Œæ•°æ®é€šè¿‡çŠ¶æ€ä¼ é€’</code></pre>
                    </div>

                    <h3 class="subsection-title">å¹¶è¡Œæ‰§è¡Œæ¨¡å¼</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty intermediate">ğŸŸ¡ ä¸­çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
å¹¶è¡Œæ‰§è¡Œæ¨¡å¼ - å¤šä¸ªå­ä»£ç†åŒæ—¶å·¥ä½œ
"""
from typing import TypedDict, Annotated
from langgraph.graph import StateGraph, START, END
from langchain_openai import ChatOpenAI

# å®šä¹‰çŠ¶æ€
class ParallelState(TypedDict):
    messages: Annotated[list, add_messages]
    web_results: str
    database_results: str
    api_results: str
    combined_results: str

# å¹¶è¡Œå­ä»£ç† 1: ç½‘ç»œæœç´¢
def web_search_agent(state: ParallelState):
    """ç½‘ç»œæœç´¢ä¸“å‘˜"""
    llm = ChatOpenAI(model="gpt-4o")
    # æœç´¢ç½‘ç»œ
    return {
        "web_results": "ç½‘ç»œæœç´¢ç»“æœ..."
    }

# å¹¶è¡Œå­ä»£ç† 2: æ•°æ®åº“æŸ¥è¯¢
def database_agent(state: ParallelState):
    """æ•°æ®åº“æŸ¥è¯¢ä¸“å‘˜"""
    llm = ChatOpenAI(model="gpt-4o")
    # æŸ¥è¯¢æ•°æ®åº“
    return {
        "database_results": "æ•°æ®åº“æŸ¥è¯¢ç»“æœ..."
    }

# å¹¶è¡Œå­ä»£ç† 3: API è°ƒç”¨
def api_agent(state: ParallelState):
    """API è°ƒç”¨ä¸“å‘˜"""
    llm = ChatOpenAI(model="gpt-4o")
    # è°ƒç”¨å¤–éƒ¨ API
    return {
        "api_results": "API è°ƒç”¨ç»“æœ..."
    }

# æ±‡æ€»ä»£ç†
def aggregator_agent(state: ParallelState):
    """æ±‡æ€»ä¸“å‘˜ï¼šæ•´åˆæ‰€æœ‰å¹¶è¡Œç»“æœ"""
    llm = ChatOpenAI(model="claude-sonnet-4-5")

    # æ•´åˆæ‰€æœ‰æ¥æºçš„æ•°æ®
    combined = f"""
    ç½‘ç»œ: {state['web_results']}
    æ•°æ®åº“: {state['database_results']}
    API: {state['api_results']}
    """

    response = llm.invoke(f"æ•´åˆä»¥ä¸‹ä¿¡æ¯ï¼š{combined}")

    return {
        "combined_results": response.content,
        "messages": [response]
    }

# æ„å»ºå¹¶è¡Œå·¥ä½œæµ
workflow = StateGraph(ParallelState)

# æ·»åŠ å¹¶è¡ŒèŠ‚ç‚¹
workflow.add_node("web_search", web_search_agent)
workflow.add_node("database", database_agent)
workflow.add_node("api", api_agent)
workflow.add_node("aggregator", aggregator_agent)

# å¹¶è¡Œæ‰§è¡Œï¼šä» START åˆ†å‘åˆ°ä¸‰ä¸ªä»£ç†
workflow.add_edge(START, "web_search")
workflow.add_edge(START, "database")
workflow.add_edge(START, "api")

# æ‰€æœ‰å¹¶è¡Œä»»åŠ¡å®Œæˆåæ±‡æ€»
workflow.add_edge("web_search", "aggregator")
workflow.add_edge("database", "aggregator")
workflow.add_edge("api", "aggregator")

workflow.add_edge("aggregator", END)

app = workflow.compile()

# ä½¿ç”¨
result = app.invoke({
    "messages": [HumanMessage(content="æ”¶é›†ç”¨æˆ·æ•°æ®")]
})

print("æ±‡æ€»ç»“æœ:", result["combined_results"])

# æ‰§è¡Œæµç¨‹ï¼š
#           â”Œâ”€â†’ ç½‘ç»œæœç´¢ â”€â”
# ç”¨æˆ·è¯·æ±‚ â”€â”¼â”€â†’ æ•°æ®åº“æŸ¥è¯¢ â”€â”¼â†’ æ±‡æ€» â†’ è¿”å›
#           â””â”€â†’ API è°ƒç”¨ â”€â”˜
# ä¸‰ä¸ªä»£ç†å¹¶è¡Œæ‰§è¡Œï¼Œæé«˜æ•ˆç‡</code></pre>
                    </div>

                    <h3 class="subsection-title">æ¡ä»¶è·¯ç”±æ¨¡å¼</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty advanced">ğŸ”´ é«˜çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
æ¡ä»¶è·¯ç”±æ¨¡å¼ - æ ¹æ®çŠ¶æ€åŠ¨æ€é€‰æ‹©å­ä»£ç†
"""
from typing import TypedDict, Literal
from langgraph.graph import StateGraph, START, END
from langchain_openai import ChatOpenAI
from langchain_core.messages import HumanMessage

# å®šä¹‰çŠ¶æ€
class ConditionalState(TypedDict):
    messages: Annotated[list, add_messages]
    user_type: str  # "new" or "existing"
    issue_type: str  # "technical", "billing", "general"
    resolution: str

# åˆ†ç±»ä»£ç†
def classifier_agent(state: ConditionalState):
    """åˆ†ç±»ä»£ç†ï¼šåˆ¤æ–­ç”¨æˆ·ç±»å‹å’Œé—®é¢˜ç±»å‹"""
    llm = ChatOpenAI(model="gpt-4o")

    prompt = f"""åˆ†æç”¨æˆ·è¯·æ±‚å¹¶åˆ†ç±»ï¼š
    ç”¨æˆ·æ¶ˆæ¯: {state['messages'][-1].content}

    è¿”å› JSON æ ¼å¼ï¼š
    {{"user_type": "new" æˆ– "existing", "issue_type": "technical" æˆ– "billing" æˆ– "general"}}
    """

    response = llm.invoke(prompt)

    # è§£æåˆ†ç±»ç»“æœ
    import json
    classification = json.loads(response.content)

    return {
        "user_type": classification["user_type"],
        "issue_type": classification["issue_type"]
    }

# æ–°ç”¨æˆ·ä»£ç†
def new_user_agent(state: ConditionalState):
    """æ–°ç”¨æˆ·ä¸“å‘˜ï¼šå¼•å¯¼å’Œæ³¨å†Œ"""
    llm = ChatOpenAI(model="gpt-4o")
    response = llm.invoke("æ¬¢è¿æ–°ç”¨æˆ·ï¼Œå¼•å¯¼æ³¨å†Œæµç¨‹")
    return {
        "resolution": "æ–°ç”¨æˆ·å·²å¼•å¯¼",
        "messages": [response]
    }

# æŠ€æœ¯æ”¯æŒä»£ç†
def technical_agent(state: ConditionalState):
    """æŠ€æœ¯æ”¯æŒä¸“å‘˜"""
    llm = ChatOpenAI(model="claude-sonnet-4-5")
    response = llm.invoke("è§£å†³æŠ€æœ¯é—®é¢˜")
    return {
        "resolution": "æŠ€æœ¯é—®é¢˜å·²è§£å†³",
        "messages": [response]
    }

# è´¦å•ä»£ç†
def billing_agent(state: ConditionalState):
    """è´¦å•ä¸“å‘˜"""
    llm = ChatOpenAI(model="gpt-4o")
    response = llm.invoke("å¤„ç†è´¦å•é—®é¢˜")
    return {
        "resolution": "è´¦å•é—®é¢˜å·²å¤„ç†",
        "messages": [response]
    }

# é€šç”¨ä»£ç†
def general_agent(state: ConditionalState):
    """é€šç”¨å®¢æœä¸“å‘˜"""
    llm = ChatOpenAI(model="gpt-4o")
    response = llm.invoke("å¤„ç†ä¸€èˆ¬é—®é¢˜")
    return {
        "resolution": "ä¸€èˆ¬é—®é¢˜å·²å¤„ç†",
        "messages": [response]
    }

# è·¯ç”±å†³ç­–å‡½æ•°
def route_by_user_type(state: ConditionalState) -> Literal["new_user", "route_by_issue"]:
    """æ ¹æ®ç”¨æˆ·ç±»å‹è·¯ç”±"""
    if state["user_type"] == "new":
        return "new_user"
    else:
        return "route_by_issue"

def route_by_issue_type(state: ConditionalState) -> Literal["technical", "billing", "general"]:
    """æ ¹æ®é—®é¢˜ç±»å‹è·¯ç”±"""
    return state["issue_type"]

# æ„å»ºæ¡ä»¶è·¯ç”±å·¥ä½œæµ
workflow = StateGraph(ConditionalState)

# æ·»åŠ æ‰€æœ‰èŠ‚ç‚¹
workflow.add_node("classifier", classifier_agent)
workflow.add_node("new_user", new_user_agent)
workflow.add_node("technical", technical_agent)
workflow.add_node("billing", billing_agent)
workflow.add_node("general", general_agent)

# æ·»åŠ æ¡ä»¶è·¯ç”±
workflow.add_edge(START, "classifier")

# ç¬¬ä¸€å±‚æ¡ä»¶ï¼šç”¨æˆ·ç±»å‹
workflow.add_conditional_edges(
    "classifier",
    route_by_user_type,
    {
        "new_user": "new_user",
        "route_by_issue": "classifier"  # ç»§ç»­åˆ°ç¬¬äºŒå±‚è·¯ç”±
    }
)

# ç¬¬äºŒå±‚æ¡ä»¶ï¼šé—®é¢˜ç±»å‹ï¼ˆä»…ç°æœ‰ç”¨æˆ·ï¼‰
workflow.add_conditional_edges(
    "classifier",
    route_by_issue_type,
    {
        "technical": "technical",
        "billing": "billing",
        "general": "general"
    }
)

# æ‰€æœ‰è·¯å¾„ç»“æŸ
workflow.add_edge("new_user", END)
workflow.add_edge("technical", END)
workflow.add_edge("billing", END)
workflow.add_edge("general", END)

app = workflow.compile()

# æµ‹è¯•ä¸åŒåœºæ™¯
test_cases = [
    "æˆ‘æ˜¯æ–°ç”¨æˆ·ï¼Œå¦‚ä½•æ³¨å†Œï¼Ÿ",           # â†’ new_user
    "æˆ‘çš„è½¯ä»¶å´©æºƒäº†",                   # â†’ technical
    "è´¦å•æœ‰é”™è¯¯",                       # â†’ billing
    "ä½ ä»¬çš„è¥ä¸šæ—¶é—´ï¼Ÿ",                 # â†’ general
]

for test in test_cases:
    result = app.invoke({"messages": [HumanMessage(content=test)]})
    print(f"è¯·æ±‚: {test}")
    print(f"è§£å†³: {result['resolution']}\n")

# æ‰§è¡Œæµç¨‹ï¼š
#                    â”Œâ†’ æ–°ç”¨æˆ·ä¸“å‘˜
# ç”¨æˆ·è¯·æ±‚ â†’ åˆ†ç±»å™¨ â”€â”¼â†’ æŠ€æœ¯ä¸“å‘˜
#                    â”œâ†’ è´¦å•ä¸“å‘˜
#                    â””â†’ é€šç”¨ä¸“å‘˜
# æ ¹æ®åˆ†ç±»ç»“æœåŠ¨æ€è·¯ç”±åˆ°ä¸åŒä»£ç†</code></pre>
                    </div>
                </section>

                <!-- çŠ¶æ€ç®¡ç†å’Œå…±äº« -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ—„ï¸ çŠ¶æ€ç®¡ç†å’Œå…±äº«</h2>
                    <p>
                        Multi-Agent ç³»ç»Ÿä¸­çš„çŠ¶æ€ç®¡ç†æ˜¯<strong>åä½œçš„å…³é”®</strong>ï¼Œ
                        éœ€è¦åœ¨<strong>å…±äº«çŠ¶æ€</strong>å’Œ<strong>ä»£ç†ç‹¬ç«‹æ€§</strong>ä¹‹é—´æ‰¾åˆ°å¹³è¡¡ã€‚
                    </p>

                    <div class="mermaid-wrapper">
                        <div class="mermaid">
graph TB
    subgraph Shared["å…±äº«çŠ¶æ€æ¨¡å¼"]
        S1["Agent 1"] -->|"å†™å…¥ state.data1"| State["å…±äº« State"]
        S2["Agent 2"] -->|"è¯»å– state.data1<br/>å†™å…¥ state.data2"| State
        S3["Agent 3"] -->|"è¯»å– state.data1, data2<br/>ç”Ÿæˆæœ€ç»ˆç»“æœ"| State
    end

    subgraph Isolated["éš”ç¦»çŠ¶æ€æ¨¡å¼"]
        I1["Agent 1<br/>ç‹¬ç«‹çŠ¶æ€"] -->|"ä»…ä¼ é€’ç»“æœ"| I2["Agent 2<br/>ç‹¬ç«‹çŠ¶æ€"]
        I2 -->|"ä»…ä¼ é€’ç»“æœ"| I3["Agent 3<br/>ç‹¬ç«‹çŠ¶æ€"]
    end

    style State fill:#3b82f6,color:#fff
    style S1 fill:#10b981,color:#fff
    style S2 fill:#f59e0b,color:#fff
    style S3 fill:#ef4444,color:#fff
    style I1 fill:#10b981,color:#fff
    style I2 fill:#f59e0b,color:#fff
    style I3 fill:#ef4444,color:#fff
                        </div>
                    </div>

                    <h3 class="subsection-title">çŠ¶æ€å…±äº«ç­–ç•¥</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>ç­–ç•¥</th>
                                <th>ä¼˜ç‚¹</th>
                                <th>ç¼ºç‚¹</th>
                                <th>é€‚ç”¨åœºæ™¯</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>å…¨å±€å…±äº«çŠ¶æ€</strong></td>
                                <td>ä¿¡æ¯å®Œå…¨é€æ˜ï¼Œæ˜“äºè®¿é—®</td>
                                <td>è€¦åˆåº¦é«˜ï¼ŒçŠ¶æ€å¯èƒ½æ··ä¹±</td>
                                <td>ç®€å•å·¥ä½œæµï¼Œä»£ç†éœ€è¦ååŒ</td>
                            </tr>
                            <tr>
                                <td><strong>æœ€å°å…±äº«çŠ¶æ€</strong></td>
                                <td>ä½è€¦åˆï¼Œæ¸…æ™°è¾¹ç•Œ</td>
                                <td>éœ€è¦æ˜¾å¼ä¼ é€’æ•°æ®</td>
                                <td>å¤æ‚ç³»ç»Ÿï¼Œä»£ç†ç‹¬ç«‹æ€§å¼º</td>
                            </tr>
                            <tr>
                                <td><strong>åˆ†å±‚çŠ¶æ€</strong></td>
                                <td>çµæ´»æ€§é«˜ï¼ŒæŒ‰éœ€å…±äº«</td>
                                <td>è®¾è®¡å¤æ‚</td>
                                <td>å¤§å‹ç³»ç»Ÿï¼Œå¤šå±‚çº§ä»£ç†</td>
                            </tr>
                            <tr>
                                <td><strong>äº‹ä»¶é©±åŠ¨</strong></td>
                                <td>æ¾è€¦åˆï¼Œå¯æ‰©å±•</td>
                                <td>è°ƒè¯•å›°éš¾</td>
                                <td>å¼‚æ­¥ç³»ç»Ÿï¼Œäº‹ä»¶å“åº”</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3 class="subsection-title">æœ€å°å…±äº«çŠ¶æ€ç¤ºä¾‹</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty intermediate">ğŸŸ¡ ä¸­çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
æœ€å°å…±äº«çŠ¶æ€ - ä»…å…±äº«å¿…è¦ä¿¡æ¯
"""
from typing import TypedDict, Annotated
from langgraph.graph import StateGraph, START, END

# å®šä¹‰æœ€å°å…±äº«çŠ¶æ€
class MinimalState(TypedDict):
    # å¿…é¡»å…±äº«çš„ä¿¡æ¯
    messages: Annotated[list, add_messages]
    user_id: str

    # æ¯ä¸ªé˜¶æ®µçš„è¾“å‡ºï¼ˆå¯é€‰ï¼‰
    stage1_output: str | None
    stage2_output: str | None
    final_output: str | None

# Agent 1: ä»…å†™å…¥ stage1_output
def agent1(state: MinimalState):
    """ç¬¬ä¸€é˜¶æ®µå¤„ç†"""
    # åªèƒ½è¯»å– messages å’Œ user_id
    # ä¸ä¾èµ–å…¶ä»–ä»£ç†çš„è¾“å‡º
    return {
        "stage1_output": "é˜¶æ®µ 1 ç»“æœ..."
    }

# Agent 2: è¯»å– stage1_outputï¼Œå†™å…¥ stage2_output
def agent2(state: MinimalState):
    """ç¬¬äºŒé˜¶æ®µå¤„ç†"""
    # åªä¾èµ– stage1_output
    input_data = state["stage1_output"]
    return {
        "stage2_output": f"åŸºäº {input_data} çš„é˜¶æ®µ 2 ç»“æœ..."
    }

# Agent 3: è¯»å– stage2_outputï¼Œå†™å…¥ final_output
def agent3(state: MinimalState):
    """ç¬¬ä¸‰é˜¶æ®µå¤„ç†"""
    # åªä¾èµ– stage2_output
    input_data = state["stage2_output"]
    return {
        "final_output": f"åŸºäº {input_data} çš„æœ€ç»ˆç»“æœ"
    }

# æ„å»ºå·¥ä½œæµ
workflow = StateGraph(MinimalState)
workflow.add_node("stage1", agent1)
workflow.add_node("stage2", agent2)
workflow.add_node("stage3", agent3)

workflow.add_edge(START, "stage1")
workflow.add_edge("stage1", "stage2")
workflow.add_edge("stage2", "stage3")
workflow.add_edge("stage3", END)

app = workflow.compile()

# ä¼˜åŠ¿ï¼š
# - æ¸…æ™°çš„æ•°æ®æµå‘
# - æ¯ä¸ªä»£ç†åªè®¿é—®å¿…è¦çš„æ•°æ®
# - æ˜“äºæµ‹è¯•å’Œè°ƒè¯•
# - é™ä½è€¦åˆåº¦</code></pre>
                    </div>
                </section>

                <!-- å®Œæ•´å®æˆ˜ç¤ºä¾‹ -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ¯ å®Œæ•´å®æˆ˜ç¤ºä¾‹</h2>
                    <p>
                        æ„å»ºä¸€ä¸ª<strong>å†…å®¹åˆ›ä½œæµæ°´çº¿</strong>ï¼ŒåŒ…å«ç ”ç©¶ã€å†™ä½œã€ç¼–è¾‘ã€SEO ä¼˜åŒ–å››ä¸ªä¸“ä¸šåŒ–å­ä»£ç†ã€‚
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty advanced">ğŸ”´ é«˜çº§ - ç”Ÿäº§çº§ç¤ºä¾‹</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
å®Œæ•´å®æˆ˜ç¤ºä¾‹ - å†…å®¹åˆ›ä½œæµæ°´çº¿
"""
import os
from typing import TypedDict, Annotated, Literal
from langgraph.graph import StateGraph, START, END
from langgraph.graph.message import add_messages
from langchain_openai import ChatOpenAI
from langchain_anthropic import ChatAnthropic
from langchain.tools import tool

# ========== 1. å®šä¹‰å·¥å…· ==========

@tool
def search_web(query: str, max_results: int = 5) -> str:
    """æœç´¢ç½‘ç»œä¿¡æ¯"""
    # å®é™…ä¼šè°ƒç”¨ Tavily æˆ–å…¶ä»–æœç´¢ API
    return f"å…³äº '{query}' çš„æœç´¢ç»“æœï¼š[ç»“æœ 1], [ç»“æœ 2], [ç»“æœ 3]"

@tool
def check_grammar(text: str) -> dict:
    """è¯­æ³•æ£€æŸ¥"""
    # å®é™…ä¼šè°ƒç”¨è¯­æ³•æ£€æŸ¥ API
    return {"errors": 2, "suggestions": ["å»ºè®® 1", "å»ºè®® 2"]}

@tool
def analyze_seo(text: str) -> dict:
    """SEO åˆ†æ"""
    # å®é™…ä¼šåˆ†æå…³é”®è¯å¯†åº¦ã€å¯è¯»æ€§ç­‰
    return {
        "score": 85,
        "keywords": ["AI", "æœºå™¨å­¦ä¹ "],
        "suggestions": ["å¢åŠ å†…é“¾", "ä¼˜åŒ–æ ‡é¢˜"]
    }

# ========== 2. å®šä¹‰çŠ¶æ€ ==========

class ContentState(TypedDict):
    messages: Annotated[list, add_messages]
    topic: str
    target_audience: str

    # å„é˜¶æ®µè¾“å‡º
    research_notes: str
    draft_content: str
    edited_content: str
    seo_optimized_content: str

    # è´¨é‡æ§åˆ¶
    grammar_check: dict | None
    seo_score: dict | None
    needs_revision: bool

# ========== 3. å®šä¹‰å­ä»£ç† ==========

def research_agent(state: ContentState):
    """ç ”ç©¶ä»£ç†ï¼šæ”¶é›†èƒŒæ™¯èµ„æ–™"""
    llm = ChatOpenAI(model="gpt-4o")
    llm_with_tools = llm.bind_tools([search_web])

    prompt = f"""
    ç ”ç©¶ä¸»é¢˜ï¼š{state['topic']}
    ç›®æ ‡å—ä¼—ï¼š{state['target_audience']}

    ä»»åŠ¡ï¼š
    1. æœç´¢ç›¸å…³ä¿¡æ¯
    2. è¯†åˆ«å…³é”®è¦ç‚¹
    3. æ•´ç†æˆç»“æ„åŒ–ç¬”è®°

    ä¿æŒç¬”è®°ç®€æ´ï¼ˆ< 500 å­—ï¼‰
    """

    response = llm_with_tools.invoke(prompt)

    return {
        "research_notes": "ç ”ç©¶ç¬”è®°ï¼šæ ¸å¿ƒè§‚ç‚¹ 1ã€2ã€3...",
        "messages": [response]
    }

def writer_agent(state: ContentState):
    """å†™ä½œä»£ç†ï¼šåˆ›ä½œå†…å®¹"""
    llm = ChatAnthropic(model="claude-sonnet-4-5")

    prompt = f"""
    åŸºäºä»¥ä¸‹ç ”ç©¶ç¬”è®°åˆ›ä½œæ–‡ç« ï¼š
    {state['research_notes']}

    ä¸»é¢˜ï¼š{state['topic']}
    å—ä¼—ï¼š{state['target_audience']}

    è¦æ±‚ï¼š
    1. ç»“æ„æ¸…æ™°ï¼ˆå¼•è¨€-æ­£æ–‡-ç»“è®ºï¼‰
    2. è¯­è¨€æµç•…
    3. å¼•ç”¨ç ”ç©¶å‘ç°
    4. å­—æ•° 800-1000 å­—
    """

    response = llm.invoke(prompt)

    return {
        "draft_content": response.content,
        "messages": [response]
    }

def editor_agent(state: ContentState):
    """ç¼–è¾‘ä»£ç†ï¼šå®¡æ ¸å’Œä¼˜åŒ–"""
    llm = ChatAnthropic(model="claude-sonnet-4-5")
    llm_with_tools = llm.bind_tools([check_grammar])

    prompt = f"""
    å®¡æ ¸ä»¥ä¸‹è‰ç¨¿ï¼š
    {state['draft_content']}

    ä»»åŠ¡ï¼š
    1. æ£€æŸ¥è¯­æ³•å’Œæ‹¼å†™
    2. ä¼˜åŒ–è¯­è¨€è¡¨è¾¾
    3. ç¡®ä¿é€»è¾‘è¿è´¯
    4. æ”¹è¿›å¯è¯»æ€§

    è¿”å›ä¿®è®¢åçš„å†…å®¹
    """

    response = llm_with_tools.invoke(prompt)

    # æ¨¡æ‹Ÿè¯­æ³•æ£€æŸ¥
    grammar_result = {"errors": 0, "suggestions": []}

    return {
        "edited_content": response.content,
        "grammar_check": grammar_result,
        "messages": [response]
    }

def seo_agent(state: ContentState):
    """SEO ä»£ç†ï¼šæœç´¢å¼•æ“ä¼˜åŒ–"""
    llm = ChatOpenAI(model="gpt-4o")
    llm_with_tools = llm.bind_tools([analyze_seo])

    prompt = f"""
    ä¼˜åŒ– SEOï¼š
    {state['edited_content']}

    ä¸»é¢˜ï¼š{state['topic']}

    ä»»åŠ¡ï¼š
    1. ä¼˜åŒ–å…³é”®è¯å¯†åº¦
    2. æ”¹è¿›æ ‡é¢˜å’Œå­æ ‡é¢˜
    3. æ·»åŠ å…ƒæè¿°
    4. ç¡®ä¿å¯è¯»æ€§

    è¿”å› SEO ä¼˜åŒ–åçš„å†…å®¹
    """

    response = llm_with_tools.invoke(prompt)

    # æ¨¡æ‹Ÿ SEO åˆ†æ
    seo_result = {
        "score": 88,
        "keywords": ["AI", "è‡ªåŠ¨åŒ–"],
        "suggestions": []
    }

    return {
        "seo_optimized_content": response.content,
        "seo_score": seo_result,
        "needs_revision": seo_result["score"] < 80,
        "messages": [response]
    }

def quality_check_agent(state: ContentState):
    """è´¨é‡æ£€æŸ¥ä»£ç†ï¼šæœ€ç»ˆå®¡æ ¸"""
    llm = ChatOpenAI(model="gpt-4o")

    prompt = f"""
    æœ€ç»ˆè´¨é‡æ£€æŸ¥ï¼š

    SEO è¯„åˆ†ï¼š{state['seo_score']['score']}
    è¯­æ³•é”™è¯¯ï¼š{state['grammar_check']['errors']}

    å†…å®¹ï¼š
    {state['seo_optimized_content'][:200]}...

    åˆ¤æ–­æ˜¯å¦éœ€è¦ä¿®è®¢ï¼ˆæ˜¯/å¦ï¼‰
    """

    response = llm.invoke(prompt)

    # æ ¹æ®è¯„åˆ†å†³å®šæ˜¯å¦éœ€è¦ä¿®è®¢
    needs_revision = state['seo_score']['score'] < 80 or state['grammar_check']['errors'] > 2

    return {
        "needs_revision": needs_revision,
        "messages": [response]
    }

# ========== 4. æ„å»ºå·¥ä½œæµ ==========

workflow = StateGraph(ContentState)

# æ·»åŠ æ‰€æœ‰èŠ‚ç‚¹
workflow.add_node("researcher", research_agent)
workflow.add_node("writer", writer_agent)
workflow.add_node("editor", editor_agent)
workflow.add_node("seo", seo_agent)
workflow.add_node("quality_check", quality_check_agent)

# å®šä¹‰æµç¨‹
workflow.add_edge(START, "researcher")
workflow.add_edge("researcher", "writer")
workflow.add_edge("writer", "editor")
workflow.add_edge("editor", "seo")
workflow.add_edge("seo", "quality_check")

# æ¡ä»¶è·¯ç”±ï¼šå¦‚æœéœ€è¦ä¿®è®¢ï¼Œè¿”å›ç¼–è¾‘é˜¶æ®µ
def should_revise(state: ContentState) -> Literal["revise", "finish"]:
    """å†³ç­–ï¼šæ˜¯å¦éœ€è¦ä¿®è®¢"""
    return "revise" if state.get("needs_revision", False) else "finish"

workflow.add_conditional_edges(
    "quality_check",
    should_revise,
    {
        "revise": "editor",  # è¿”å›ç¼–è¾‘é˜¶æ®µ
        "finish": END
    }
)

# ç¼–è¯‘å·¥ä½œæµ
app = workflow.compile()

# ========== 5. ä½¿ç”¨æµæ°´çº¿ ==========

from langchain_core.messages import HumanMessage

result = app.invoke({
    "messages": [HumanMessage(content="åˆ›å»ºä¸€ç¯‡æ–‡ç« ")],
    "topic": "AI åœ¨å†…å®¹åˆ›ä½œä¸­çš„åº”ç”¨",
    "target_audience": "è¥é”€äººå‘˜"
})

print("æœ€ç»ˆå†…å®¹:")
print(result["seo_optimized_content"])
print("\nSEO è¯„åˆ†:", result["seo_score"]["score"])
print("è¯­æ³•é”™è¯¯:", result["grammar_check"]["errors"])

# æ‰§è¡Œæµç¨‹ï¼š
# ç ”ç©¶ â†’ å†™ä½œ â†’ ç¼–è¾‘ â†’ SEO â†’ è´¨é‡æ£€æŸ¥
#                   â†‘              â†“
#                   â””â”€â”€ éœ€è¦ä¿®è®¢ â”€â”€â”˜

# ä¼˜åŠ¿ï¼š
# - æ¯ä¸ªä»£ç†ä¸“æ³¨äºè‡ªå·±çš„é¢†åŸŸ
# - å¯ä»¥ä½¿ç”¨æœ€é€‚åˆçš„æ¨¡å‹ï¼ˆå†™ä½œç”¨ Claudeï¼ŒSEO ç”¨ GPTï¼‰
# - æ”¯æŒè´¨é‡åé¦ˆå¾ªç¯
# - æ˜“äºæ‰©å±•ï¼ˆæ·»åŠ æ–°çš„ä¼˜åŒ–æ­¥éª¤ï¼‰
# - æ¯ä¸ªé˜¶æ®µå¯ç‹¬ç«‹æµ‹è¯•</code></pre>
                    </div>
                </section>

                <!-- æœ€ä½³å®è·µ -->
                <section class="content-section">
                    <h2 class="section-title">âœ¨ Multi-Agent Subagents æœ€ä½³å®è·µ</h2>

                    <h3 class="subsection-title">1. ä»£ç†èŒè´£è®¾è®¡</h3>
                    <div class="info-box tip">
                        <div class="info-box-title">âœ… å¥½çš„è®¾è®¡</div>
                        <ul>
                            <li><strong>å•ä¸€èŒè´£</strong>ï¼šæ¯ä¸ªä»£ç†ä¸“æ³¨ä¸€ä¸ªæ˜ç¡®çš„ä»»åŠ¡</li>
                            <li><strong>æ¸…æ™°è¾¹ç•Œ</strong>ï¼šä»£ç†ä¹‹é—´çš„èŒè´£ä¸é‡å </li>
                            <li><strong>å¯æµ‹è¯•</strong>ï¼šæ¯ä¸ªä»£ç†å¯ä»¥ç‹¬ç«‹æµ‹è¯•</li>
                            <li><strong>å¯é‡ç”¨</strong>ï¼šä»£ç†å¯ä»¥åœ¨ä¸åŒå·¥ä½œæµä¸­é‡ç”¨</li>
                        </ul>
                    </div>

                    <h3 class="subsection-title">2. çŠ¶æ€è®¾è®¡åŸåˆ™</h3>
                    <ul>
                        <li><strong>æœ€å°åŒ–å…±äº«</strong>ï¼šåªå…±äº«å¿…è¦çš„çŠ¶æ€å­—æ®µ</li>
                        <li><strong>æ˜ç¡®æ•°æ®æµ</strong>ï¼šæ¸…æ¥šå“ªä¸ªä»£ç†å†™å…¥å“ªä¸ªå­—æ®µ</li>
                        <li><strong>ç±»å‹å®‰å…¨</strong>ï¼šä½¿ç”¨ TypedDict å®šä¹‰çŠ¶æ€ç»“æ„</li>
                        <li><strong>å¯é€‰å­—æ®µ</strong>ï¼šä½¿ç”¨ <code>| None</code> æ ‡è®°å¯é€‰å­—æ®µ</li>
                    </ul>

                    <h3 class="subsection-title">3. å·¥ä½œæµè®¾è®¡</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>æ¨¡å¼</th>
                                <th>ä½•æ—¶ä½¿ç”¨</th>
                                <th>ç¤ºä¾‹åœºæ™¯</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>é¡ºåºå·¥ä½œæµ</strong></td>
                                <td>ä»»åŠ¡æœ‰æ˜ç¡®çš„å…ˆåé¡ºåº</td>
                                <td>ç ”ç©¶ â†’ å†™ä½œ â†’ ç¼–è¾‘</td>
                            </tr>
                            <tr>
                                <td><strong>å¹¶è¡Œå·¥ä½œæµ</strong></td>
                                <td>ä»»åŠ¡å¯ä»¥åŒæ—¶è¿›è¡Œ</td>
                                <td>å¤šæºæ•°æ®æ”¶é›†</td>
                            </tr>
                            <tr>
                                <td><strong>æ¡ä»¶å·¥ä½œæµ</strong></td>
                                <td>æ ¹æ®ç»“æœåŠ¨æ€è·¯ç”±</td>
                                <td>å®¢æœåˆ†ç±»è·¯ç”±</td>
                            </tr>
                            <tr>
                                <td><strong>å¾ªç¯å·¥ä½œæµ</strong></td>
                                <td>éœ€è¦è¿­ä»£ä¼˜åŒ–</td>
                                <td>è´¨é‡æ£€æŸ¥ â†’ ä¿®è®¢</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3 class="subsection-title">4. é”™è¯¯å¤„ç†</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python"># ä¸ºæ¯ä¸ªä»£ç†æ·»åŠ é”™è¯¯å¤„ç†
def robust_agent(state: AgentState):
    """å¸¦é”™è¯¯å¤„ç†çš„ä»£ç†"""
    try:
        # ä¸»è¦é€»è¾‘
        result = process_task(state)
        return result
    except SpecificError as e:
        # ç‰¹å®šé”™è¯¯çš„å¤„ç†
        logger.error(f"ä»£ç†å¤±è´¥: {e}")
        return {
            "error": str(e),
            "fallback_result": "é™çº§å¤„ç†ç»“æœ"
        }
    except Exception as e:
        # é€šç”¨é”™è¯¯å¤„ç†
        logger.error(f"æœªé¢„æœŸé”™è¯¯: {e}")
        return {
            "error": str(e),
            "status": "failed"
        }</code></pre>
                    </div>

                    <h3 class="subsection-title">5. æ€§èƒ½ä¼˜åŒ–</h3>
                    <ul>
                        <li><strong>å¹¶è¡ŒåŒ–</strong>ï¼šè¯†åˆ«å¯å¹¶è¡Œçš„ä»»åŠ¡</li>
                        <li><strong>ç¼“å­˜</strong>ï¼šç¼“å­˜ä»£ç†çš„è¾“å‡ºé¿å…é‡å¤è®¡ç®—</li>
                        <li><strong>æµå¼è¾“å‡º</strong>ï¼šå¯¹äºé•¿æ—¶é—´ä»»åŠ¡ä½¿ç”¨æµå¼å“åº”</li>
                        <li><strong>è¶…æ—¶æ§åˆ¶</strong>ï¼šä¸ºæ¯ä¸ªä»£ç†è®¾ç½®åˆç†çš„è¶…æ—¶</li>
                        <li><strong>èµ„æºé™åˆ¶</strong>ï¼šé™åˆ¶å¹¶å‘ä»£ç†æ•°é‡</li>
                    </ul>
                </section>

                <!-- å¸¸è§é—®é¢˜ -->
                <section class="content-section">
                    <h2 class="section-title">â“ å¸¸è§é—®é¢˜</h2>

                    <h3 class="subsection-subtitle">Q1: Multi-Agent Subagents å’Œ DeepAgents Subagents å¯ä»¥æ··ç”¨å—ï¼Ÿ</h3>
                    <p>
                        <strong>å¯ä»¥</strong>ï¼å®é™…ä¸Šè¿™æ˜¯æ¨èçš„åšæ³•ï¼š
                    </p>
                    <ul>
                        <li>ä½¿ç”¨ <strong>Multi-Agent</strong> æ„å»ºé¡¶å±‚å·¥ä½œæµï¼ˆä»£ç†ä¹‹é—´çš„åä½œï¼‰</li>
                        <li>æ¯ä¸ª Multi-Agent èŠ‚ç‚¹å¯ä»¥æ˜¯ä¸€ä¸ª <strong>DeepAgent</strong>ï¼ˆå¢å¼ºå•ä¸ªä»£ç†èƒ½åŠ›ï¼‰</li>
                        <li>è¿™æ ·æ—¢è·å¾—äº†ä¸“ä¸šåŒ–åˆ†å·¥çš„ä¼˜åŠ¿ï¼Œåˆè·å¾—äº†å¼ºå¤§çš„å•ä»£ç†èƒ½åŠ›</li>
                    </ul>

                    <h3 class="subsection-subtitle">Q2: å¦‚ä½•å¤„ç†ä»£ç†ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Ÿ</h3>
                    <p>
                        <strong>ä½¿ç”¨æ˜ç¡®çš„è¾¹å’ŒçŠ¶æ€å­—æ®µ</strong>ï¼š
                    </p>
                    <ul>
                        <li>åœ¨çŠ¶æ€ä¸­å®šä¹‰ä¾èµ–å­—æ®µï¼ˆå¦‚ <code>stage1_output</code>ï¼‰</li>
                        <li>ä½¿ç”¨ <code>add_edge</code> å®šä¹‰æ‰§è¡Œé¡ºåº</li>
                        <li>åç»­ä»£ç†åªè¯»å–å‰ç½®ä»£ç†çš„è¾“å‡ºå­—æ®µ</li>
                        <li>é¿å…éšå¼ä¾èµ–ï¼Œä¿æŒæ•°æ®æµæ¸…æ™°</li>
                    </ul>

                    <h3 class="subsection-subtitle">Q3: å¹¶è¡Œä»£ç†å¦‚ä½•åŒæ­¥ï¼Ÿ</h3>
                    <p>
                        <strong>LangGraph è‡ªåŠ¨åŒæ­¥</strong>ï¼š
                    </p>
                    <ul>
                        <li>æ‰€æœ‰å¹¶è¡Œä»£ç†æ‰§è¡Œå®Œæ¯•åï¼Œæ‰ä¼šè¿›å…¥ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</li>
                        <li>å¯ä»¥æ·»åŠ ä¸€ä¸ª "æ±‡æ€»èŠ‚ç‚¹" æ•´åˆå¹¶è¡Œç»“æœ</li>
                        <li>çŠ¶æ€æ›´æ–°ä¼šè‡ªåŠ¨åˆå¹¶</li>
                    </ul>

                    <h3 class="subsection-subtitle">Q4: å¦‚ä½•è°ƒè¯•å¤æ‚çš„ Multi-Agent å·¥ä½œæµï¼Ÿ</h3>
                    <p>
                        <strong>è°ƒè¯•ç­–ç•¥</strong>ï¼š
                    </p>
                    <ul>
                        <li><strong>LangSmith è¿½è¸ª</strong>ï¼šå¯è§†åŒ–æ•´ä¸ªæ‰§è¡Œæµç¨‹</li>
                        <li><strong>é€èŠ‚ç‚¹æµ‹è¯•</strong>ï¼šå•ç‹¬æµ‹è¯•æ¯ä¸ªä»£ç†</li>
                        <li><strong>æ‰“å°çŠ¶æ€</strong>ï¼šåœ¨å…³é”®èŠ‚ç‚¹æ‰“å°çŠ¶æ€</li>
                        <li><strong>å¯è§†åŒ–å·¥ä½œæµ</strong>ï¼šä½¿ç”¨ Mermaid å›¾è¡¨</li>
                    </ul>

                    <h3 class="subsection-subtitle">Q5: å¾ªç¯å·¥ä½œæµå¦‚ä½•é¿å…æ— é™å¾ªç¯ï¼Ÿ</h3>
                    <p>
                        <strong>è®¾ç½®å¾ªç¯é™åˆ¶</strong>ï¼š
                    </p>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python"># åœ¨çŠ¶æ€ä¸­æ·»åŠ å¾ªç¯è®¡æ•°å™¨
class LoopState(TypedDict):
    iteration_count: int
    max_iterations: int
    # ... å…¶ä»–å­—æ®µ

def should_continue(state: LoopState) -> Literal["continue", "stop"]:
    """å†³ç­–ï¼šæ˜¯å¦ç»§ç»­å¾ªç¯"""
    if state["iteration_count"] >= state["max_iterations"]:
        return "stop"  # è¾¾åˆ°æœ€å¤§æ¬¡æ•°ï¼Œåœæ­¢
    if state.get("quality_ok", False):
        return "stop"  # è´¨é‡åˆæ ¼ï¼Œåœæ­¢
    return "continue"  # ç»§ç»­å¾ªç¯

# åœ¨å¾ªç¯èŠ‚ç‚¹ä¸­é€’å¢è®¡æ•°å™¨
def revision_agent(state: LoopState):
    return {
        "iteration_count": state["iteration_count"] + 1,
        # ... å…¶ä»–å¤„ç†
    }</code></pre>
                    </div>

                    <h3 class="subsection-subtitle">Q6: å¦‚ä½•é€‰æ‹©æ¯ä¸ªä»£ç†ä½¿ç”¨çš„æ¨¡å‹ï¼Ÿ</h3>
                    <p>
                        <strong>æ ¹æ®ä»»åŠ¡ç‰¹ç‚¹é€‰æ‹©</strong>ï¼š
                    </p>
                    <table>
                        <thead>
                            <tr>
                                <th>ä»»åŠ¡ç±»å‹</th>
                                <th>æ¨èæ¨¡å‹</th>
                                <th>åŸå› </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>æ•°æ®æ”¶é›†</td>
                                <td>GPT-4o</td>
                                <td>å¿«é€Ÿã€æˆæœ¬ä½</td>
                            </tr>
                            <tr>
                                <td>å¤æ‚åˆ†æ</td>
                                <td>Claude Sonnet 4.5</td>
                                <td>æ¨ç†èƒ½åŠ›å¼º</td>
                            </tr>
                            <tr>
                                <td>åˆ›æ„å†™ä½œ</td>
                                <td>Claude Sonnet 4.5</td>
                                <td>è¯­è¨€è´¨é‡é«˜</td>
                            </tr>
                            <tr>
                                <td>ä»£ç ç”Ÿæˆ</td>
                                <td>GPT-4o</td>
                                <td>ä»£ç èƒ½åŠ›ä¼˜ç§€</td>
                            </tr>
                            <tr>
                                <td>ç®€å•åˆ†ç±»</td>
                                <td>GPT-4o-mini</td>
                                <td>æˆæœ¬æœ€ä½</td>
                            </tr>
                        </tbody>
                    </table>
                </section>

                <!-- å‚è€ƒèµ„æº -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ“– å‚è€ƒèµ„æº</h2>
                    <ul>
                        <li>
                            <a href="https://docs.langchain.com/oss/python/langchain/multi-agent/subagents" target="_blank">
                                Multi-Agent Subagents å®˜æ–¹æ–‡æ¡£
                            </a>
                        </li>
                        <li>
                            <a href="26-deepagents-subagents.html">
                                DeepAgents å­ä»£ç† - å¯¹æ¯”å­¦ä¹ 
                            </a>
                        </li>
                        <li>
                            <a href="30-multi-agent-index.html">
                                Multi-Agent æ¦‚è¿°
                            </a>
                        </li>
                        <li>
                            <a href="15-langgraph.html">
                                LangGraph - å›¾å·¥ä½œæµåŸºç¡€
                            </a>
                        </li>
                        <li>
                            <a href="32-multi-agent-handoffs.html">
                                Multi-Agent äº¤æ¥æœºåˆ¶
                            </a>
                        </li>
                        <li>
                            <a href="35-multi-agent-workflow.html">
                                Multi-Agent è‡ªå®šä¹‰å·¥ä½œæµ
                            </a>
                        </li>
                    </ul>
                </section>

                <!-- é¡µé¢å¯¼èˆª -->
                <nav class="page-navigation">
                    <a href="30-multi-agent-index.html" class="nav-button prev">
                        â† ä¸Šä¸€é¡µï¼šMulti-Agent æ¦‚è¿°
                    </a>
                    <a href="32-multi-agent-handoffs.html" class="nav-button next">
                        ä¸‹ä¸€é¡µï¼šäº¤æ¥æœºåˆ¶ â†’
                    </a>
                </nav>
            </div>
        </main>
    </div>

    <!-- è¿”å›é¡¶éƒ¨æŒ‰é’® -->
    <button class="back-to-top" aria-label="è¿”å›é¡¶éƒ¨">â†‘</button>

    <!-- JavaScript -->
    <script src="assets/js/mermaid-init.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
</body>
</html>
