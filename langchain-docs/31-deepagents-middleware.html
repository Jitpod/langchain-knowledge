<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="DeepAgents ä¸­é—´ä»¶ - æ¨¡å—åŒ–èƒ½åŠ›æ‰©å±•ç³»ç»Ÿ">
    <title>DeepAgents ä¸­é—´ä»¶ | LangChain 1.0 Python çŸ¥è¯†æ–‡æ¡£</title>
    <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
    <button class="mobile-menu-button" aria-label="æ‰“å¼€èœå•">â˜°</button>

    <div class="container">
        <!-- ä¾§è¾¹æ å¯¼èˆª -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <h1 class="sidebar-title">ğŸ¦œ LangChain 1.0</h1>
                <p class="sidebar-subtitle">Python å®Œæ•´å­¦ä¹ æŒ‡å—</p>
            </div>

            <ul class="nav-menu">
                <li class="nav-section">
                    <div class="nav-section-title">å¼€å§‹</div>
                    <ul>
                        <li class="nav-item">
                            <a href="index.html" class="nav-link">
                                <span class="nav-icon">ğŸ </span>
                                ä¸»é¡µ
                            </a>
                        </li>
                    </ul>
                </li>

                <li class="nav-section">
                    <div class="nav-section-title">åŸºç¡€ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="01-introduction.html" class="nav-link">
                                <span class="nav-icon">ğŸ“–</span>
                                LangChain ç®€ä»‹
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="02-architecture.html" class="nav-link">
                                <span class="nav-icon">ğŸ—ï¸</span>
                                æ ¸å¿ƒæ¶æ„
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="03-models.html" class="nav-link">
                                <span class="nav-icon">ğŸ¤–</span>
                                æ¨¡å‹æ¥å£
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="04-messages.html" class="nav-link">
                                <span class="nav-icon">ğŸ’¬</span>
                                æ¶ˆæ¯ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="05-tools.html" class="nav-link">
                                <span class="nav-icon">ğŸ”§</span>
                                å·¥å…·ç³»ç»Ÿ
                            </a>
                        </li>
                    </ul>
                </li>

                <li class="nav-section">
                    <div class="nav-section-title">è¿›é˜¶ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="06-agents.html" class="nav-link">
                                <span class="nav-icon">ğŸ¯</span>
                                Agent åŸºç¡€
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="07-middleware.html" class="nav-link">
                                <span class="nav-icon">âš™ï¸</span>
                                ä¸­é—´ä»¶ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="08-rag.html" class="nav-link">
                                <span class="nav-icon">ğŸ”</span>
                                RAG è¯¦è§£
                                <span class="nav-badge">é‡ç‚¹</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="09-lcel.html" class="nav-link">
                                <span class="nav-icon">ğŸ”—</span>
                                LCEL è¡¨è¾¾å¼
                            </a>
                        </li>
                    </ul>
                </li>

                                <li class="nav-section">
                    <div class="nav-section-title">é«˜çº§åº”ç”¨</div>
                    <ul>
                        <li class="nav-item">
                            <a href="10-runtime.html" class="nav-link">
                                <span class="nav-icon">ğŸ”Œ</span>
                                Runtime ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="11-checkpointer.html" class="nav-link">
                                <span class="nav-icon">ğŸ’¾</span>
                                æŒä¹…åŒ–ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="12-streaming.html" class="nav-link">
                                <span class="nav-icon">ğŸŒŠ</span>
                                æµå¼è¾“å‡º
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="13-human-in-loop.html" class="nav-link">
                                <span class="nav-icon">ğŸ‘¤</span>
                                äººå·¥ä»‹å…¥
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="14-long-term-memory.html" class="nav-link">
                                <span class="nav-icon">ğŸ—„ï¸</span>
                                é•¿æœŸè®°å¿†
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="15-langgraph.html" class="nav-link">
                                <span class="nav-icon">ğŸ“Š</span>
                                LangGraph
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="16-context-engineering.html" class="nav-link">
                                <span class="nav-icon">ğŸ¯</span>
                                ä¸Šä¸‹æ–‡å·¥ç¨‹
                                <span class="nav-badge">é‡ç‚¹</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="17-mcp.html" class="nav-link">
                                <span class="nav-icon">ğŸ”Œ</span>
                                MCP åè®®
                            </a>
                        </li>
                    </ul>
                </li>


                                <li class="nav-section">
                    <div class="nav-section-title">å®æˆ˜ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="18-customer-service.html" class="nav-link">
                                <span class="nav-icon">ğŸ‘¥</span>
                                å®¢æœæœºå™¨äºº
                                <span class="nav-badge">é‡ç‚¹</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="19-best-practices.html" class="nav-link">
                                <span class="nav-icon">âœ¨</span>
                                æœ€ä½³å®è·µ
                            </a>
                        </li>
                    </ul>
                </li>


                                <li class="nav-section">
                    <div class="nav-section-title">å‚è€ƒç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="20-api-reference.html" class="nav-link">
                                <span class="nav-icon">ğŸ“š</span>
                                API é€ŸæŸ¥è¡¨
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="21-troubleshooting.html" class="nav-link">
                                <span class="nav-icon">ğŸ›</span>
                                æ•…éšœæ’é™¤
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="22-migration.html" class="nav-link">
                                <span class="nav-icon">ğŸ”„</span>
                                è¿ç§»æŒ‡å—
                            </a>
                        </li>
                    </ul>
                </li>


                                <li class="nav-section">
                    <div class="nav-section-title">æ‰©å±•ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="23-structured-output.html" class="nav-link">
                                <span class="nav-icon">ğŸ“Š</span>
                                ç»“æ„åŒ–è¾“å‡º
                            </a>
                        </li>
                    </ul>
                </li>


                                <li class="nav-section">
                    <div class="nav-section-title">DeepAgents ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="24-deepagents-quickstart.html" class="nav-link">
                                <span class="nav-icon">ğŸš€</span>
                                å¿«é€Ÿå¼€å§‹
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="25-deepagents-customization.html" class="nav-link">
                                <span class="nav-icon">ğŸ¨</span>
                                å®šåˆ¶åŒ–
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="26-deepagents-harness.html" class="nav-link">
                                <span class="nav-icon">ğŸ›ï¸</span>
                                Harness ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="27-deepagents-backends.html" class="nav-link">
                                <span class="nav-icon">ğŸ”§</span>
                                åç«¯é…ç½®
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="28-deepagents-subagents.html" class="nav-link">
                                <span class="nav-icon">ğŸ‘¥</span>
                                å­ä»£ç†
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="29-deepagents-hitl.html" class="nav-link">
                                <span class="nav-icon">ğŸ¤</span>
                                äººå·¥ä»‹å…¥
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="30-deepagents-memory.html" class="nav-link">
                                <span class="nav-icon">ğŸ§ </span>
                                é•¿æœŸè®°å¿†
                            </a>
                        </li>
                        <li class="nav-item active">
                            <a href="31-deepagents-middleware.html" class="nav-link">
                                <span class="nav-icon">âš™ï¸</span>
                                ä¸­é—´ä»¶
                            </a>
                        </li>
                    </ul>
                </li>


                                <li class="nav-section">
                    <div class="nav-section-title">Multi-Agent ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="32-multi-agent-index.html" class="nav-link">
                                <span class="nav-icon">ğŸŒ</span>
                                æ¦‚è¿°
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="33-multi-agent-subagents.html" class="nav-link">
                                <span class="nav-icon">ğŸ‘¥</span>
                                å­ä»£ç†
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="34-multi-agent-handoffs.html" class="nav-link">
                                <span class="nav-icon">ğŸ”„</span>
                                äº¤æ¥æœºåˆ¶
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="35-multi-agent-skills.html" class="nav-link">
                                <span class="nav-icon">ğŸ¯</span>
                                æŠ€èƒ½ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="36-multi-agent-router.html" class="nav-link">
                                <span class="nav-icon">ğŸ§­</span>
                                è·¯ç”±æœºåˆ¶
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="37-multi-agent-workflow.html" class="nav-link">
                                <span class="nav-icon">ğŸ”€</span>
                                è‡ªå®šä¹‰å·¥ä½œæµ
                            </a>
                        </li>
                    </ul>
                </li>
            </ul>
        </nav>

        <!-- ä¸»å†…å®¹åŒºåŸŸ -->
        <main class="main-content">
            <div class="content-wrapper">
                <!-- é¢åŒ…å±‘å¯¼èˆª -->
                <nav class="breadcrumb">
                    <span class="breadcrumb-item">
                        <a href="index.html" class="breadcrumb-link">ä¸»é¡µ</a>
                    </span>
                    <span class="breadcrumb-item">
                        DeepAgents ç¯‡
                    </span>
                    <span class="breadcrumb-item">
                        ä¸­é—´ä»¶
                    </span>
                </nav>

                <!-- é¡µé¢æ ‡é¢˜ -->
                <header class="page-header">
                    <h1 class="page-title">âš™ï¸ DeepAgents ä¸­é—´ä»¶</h1>
                    <p class="page-subtitle">
                        æ¨¡å—åŒ–ä¸­é—´ä»¶æ¶æ„ï¼Œé€šè¿‡å¯ç»„åˆçš„ç»„ä»¶ä¸º Agent æä¾›è§„åˆ’ã€è®°å¿†ç®¡ç†ã€
                        ä»»åŠ¡å§”æ´¾ç­‰æ ¸å¿ƒèƒ½åŠ›ï¼Œçµæ´»æ‰©å±• Agent åŠŸèƒ½ã€‚
                    </p>
                </header>

                <!-- ä»€ä¹ˆæ˜¯ä¸­é—´ä»¶ -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ“š ä»€ä¹ˆæ˜¯ä¸­é—´ä»¶ï¼Ÿ</h2>
                    <p>
                        <strong>ä¸­é—´ä»¶ï¼ˆMiddlewareï¼‰</strong>æ˜¯ DeepAgents çš„<strong>æ¨¡å—åŒ–èƒ½åŠ›æ‰©å±•ç³»ç»Ÿ</strong>ã€‚
                        æ¯ä¸ªä¸­é—´ä»¶ç»„ä»¶æä¾›ç‰¹å®šçš„åŠŸèƒ½ï¼Œé€šè¿‡å¯ç»„åˆçš„æ–¹å¼ä¸º Agent æ·»åŠ æ‰€éœ€èƒ½åŠ›ã€‚
                    </p>

                    <div class="info-box note">
                        <div class="info-box-title">ğŸ’¡ ä¸‰å¤§æ ¸å¿ƒä¸­é—´ä»¶</div>
                        <p>
                            ä½¿ç”¨ <code>create_deep_agent()</code> æ—¶ï¼Œæ¡†æ¶ä¼š<strong>è‡ªåŠ¨é™„åŠ </strong>ä¸‰ç§æ ¸å¿ƒä¸­é—´ä»¶ï¼š
                        </p>
                        <table style="margin-top: 0.5rem;">
                            <thead>
                                <tr>
                                    <th>ä¸­é—´ä»¶</th>
                                    <th>ä¸»è¦åŠŸèƒ½</th>
                                    <th>æä¾›çš„å·¥å…·</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>TodoListMiddleware</strong></td>
                                    <td>ç»“æ„åŒ–ä»»åŠ¡è§„åˆ’</td>
                                    <td><code>write_todos</code></td>
                                </tr>
                                <tr>
                                    <td><strong>FilesystemMiddleware</strong></td>
                                    <td>çŸ­æœŸå’Œé•¿æœŸè®°å¿†ç®¡ç†</td>
                                    <td><code>ls, read_file, write_file, edit_file</code></td>
                                </tr>
                                <tr>
                                    <td><strong>SubAgentMiddleware</strong></td>
                                    <td>ä»»åŠ¡å§”æ´¾å’Œä¸Šä¸‹æ–‡éš”ç¦»</td>
                                    <td><code>task</code>ï¼ˆå­ä»£ç†ï¼‰</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="mermaid-wrapper">
                        <div class="mermaid">
graph TB
    User["ç”¨æˆ·è¯·æ±‚"] --> Agent["DeepAgent"]

    Agent --> M1["TodoListMiddleware<br/>ä»»åŠ¡è§„åˆ’"]
    Agent --> M2["FilesystemMiddleware<br/>è®°å¿†ç®¡ç†"]
    Agent --> M3["SubAgentMiddleware<br/>ä»»åŠ¡å§”æ´¾"]

    M1 --> T1["write_todos<br/>å·¥å…·"]
    M2 --> T2["ls, read_file<br/>write_file, edit_file<br/>å·¥å…·"]
    M3 --> T3["task<br/>å·¥å…·"]

    T1 --> Cap1["è§„åˆ’èƒ½åŠ›<br/>å¤šæ­¥éª¤ä»»åŠ¡åˆ†è§£"]
    T2 --> Cap2["è®°å¿†èƒ½åŠ›<br/>ä¸´æ—¶/æŒä¹…åŒ–å­˜å‚¨"]
    T3 --> Cap3["å§”æ´¾èƒ½åŠ›<br/>ä¸Šä¸‹æ–‡éš”ç¦»"]

    Cap1 --> Result["å¢å¼ºçš„ Agent"]
    Cap2 --> Result
    Cap3 --> Result

    style Agent fill:#3b82f6,color:#fff
    style M1 fill:#10b981,color:#fff
    style M2 fill:#f59e0b,color:#fff
    style M3 fill:#8b5cf6,color:#fff
    style Result fill:#ef4444,color:#fff
                        </div>
                    </div>

                    <h3 class="subsection-title">ä¸­é—´ä»¶çš„æ ¸å¿ƒç‰¹æ€§</h3>
                    <ul>
                        <li><strong>å¯ç»„åˆæ€§</strong>ï¼šå¯ä»¥æ·»åŠ ä»»æ„æ•°é‡çš„ä¸­é—´ä»¶ï¼Œæ ¹æ®éœ€æ±‚è‡ªç”±ç»„åˆ</li>
                        <li><strong>è‡ªåŠ¨å·¥å…·æ³¨å…¥</strong>ï¼šä¸­é—´ä»¶è‡ªåŠ¨ä¸º Agent æä¾›ç›¸åº”çš„å·¥å…·</li>
                        <li><strong>å¯é€‰é…ç½®</strong>ï¼šå¯ä»¥é€‰æ‹©æ€§å¯ç”¨æˆ–ç¦ç”¨ç‰¹å®šä¸­é—´ä»¶</li>
                        <li><strong>åˆ†å±‚åº”ç”¨</strong>ï¼šä¸» Agent å’Œå­ä»£ç†å¯ä»¥æœ‰ä¸åŒçš„ä¸­é—´ä»¶é…ç½®</li>
                    </ul>
                </section>

                <!-- ä¸‰å¤§æ ¸å¿ƒä¸­é—´ä»¶è¯¦è§£ -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ”§ ä¸‰å¤§æ ¸å¿ƒä¸­é—´ä»¶è¯¦è§£</h2>

                    <h3 class="subsection-title">1. TodoListMiddleware - ä»»åŠ¡è§„åˆ’</h3>
                    <p>
                        <strong>TodoListMiddleware</strong> æä¾› <code>write_todos</code> å·¥å…·ï¼Œ
                        æ”¯æŒç»“æ„åŒ–çš„ä»»åŠ¡è§„åˆ’å’Œè‡ªé€‚åº”è°ƒæ•´ã€‚
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty basic">ğŸŸ¢ åŸºç¡€</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
TodoListMiddleware - ä»»åŠ¡è§„åˆ’ç¤ºä¾‹
"""
from deepagents import create_deep_agent
from deepagents.middleware import TodoListMiddleware

agent = create_deep_agent(
    model="gpt-4o",
    middleware=[
        TodoListMiddleware(
            system_prompt="""å½“é‡åˆ°å¤šæ­¥éª¤ä»»åŠ¡æ—¶ï¼Œ
            ä½¿ç”¨ write_todos å·¥å…·åˆ†è§£ä»»åŠ¡ã€è·Ÿè¸ªè¿›åº¦ã€‚"""
        )
    ]
)

# ä½¿ç”¨ Agent
result = agent.invoke({
    "messages": [{
        "role": "user",
        "content": "å¸®æˆ‘ç ”ç©¶ AI Agent æŠ€æœ¯æ ˆå¹¶å†™ä¸€ä»½æŠ¥å‘Š"
    }]
})

# Agent ä¼šè‡ªåŠ¨ï¼š
# 1. ä½¿ç”¨ write_todos åˆ†è§£ä»»åŠ¡ï¼š
#    - ç ”ç©¶ Agent æ¡†æ¶
#    - æ”¶é›†ä»£ç ç¤ºä¾‹
#    - åˆ†ææœ€ä½³å®è·µ
#    - æ’°å†™æŠ¥å‘Š
# 2. é€æ­¥æ‰§è¡Œå¹¶æ›´æ–°å¾…åŠäº‹é¡¹çŠ¶æ€
# 3. å®Œæˆæ‰€æœ‰ä»»åŠ¡åç”ŸæˆæŠ¥å‘Š</code></pre>
                    </div>

                    <h3 class="subsection-title">2. FilesystemMiddleware - è®°å¿†ç®¡ç†</h3>
                    <p>
                        <strong>FilesystemMiddleware</strong> æä¾› 4 ä¸ªæ–‡ä»¶ç³»ç»Ÿå·¥å…·ï¼Œ
                        æ”¯æŒä¸´æ—¶å’ŒæŒä¹…åŒ–è®°å¿†ç®¡ç†ã€‚
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty intermediate">ğŸŸ¡ ä¸­çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
FilesystemMiddleware - è®°å¿†ç®¡ç†ç¤ºä¾‹
"""
from deepagents import create_deep_agent
from deepagents.middleware import FilesystemMiddleware
from deepagents.backends import CompositeBackend, StateBackend, StoreBackend
from langgraph.store.memory import InMemoryStore

# é…ç½®æ··åˆå­˜å‚¨åç«¯
def make_backend(runtime):
    return CompositeBackend(
        default=StateBackend(runtime),  # ä¸´æ—¶æ–‡ä»¶
        routes={
            "/memories/": StoreBackend(runtime)  # é•¿æœŸè®°å¿†
        }
    )

agent = create_deep_agent(
    model="claude-sonnet-4-5-20250929",
    store=InMemoryStore(),
    middleware=[
        FilesystemMiddleware(
            backend=make_backend,
            custom_tool_descriptions={
                "write_file": "ä¿å­˜æœç´¢ç»“æœã€ä¸­é—´æ•°æ®åˆ°æ–‡ä»¶ç³»ç»Ÿ",
                "read_file": "è¯»å–å·²ä¿å­˜çš„æ–‡ä»¶å†…å®¹",
            }
        )
    ],
    system_prompt="""ä½ å¯ä»¥ä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿç®¡ç†æ•°æ®ï¼š

- ä¸´æ—¶æ•°æ®ï¼šä¿å­˜åˆ° /tmp/ ä¸‹
- é•¿æœŸè®°å¿†ï¼šä¿å­˜åˆ° /memories/ ä¸‹ï¼ˆè·¨å¯¹è¯æŒä¹…åŒ–ï¼‰

ç¤ºä¾‹ï¼š
- /tmp/search_results.txtï¼ˆä¸´æ—¶ï¼‰
- /memories/user_preferences.txtï¼ˆæŒä¹…åŒ–ï¼‰
"""
)

# Agent å¯ä»¥è‡ªåŠ¨ç®¡ç†è®°å¿†
result = agent.invoke({
    "messages": [{
        "role": "user",
        "content": "æœç´¢ LangChain æœ€æ–°åŠŸèƒ½å¹¶ä¿å­˜åˆ°é•¿æœŸè®°å¿†"
    }]
})

# Agent ä¼šï¼š
# 1. æœç´¢ä¿¡æ¯
# 2. ä½¿ç”¨ write_file ä¿å­˜åˆ° /memories/langchain_features.txt
# 3. ä¸‹æ¬¡å¯¹è¯å¯ä»¥ç”¨ read_file è¯»å–</code></pre>
                    </div>

                    <h3 class="subsection-title">3. SubAgentMiddleware - ä»»åŠ¡å§”æ´¾</h3>
                    <p>
                        <strong>SubAgentMiddleware</strong> æä¾› <code>task</code> å·¥å…·ï¼Œ
                        å…è®¸åˆ›å»ºä¸“é—¨åŒ–çš„å­ä»£ç†å¹¶éš”ç¦»ä¸Šä¸‹æ–‡ã€‚
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty intermediate">ğŸŸ¡ ä¸­çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
SubAgentMiddleware - ä»»åŠ¡å§”æ´¾ç¤ºä¾‹
"""
from langchain.tools import tool
from deepagents import create_deep_agent
from deepagents.middleware import SubAgentMiddleware

@tool
def internet_search(query: str) -> dict:
    """æœç´¢ç½‘ç»œä¿¡æ¯"""
    # å®é™…æœç´¢é€»è¾‘
    return {"results": [...]}

agent = create_deep_agent(
    model="claude-sonnet-4-5-20250929",
    middleware=[
        SubAgentMiddleware(
            subagents=[
                {
                    "name": "research-agent",
                    "description": "æ·±å…¥ç ”ç©¶ç‰¹å®šä¸»é¢˜ï¼Œç»¼åˆå¤šä¸ªæ¥æº",
                    "system_prompt": "ä½ æ˜¯ç ”ç©¶ä¸“å®¶...",
                    "tools": [internet_search],
                    "model": "gpt-4o",  # å­ä»£ç†å¯ä½¿ç”¨ä¸åŒæ¨¡å‹
                }
            ],
            default_model="claude-sonnet-4-5-20250929"
        )
    ]
)

# ä½¿ç”¨ Agent
result = agent.invoke({
    "messages": [{
        "role": "user",
        "content": "æ·±å…¥ç ”ç©¶é‡å­è®¡ç®—çš„æœ€æ–°è¿›å±•"
    }]
})

# Agent ä¼šï¼š
# 1. è¯†åˆ«è¿™æ˜¯å¤æ‚ç ”ç©¶ä»»åŠ¡
# 2. ä½¿ç”¨ task å·¥å…·å§”æ´¾ç»™ research-agent
# 3. å­ä»£ç†æ‰§è¡Œè¯¦ç»†ç ”ç©¶ï¼ˆä¸Šä¸‹æ–‡éš”ç¦»ï¼‰
# 4. å­ä»£ç†è¿”å›ç®€æ´æ‘˜è¦ç»™ä¸» Agent
# 5. ä¸» Agent æ•´åˆç»“æœè¿”å›ç”¨æˆ·</code></pre>
                    </div>
                </section>

                <!-- è‡ªå®šä¹‰ä¸­é—´ä»¶é…ç½® -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ›ï¸ è‡ªå®šä¹‰ä¸­é—´ä»¶é…ç½®</h2>
                    <p>
                        ä½ å¯ä»¥<strong>é€‰æ‹©æ€§å¯ç”¨ä¸­é—´ä»¶</strong>ï¼Œæˆ–è€…<strong>å®Œå…¨è‡ªå®šä¹‰</strong>ä¸­é—´ä»¶åˆ—è¡¨ã€‚
                    </p>

                    <h3 class="subsection-title">ç¦ç”¨ç‰¹å®šä¸­é—´ä»¶</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty basic">ğŸŸ¢ åŸºç¡€</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
ç¦ç”¨ç‰¹å®šä¸­é—´ä»¶
"""
from deepagents import create_deep_agent
from deepagents.middleware import FilesystemMiddleware

# åªå¯ç”¨ FilesystemMiddlewareï¼Œç¦ç”¨å…¶ä»–
agent = create_deep_agent(
    model="gpt-4o",
    middleware=[
        FilesystemMiddleware()  # ä»…æ–‡ä»¶ç³»ç»Ÿä¸­é—´ä»¶
    ]
)

# æ­¤ Agentï¼š
# âœ… æœ‰æ–‡ä»¶ç³»ç»Ÿå·¥å…·ï¼ˆls, read_file, write_file, edit_fileï¼‰
# âŒ æ— å¾…åŠäº‹é¡¹å·¥å…·ï¼ˆwrite_todosï¼‰
# âŒ æ— å­ä»£ç†å·¥å…·ï¼ˆtaskï¼‰</code></pre>
                    </div>

                    <h3 class="subsection-title">å­ä»£ç†ç‹¬ç«‹ä¸­é—´ä»¶</h3>
                    <p>
                        å­ä»£ç†å¯ä»¥æ‹¥æœ‰<strong>ä¸ä¸» Agent ä¸åŒçš„ä¸­é—´ä»¶é…ç½®</strong>ã€‚
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty advanced">ğŸ”´ é«˜çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
å­ä»£ç†ç‹¬ç«‹ä¸­é—´ä»¶é…ç½®
"""
from deepagents import create_deep_agent
from deepagents.middleware import (
    TodoListMiddleware,
    FilesystemMiddleware,
    SubAgentMiddleware
)

agent = create_deep_agent(
    model="claude-sonnet-4-5-20250929",

    # ä¸» Agent çš„ä¸­é—´ä»¶
    middleware=[
        TodoListMiddleware(),
        SubAgentMiddleware(
            subagents=[{
                "name": "data-processor",
                "description": "å¤„ç†å¤§é‡æ•°æ®æ–‡ä»¶",
                "tools": [...],

                # å­ä»£ç†çš„ç‹¬ç«‹ä¸­é—´ä»¶é…ç½®
                "middleware": [
                    FilesystemMiddleware()  # ä»…æ–‡ä»¶ç³»ç»Ÿ
                ]
            }]
        )
    ]
)

# é…ç½®ç»“æœï¼š
# ä¸» Agentï¼šæœ‰ TodoList + SubAgent èƒ½åŠ›
# å­ä»£ç† data-processorï¼šä»…æœ‰ Filesystem èƒ½åŠ›

# ç”¨é€”ï¼š
# - ä¸» Agent ä¸“æ³¨åè°ƒå’Œè§„åˆ’
# - å­ä»£ç†ä¸“æ³¨æ•°æ®å¤„ç†ï¼Œæ— éœ€è§„åˆ’å·¥å…·</code></pre>
                    </div>
                </section>

                <!-- ä¸­é—´ä»¶æ‰§è¡Œé¡ºåº -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ”„ ä¸­é—´ä»¶æ‰§è¡Œé¡ºåº</h2>
                    <p>
                        ä¸­é—´ä»¶çš„<strong>æ‰§è¡Œé¡ºåº</strong>ç”±å®ƒä»¬åœ¨åˆ—è¡¨ä¸­çš„é¡ºåºå†³å®šã€‚
                        æ¡†æ¶æŒ‰é¡ºåºå¤„ç†ä¸­é—´ä»¶ï¼Œä¾æ¬¡æ³¨å…¥å·¥å…·å’Œé…ç½®ã€‚
                    </p>

                    <div class="mermaid-wrapper">
                        <div class="mermaid">
graph LR
    Start["create_deep_agent()"] --> M1["ä¸­é—´ä»¶ 1<br/>åˆå§‹åŒ–"]
    M1 --> Tools1["æ³¨å…¥å·¥å…· 1"]
    Tools1 --> M2["ä¸­é—´ä»¶ 2<br/>åˆå§‹åŒ–"]
    M2 --> Tools2["æ³¨å…¥å·¥å…· 2"]
    Tools2 --> M3["ä¸­é—´ä»¶ 3<br/>åˆå§‹åŒ–"]
    M3 --> Tools3["æ³¨å…¥å·¥å…· 3"]
    Tools3 --> Agent["å®Œæ•´çš„ Agent<br/>åŒ…å«æ‰€æœ‰å·¥å…·"]

    style Start fill:#e0e0e0,color:#000
    style M1 fill:#10b981,color:#fff
    style M2 fill:#f59e0b,color:#fff
    style M3 fill:#8b5cf6,color:#fff
    style Agent fill:#3b82f6,color:#fff
                        </div>
                    </div>

                    <div class="info-box tip">
                        <div class="info-box-title">ğŸ’¡ é¡ºåºå»ºè®®</div>
                        <p>
                            é€šå¸¸å»ºè®®çš„é¡ºåºï¼š
                        </p>
                        <ol>
                            <li><strong>TodoListMiddleware</strong>ï¼šé¦–å…ˆæ³¨å…¥è§„åˆ’èƒ½åŠ›</li>
                            <li><strong>FilesystemMiddleware</strong>ï¼šç„¶åæ³¨å…¥è®°å¿†ç®¡ç†</li>
                            <li><strong>SubAgentMiddleware</strong>ï¼šæœ€åæ³¨å…¥ä»»åŠ¡å§”æ´¾èƒ½åŠ›</li>
                        </ol>
                        <p>
                            è¿™ä¸ªé¡ºåºç¡®ä¿ Agent èƒ½å¤Ÿï¼šè§„åˆ’ â†’ ä¿å­˜æ•°æ® â†’ å§”æ´¾å­ä»»åŠ¡ã€‚
                        </p>
                    </div>
                </section>

                <!-- å®Œæ•´å®æˆ˜ç¤ºä¾‹ -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ¯ å®Œæ•´å®æˆ˜ç¤ºä¾‹</h2>
                    <p>
                        æ„å»ºä¸€ä¸ª<strong>ç ”ç©¶åŠ©æ‰‹ Agent</strong>ï¼Œç»¼åˆä½¿ç”¨ä¸‰ç§æ ¸å¿ƒä¸­é—´ä»¶ï¼Œ
                        æ”¯æŒä»»åŠ¡è§„åˆ’ã€æ•°æ®ç®¡ç†ã€ä¸“é—¨åŒ–å­ä»£ç†ã€‚
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty advanced">ğŸ”´ é«˜çº§ - ç”Ÿäº§çº§ç¤ºä¾‹</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
å®Œæ•´å®æˆ˜ç¤ºä¾‹ - ç ”ç©¶åŠ©æ‰‹ï¼ˆç»¼åˆä½¿ç”¨ä¸‰ç§ä¸­é—´ä»¶ï¼‰
"""
import os
from typing import Literal
from tavily import TavilyClient
from deepagents import create_deep_agent
from deepagents.middleware import (
    TodoListMiddleware,
    FilesystemMiddleware,
    SubAgentMiddleware
)
from deepagents.backends import CompositeBackend, StateBackend, StoreBackend
from langgraph.store.memory import InMemoryStore

# ========== 1. å®šä¹‰å·¥å…· ==========

tavily_client = TavilyClient(api_key=os.environ["TAVILY_API_KEY"])

def internet_search(query: str, max_results: int = 5) -> dict:
    """æœç´¢ç½‘ç»œä¿¡æ¯"""
    return tavily_client.search(query, max_results=max_results)

def analyze_data(data: str) -> dict:
    """åˆ†ææ•°æ®å¹¶ç”Ÿæˆæ´å¯Ÿ"""
    # ç®€åŒ–ç¤ºä¾‹ï¼šå®é™…ä¼šæ‰§è¡Œæ•°æ®åˆ†æ
    return {
        "insights": ["å‘ç° 1", "å‘ç° 2"],
        "summary": "æ•°æ®åˆ†ææ‘˜è¦..."
    }

# ========== 2. é…ç½®å­˜å‚¨åç«¯ ==========

store = InMemoryStore()

def make_backend(runtime):
    return CompositeBackend(
        default=StateBackend(runtime),
        routes={
            "/memories/": StoreBackend(runtime),  # é•¿æœŸè®°å¿†
            "/tmp/": StateBackend(runtime),        # ä¸´æ—¶æ•°æ®
        }
    )

# ========== 3. é…ç½®ä¸­é—´ä»¶ ==========

middleware = [
    # ä¸­é—´ä»¶ 1: ä»»åŠ¡è§„åˆ’
    TodoListMiddleware(
        system_prompt="""å½“å¤„ç†å¤æ‚ç ”ç©¶ä»»åŠ¡æ—¶ï¼š

1. ä½¿ç”¨ write_todos åˆ†è§£ä»»åŠ¡ä¸ºå…·ä½“æ­¥éª¤
2. æŒ‰é¡ºåºæ‰§è¡Œæ¯ä¸ªæ­¥éª¤
3. å®Œæˆåæ›´æ–°å¾…åŠäº‹é¡¹çŠ¶æ€
"""
    ),

    # ä¸­é—´ä»¶ 2: æ–‡ä»¶ç³»ç»Ÿå’Œè®°å¿†
    FilesystemMiddleware(
        backend=make_backend,
        custom_tool_descriptions={
            "write_file": "ä¿å­˜ç ”ç©¶ç»“æœåˆ°æ–‡ä»¶ï¼ˆä¸´æ—¶æˆ–é•¿æœŸï¼‰",
            "read_file": "è¯»å–å·²ä¿å­˜çš„ç ”ç©¶ç¬”è®°",
            "ls": "åˆ—å‡ºå·²ä¿å­˜çš„æ–‡ä»¶",
            "edit_file": "æ›´æ–°æ—¢æœ‰çš„ç ”ç©¶ç¬”è®°",
        }
    ),

    # ä¸­é—´ä»¶ 3: å­ä»£ç†
    SubAgentMiddleware(
        subagents=[
            {
                "name": "web-researcher",
                "description": "ä¸“é—¨æœç´¢å’Œåˆ†æç½‘ç»œä¿¡æ¯",
                "system_prompt": """ä½ æ˜¯ç½‘ç»œç ”ç©¶ä¸“å®¶ã€‚

ä»»åŠ¡ï¼š
1. ä½¿ç”¨ internet_search æœç´¢ç›¸å…³ä¿¡æ¯
2. åˆ†ææœç´¢ç»“æœè´¨é‡
3. ç»¼åˆä¿¡æ¯å¹¶ç”Ÿæˆç»“æ„åŒ–æ‘˜è¦

è¾“å‡ºæ ¼å¼ï¼š
- æ ¸å¿ƒå‘ç°ï¼ˆ3-5 ç‚¹ï¼‰
- å…³é”®æ•°æ®
- ä¿¡æ¯æ¥æº

ä¿æŒè¾“å‡ºåœ¨ 500 å­—ä»¥å†…ã€‚""",
                "tools": [internet_search],
                "model": "gpt-4o",
            },
            {
                "name": "data-analyst",
                "description": "åˆ†ææ•°æ®å¹¶ç”Ÿæˆæ´å¯ŸæŠ¥å‘Š",
                "system_prompt": """ä½ æ˜¯æ•°æ®åˆ†æä¸“å®¶ã€‚

ä»»åŠ¡ï¼š
1. ä½¿ç”¨ analyze_data åˆ†ææ•°æ®
2. è¯†åˆ«æ¨¡å¼å’Œè¶‹åŠ¿
3. ç”Ÿæˆå¯æ“ä½œçš„å»ºè®®

è¾“å‡ºæ ¼å¼ï¼š
- å…³é”®æ´å¯Ÿ
- æ•°æ®æ”¯æ’‘
- å»ºè®®è¡ŒåŠ¨

ä¿æŒè¾“å‡ºåœ¨ 400 å­—ä»¥å†…ã€‚""",
                "tools": [analyze_data],
                "model": "claude-sonnet-4-5-20250929",
            }
        ],
        default_model="claude-sonnet-4-5-20250929"
    )
]

# ========== 4. åˆ›å»ºç ”ç©¶åŠ©æ‰‹ ==========

research_assistant_prompt = """ä½ æ˜¯ä¸€ä½é«˜æ•ˆçš„ç ”ç©¶åŠ©æ‰‹ã€‚ä½ çš„æ ¸å¿ƒèƒ½åŠ›åŒ…æ‹¬ï¼š

## 1. ä»»åŠ¡è§„åˆ’èƒ½åŠ›
- ä½¿ç”¨ write_todos åˆ†è§£å¤æ‚ä»»åŠ¡
- è·Ÿè¸ªè¿›åº¦å¹¶é€‚åº”æ€§è°ƒæ•´

## 2. è®°å¿†ç®¡ç†èƒ½åŠ›
- ä¸´æ—¶æ•°æ®ï¼šä¿å­˜åˆ° /tmp/ ä¸‹ï¼ˆå¯¹è¯ç»“æŸåæ¸…é™¤ï¼‰
- é•¿æœŸè®°å¿†ï¼šä¿å­˜åˆ° /memories/ ä¸‹ï¼ˆè·¨å¯¹è¯æŒä¹…åŒ–ï¼‰

æ–‡ä»¶ç»„ç»‡ï¼š
- /memories/research/[ä¸»é¢˜]/notes.txtï¼šç ”ç©¶ç¬”è®°
- /memories/research/[ä¸»é¢˜]/sources.txtï¼šä¿¡æ¯æ¥æº
- /tmp/temp_data.txtï¼šä¸´æ—¶å·¥ä½œæ•°æ®

## 3. ä»»åŠ¡å§”æ´¾èƒ½åŠ›
- **web-researcher**ï¼šç½‘ç»œæœç´¢å’Œä¿¡æ¯ç»¼åˆ
- **data-analyst**ï¼šæ•°æ®åˆ†æå’Œæ´å¯Ÿç”Ÿæˆ

å§”æ´¾ç­–ç•¥ï¼š
- éœ€è¦æœç´¢å¤šä¸ªæ¥æº â†’ å§”æ´¾ç»™ web-researcher
- éœ€è¦åˆ†ææ•°æ® â†’ å§”æ´¾ç»™ data-analyst
- å¤æ‚ä»»åŠ¡å¯ä»¥è¿ç»­å§”æ´¾å¤šä¸ªå­ä»£ç†

## å·¥ä½œæµç¨‹

1. **æ¥æ”¶ä»»åŠ¡** â†’ ä½¿ç”¨ write_todos åˆ†è§£
2. **æ‰§è¡Œç ”ç©¶** â†’ å§”æ´¾ç»™ç›¸åº”å­ä»£ç†
3. **ä¿å­˜æ•°æ®** â†’ ä½¿ç”¨ write_file æŒä¹…åŒ–
4. **ç”ŸæˆæŠ¥å‘Š** â†’ æ•´åˆæ‰€æœ‰ä¿¡æ¯
5. **å®Œæˆä»»åŠ¡** â†’ æ›´æ–°å¾…åŠäº‹é¡¹çŠ¶æ€

å§‹ç»ˆä¿æŒä¸»ä¸Šä¸‹æ–‡æ¸…æ´ï¼Œå°†è¯¦ç»†å·¥ä½œå§”æ´¾ç»™å­ä»£ç†ã€‚
"""

agent = create_deep_agent(
    model="claude-sonnet-4-5-20250929",
    middleware=middleware,
    store=store,
    system_prompt=research_assistant_prompt
)

# ========== 5. ä½¿ç”¨ç ”ç©¶åŠ©æ‰‹ ==========

result = agent.invoke({
    "messages": [{
        "role": "user",
        "content": """è¯·ç ”ç©¶ AI Agent çš„ä¸»æµæŠ€æœ¯æ ˆï¼š

1. æœç´¢å½“å‰æµè¡Œçš„ Agent æ¡†æ¶
2. åˆ†æå®ƒä»¬çš„ç‰¹ç‚¹å’Œä¼˜åŠ¿
3. ç”Ÿæˆå¯¹æ¯”æŠ¥å‘Šå¹¶ä¿å­˜åˆ°é•¿æœŸè®°å¿†
"""
    }]
})

print(result["messages"][-1].content)

# Agent æ‰§è¡Œæµç¨‹ï¼š
#
# 1. ã€TodoListã€‘åˆ†è§£ä»»åŠ¡ï¼š
#    - æœç´¢ Agent æ¡†æ¶
#    - åˆ†ææ¡†æ¶ç‰¹ç‚¹
#    - ç”Ÿæˆå¯¹æ¯”æŠ¥å‘Š
#    - ä¿å­˜åˆ°é•¿æœŸè®°å¿†
#
# 2. ã€SubAgentã€‘å§”æ´¾ç»™ web-researcherï¼š
#    - æœç´¢ LangChain, AutoGPT, CrewAI ç­‰æ¡†æ¶
#    - è¿”å›ç®€æ´æ‘˜è¦ï¼ˆ< 500 å­—ï¼‰
#
# 3. ã€SubAgentã€‘å§”æ´¾ç»™ data-analystï¼š
#    - åˆ†ææ¡†æ¶å¯¹æ¯”æ•°æ®
#    - è¿”å›æ´å¯ŸæŠ¥å‘Šï¼ˆ< 400 å­—ï¼‰
#
# 4. ã€Filesystemã€‘ä¿å­˜ç»“æœï¼š
#    - write_file("/memories/research/ai_agents/report.md")
#    - write_file("/memories/research/ai_agents/sources.txt")
#
# 5. ã€TodoListã€‘æ›´æ–°çŠ¶æ€ï¼š
#    - æ ‡è®°æ‰€æœ‰ä»»åŠ¡ä¸ºå·²å®Œæˆ
#
# 6. è¿”å›æœ€ç»ˆæŠ¥å‘Šç»™ç”¨æˆ·

# ä¼˜åŠ¿ï¼š
# - ä¸» Agent ä¸Šä¸‹æ–‡å§‹ç»ˆæ¸…æ´ï¼ˆå­ä»£ç†éš”ç¦»äº†è¯¦ç»†å·¥ä½œï¼‰
# - ä»»åŠ¡è¿›åº¦é€æ˜ï¼ˆTodoList è·Ÿè¸ªï¼‰
# - æ•°æ®æŒä¹…åŒ–ï¼ˆä¸‹æ¬¡å¯¹è¯å¯ä»¥ç»§ç»­ï¼‰
# - ä¸“é—¨åŒ–å¤„ç†ï¼ˆä¸åŒå­ä»£ç†ç”¨æœ€åˆé€‚çš„æ¨¡å‹ï¼‰</code></pre>
                    </div>
                </section>

                <!-- æœ€ä½³å®è·µ -->
                <section class="content-section">
                    <h2 class="section-title">âœ¨ ä¸­é—´ä»¶æœ€ä½³å®è·µ</h2>

                    <h3 class="subsection-title">1. ä¸­é—´ä»¶é€‰æ‹©ç­–ç•¥</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>åœºæ™¯</th>
                                <th>æ¨èä¸­é—´ä»¶</th>
                                <th>åŸå› </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>ç®€å•æŸ¥è¯¢ Agent</td>
                                <td>æ— éœ€ä¸­é—´ä»¶</td>
                                <td>ç›´æ¥å·¥å…·è°ƒç”¨å³å¯</td>
                            </tr>
                            <tr>
                                <td>å¤šæ­¥éª¤ä»»åŠ¡</td>
                                <td>TodoListMiddleware</td>
                                <td>éœ€è¦è§„åˆ’å’Œè·Ÿè¸ª</td>
                            </tr>
                            <tr>
                                <td>éœ€è¦ä¿å­˜æ•°æ®</td>
                                <td>FilesystemMiddleware</td>
                                <td>ç®¡ç†ä¸­é—´ç»“æœ</td>
                            </tr>
                            <tr>
                                <td>å¤æ‚ç ”ç©¶ä»»åŠ¡</td>
                                <td>å…¨éƒ¨ä¸‰ç§</td>
                                <td>ç»¼åˆèƒ½åŠ›æœ€å¤§åŒ–</td>
                            </tr>
                            <tr>
                                <td>ä¸“é—¨åŒ–å¤„ç†</td>
                                <td>SubAgentMiddleware</td>
                                <td>ä¸Šä¸‹æ–‡éš”ç¦»</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3 class="subsection-title">2. ç³»ç»Ÿæç¤ºä¸­çš„ä¸­é—´ä»¶å¼•å¯¼</h3>
                    <div class="info-box tip">
                        <div class="info-box-title">ğŸ“ æç¤ºè¯æ¨¡æ¿</div>
                        <p>åœ¨ç³»ç»Ÿæç¤ºä¸­<strong>æ˜ç¡®è¯´æ˜ä½•æ—¶ä½¿ç”¨ä¸­é—´ä»¶å·¥å…·</strong>ï¼š</p>
                        <ul>
                            <li><strong>TodoList</strong>ï¼šå¤šæ­¥éª¤ä»»åŠ¡ â†’ ä½¿ç”¨ write_todos è§„åˆ’</li>
                            <li><strong>Filesystem</strong>ï¼šå¤§é‡æ•°æ® â†’ ä¿å­˜åˆ°æ–‡ä»¶è€Œéä¸Šä¸‹æ–‡</li>
                            <li><strong>SubAgent</strong>ï¼šå¤æ‚å­ä»»åŠ¡ â†’ å§”æ´¾ç»™ä¸“é—¨ä»£ç†</li>
                        </ul>
                    </div>

                    <h3 class="subsection-title">3. ä¸Šä¸‹æ–‡ç®¡ç†åŸåˆ™</h3>
                    <ul>
                        <li><strong>åŠæ—¶ä¿å­˜</strong>ï¼šæœç´¢ç»“æœç­‰ä¸­é—´æ•°æ®ç«‹å³å†™å…¥æ–‡ä»¶</li>
                        <li><strong>ç²¾ç®€æ‘˜è¦</strong>ï¼šå­ä»£ç†è¿”å›æ‘˜è¦è€Œéå®Œæ•´æ•°æ®</li>
                        <li><strong>è·¯å¾„è§„èŒƒ</strong>ï¼šä½¿ç”¨æ¸…æ™°çš„æ–‡ä»¶è·¯å¾„ç»“æ„</li>
                        <li><strong>å®šæœŸæ¸…ç†</strong>ï¼šåˆ é™¤ä¸å†éœ€è¦çš„ä¸´æ—¶æ–‡ä»¶</li>
                    </ul>

                    <h3 class="subsection-title">4. å­ä»£ç†ä¸­é—´ä»¶é…ç½®</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python"># âœ… å¥½çš„é…ç½®ï¼šå­ä»£ç†ä»…éœ€æ–‡ä»¶ç³»ç»Ÿ
subagent = {
    "name": "data-processor",
    "tools": [...],
    "middleware": [FilesystemMiddleware()]  # ä»…æ–‡ä»¶ç³»ç»Ÿ
}

# âŒ ä¸å¥½çš„é…ç½®ï¼šå­ä»£ç†æœ‰ä¸å¿…è¦çš„ä¸­é—´ä»¶
subagent = {
    "name": "data-processor",
    "tools": [...],
    "middleware": [
        TodoListMiddleware(),  # ä¸éœ€è¦è§„åˆ’
        SubAgentMiddleware()   # ä¸éœ€è¦å†å§”æ´¾
    ]
}</code></pre>
                    </div>

                    <h3 class="subsection-title">5. æ€§èƒ½ä¼˜åŒ–</h3>
                    <ul>
                        <li><strong>æœ€å°åŒ–ä¸­é—´ä»¶</strong>ï¼šåªæ·»åŠ å¿…éœ€çš„ä¸­é—´ä»¶ï¼Œå‡å°‘å·¥å…·æ•°é‡</li>
                        <li><strong>åˆç†å§”æ´¾</strong>ï¼šä»…åœ¨ç¡®å®éœ€è¦éš”ç¦»ä¸Šä¸‹æ–‡æ—¶ä½¿ç”¨å­ä»£ç†</li>
                        <li><strong>ç¼“å­˜æ–‡ä»¶</strong>ï¼šé‡å¤ä½¿ç”¨çš„æ•°æ®ä¿å­˜åˆ° /memories/ é¿å…é‡å¤è·å–</li>
                        <li><strong>è‡ªå®šä¹‰æè¿°</strong>ï¼šä½¿ç”¨ custom_tool_descriptions ä¼˜åŒ–å·¥å…·é€‰æ‹©</li>
                    </ul>
                </section>

                <!-- å¸¸è§é—®é¢˜ -->
                <section class="content-section">
                    <h2 class="section-title">â“ å¸¸è§é—®é¢˜</h2>

                    <h3 class="subsection-subtitle">Q1: å¯ä»¥å®Œå…¨ç¦ç”¨æ‰€æœ‰ä¸­é—´ä»¶å—ï¼Ÿ</h3>
                    <p>
                        <strong>å¯ä»¥</strong>ï¼Œä¼ é€’ç©ºåˆ—è¡¨å³å¯ï¼š
                    </p>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">agent = create_deep_agent(
    model="gpt-4o",
    middleware=[]  # ç¦ç”¨æ‰€æœ‰ä¸­é—´ä»¶
)

# æ­¤ Agent åªæœ‰ä½ æ˜¾å¼æä¾›çš„ toolsï¼Œæ— å†…ç½®å·¥å…·</code></pre>
                    </div>

                    <h3 class="subsection-subtitle">Q2: å­ä»£ç†ä¼šè‡ªåŠ¨ç»§æ‰¿çˆ¶ Agent çš„ä¸­é—´ä»¶å—ï¼Ÿ</h3>
                    <p>
                        <strong>ä¸ä¼š</strong>ã€‚å­ä»£ç†éœ€è¦<strong>æ˜¾å¼é…ç½®</strong>è‡ªå·±çš„ä¸­é—´ä»¶ï¼š
                    </p>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">subagent = {
    "name": "my-subagent",
    "middleware": [FilesystemMiddleware()]  # å¿…é¡»æ˜¾å¼æŒ‡å®š
}</code></pre>
                    </div>

                    <h3 class="subsection-subtitle">Q3: SubAgentMiddleware çš„ default_model æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h3>
                    <p>
                        <strong>default_model</strong> ä¸ºæœªæ˜¾å¼æŒ‡å®šæ¨¡å‹çš„å­ä»£ç†æä¾›é»˜è®¤æ¨¡å‹ï¼š
                    </p>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">SubAgentMiddleware(
    subagents=[
        {"name": "agent1"},  # ä½¿ç”¨ default_model
        {"name": "agent2", "model": "gpt-4o"},  # ä½¿ç”¨æ˜¾å¼æ¨¡å‹
    ],
    default_model="claude-sonnet-4-5-20250929"
)</code></pre>
                    </div>

                    <h3 class="subsection-subtitle">Q4: å¯ä»¥å°†é¢„æ„å»ºçš„ LangGraph å›¾ä½œä¸ºå­ä»£ç†å—ï¼Ÿ</h3>
                    <p>
                        <strong>å¯ä»¥</strong>ï¼Œä½¿ç”¨ <code>CompiledSubAgent</code> åŒ…è£…ï¼š
                    </p>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">from deepagents import CompiledSubAgent
from langgraph.graph import StateGraph, END

# æ„å»º LangGraph å·¥ä½œæµ
workflow = StateGraph(...)
# ... æ·»åŠ èŠ‚ç‚¹å’Œè¾¹ ...
custom_graph = workflow.compile()

# åŒ…è£…ä¸ºå­ä»£ç†
custom_subagent = CompiledSubAgent(
    name="custom-workflow",
    description="æ‰§è¡Œå¤æ‚çš„å¤šæ­¥éª¤å·¥ä½œæµ",
    runnable=custom_graph
)

agent = create_deep_agent(
    subagents=[custom_subagent]
)</code></pre>
                    </div>

                    <h3 class="subsection-subtitle">Q5: ä¸­é—´ä»¶ä¼šå½±å“æ€§èƒ½å—ï¼Ÿ</h3>
                    <p>
                        <strong>ç•¥æœ‰å½±å“</strong>ï¼Œä½†é€šå¸¸åˆ©å¤§äºå¼Šï¼š
                    </p>
                    <ul>
                        <li><strong>å·¥å…·æ•°é‡</strong>ï¼šæ¯ä¸ªä¸­é—´ä»¶å¢åŠ å‡ ä¸ªå·¥å…·ï¼Œæ¨¡å‹é€‰æ‹©æ—¶é—´ç•¥å¢</li>
                        <li><strong>ä¸Šä¸‹æ–‡ç®¡ç†</strong>ï¼šFilesystemMiddleware å‡å°‘ä¸Šä¸‹æ–‡æ±¡æŸ“ï¼Œæ•´ä½“æ€§èƒ½æå‡</li>
                        <li><strong>ä»»åŠ¡å§”æ´¾</strong>ï¼šSubAgent éš”ç¦»ä¸Šä¸‹æ–‡ï¼Œå‡å°‘ä¸» Agent è´Ÿæ‹…</li>
                        <li><strong>å»ºè®®</strong>ï¼šä»…æ·»åŠ å¿…éœ€çš„ä¸­é—´ä»¶ï¼Œé¿å…è¿‡åº¦é…ç½®</li>
                    </ul>

                    <h3 class="subsection-subtitle">Q6: å¦‚ä½•è°ƒè¯•ä¸­é—´ä»¶è¡Œä¸ºï¼Ÿ</h3>
                    <p>
                        ä½¿ç”¨ <strong>LangSmith è¿½è¸ª</strong>æŸ¥çœ‹ä¸­é—´ä»¶å·¥å…·è°ƒç”¨ï¼š
                    </p>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">import os

# å¯ç”¨ LangSmith è¿½è¸ª
os.environ["LANGCHAIN_TRACING_V2"] = "true"
os.environ["LANGCHAIN_API_KEY"] = "your-api-key"

# æ‰€æœ‰ä¸­é—´ä»¶å·¥å…·è°ƒç”¨ä¼šè¢«è®°å½•
result = agent.invoke({...})

# åœ¨ LangSmith UI ä¸­æŸ¥çœ‹ï¼š
# - write_todos è°ƒç”¨
# - write_file / read_file è°ƒç”¨
# - task å­ä»£ç†è°ƒç”¨
# - æ¯ä¸ªå·¥å…·çš„è¾“å…¥è¾“å‡º</code></pre>
                    </div>
                </section>

                <!-- å‚è€ƒèµ„æº -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ“– å‚è€ƒèµ„æº</h2>
                    <ul>
                        <li>
                            <a href="https://docs.langchain.com/oss/python/deepagents/middleware" target="_blank">
                                DeepAgents Middleware å®˜æ–¹æ–‡æ¡£
                            </a>
                        </li>
                        <li>
                            <a href="07-middleware.html">
                                ä¸­é—´ä»¶ç³»ç»Ÿ - LangChain åŸºç¡€ä¸­é—´ä»¶
                            </a>
                        </li>
                        <li>
                            <a href="38-deepagents-harness.html">
                                Harness ç³»ç»Ÿ - å·¥å…·è¯¦è§£
                            </a>
                        </li>
                        <li>
                            <a href="38-deepagents-subagents.html">
                                å­ä»£ç† - SubAgent è¯¦è§£
                            </a>
                        </li>
                        <li>
                            <a href="38-deepagents-memory.html">
                                é•¿æœŸè®°å¿† - Store ç³»ç»Ÿ
                            </a>
                        </li>
                        <li>
                            <a href="38-deepagents-quickstart.html">
                                DeepAgents å¿«é€Ÿå¼€å§‹
                            </a>
                        </li>
                    </ul>
                </section>

                <!-- é¡µé¢å¯¼èˆª -->
                                <nav class="page-navigation">
                    <a href="30-deepagents-memory.html" class="nav-button prev">
                        â† ä¸Šä¸€é¡µ:é•¿æœŸè®°å¿†
                    </a>
                    <a href="32-multi-agent-index.html" class="nav-button next">
                        ä¸‹ä¸€é¡µ:æ¦‚è¿° â†’
                    </a>
                </nav>
            </div>
        </main>
    </div>

    <!-- è¿”å›é¡¶éƒ¨æŒ‰é’® -->
    <button class="back-to-top" aria-label="è¿”å›é¡¶éƒ¨">â†‘</button>

    <!-- JavaScript -->
    <script src="assets/js/mermaid-init.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
</body>
</html>
