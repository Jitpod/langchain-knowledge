<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="LangChain 1.0 æ ¸å¿ƒæ¶æ„ - æ·±å…¥ç†è§£ LangChain çš„è®¾è®¡å“²å­¦å’Œæ¨¡å—ç»„ç»‡">
    <title>æ ¸å¿ƒæ¶æ„ | LangChain 1.0 Python çŸ¥è¯†æ–‡æ¡£</title>
    <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
    <button class="mobile-menu-button" aria-label="æ‰“å¼€èœå•">â˜°</button>

    <div class="container">
        <!-- ä¾§è¾¹æ å¯¼èˆª -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <h1 class="sidebar-title">ğŸ¦œ LangChain 1.0</h1>
                <p class="sidebar-subtitle">Python å®Œæ•´å­¦ä¹ æŒ‡å—</p>
            </div>

            <ul class="nav-menu">
                <li class="nav-section">
                    <div class="nav-section-title">å¼€å§‹</div>
                    <ul>
                        <li class="nav-item">
                            <a href="index.html" class="nav-link">
                                <span class="nav-icon">ğŸ </span>
                                ä¸»é¡µ
                            </a>
                        </li>
                    </ul>
                </li>

                <li class="nav-section">
                    <div class="nav-section-title">åŸºç¡€ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="01-introduction.html" class="nav-link">
                                <span class="nav-icon">ğŸ“–</span>
                                LangChain ç®€ä»‹
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="02-architecture.html" class="nav-link">
                                <span class="nav-icon">ğŸ—ï¸</span>
                                æ ¸å¿ƒæ¶æ„
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="03-models.html" class="nav-link">
                                <span class="nav-icon">ğŸ¤–</span>
                                æ¨¡å‹æ¥å£
                            </a>
                        </li>
                        <li class="nav-item active">
                            <a href="04-messages.html" class="nav-link">
                                <span class="nav-icon">ğŸ’¬</span>
                                æ¶ˆæ¯ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="05-tools.html" class="nav-link">
                                <span class="nav-icon">ğŸ”§</span>
                                å·¥å…·ç³»ç»Ÿ
                            </a>
                        </li>
                    </ul>
                </li>

                <li class="nav-section">
                    <div class="nav-section-title">è¿›é˜¶ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="06-agents.html" class="nav-link">
                                <span class="nav-icon">ğŸ¯</span>
                                Agent åŸºç¡€
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="07-middleware.html" class="nav-link">
                                <span class="nav-icon">âš™ï¸</span>
                                ä¸­é—´ä»¶ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="08-rag.html" class="nav-link">
                                <span class="nav-icon">ğŸ”</span>
                                RAG è¯¦è§£
                                <span class="nav-badge">é‡ç‚¹</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="09-lcel.html" class="nav-link">
                                <span class="nav-icon">ğŸ”—</span>
                                LCEL è¡¨è¾¾å¼
                            </a>
                        </li>
                    </ul>
                </li>

                                <li class="nav-section">
                    <div class="nav-section-title">é«˜çº§åº”ç”¨</div>
                    <ul>
                        <li class="nav-item">
                            <a href="10-runtime.html" class="nav-link">
                                <span class="nav-icon">ğŸ”Œ</span>
                                Runtime ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="11-checkpointer.html" class="nav-link">
                                <span class="nav-icon">ğŸ’¾</span>
                                æŒä¹…åŒ–ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="12-streaming.html" class="nav-link">
                                <span class="nav-icon">ğŸŒŠ</span>
                                æµå¼è¾“å‡º
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="13-human-in-loop.html" class="nav-link">
                                <span class="nav-icon">ğŸ‘¤</span>
                                äººå·¥ä»‹å…¥
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="14-long-term-memory.html" class="nav-link">
                                <span class="nav-icon">ğŸ—„ï¸</span>
                                é•¿æœŸè®°å¿†
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="15-langgraph.html" class="nav-link">
                                <span class="nav-icon">ğŸ“Š</span>
                                LangGraph
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="16-context-engineering.html" class="nav-link">
                                <span class="nav-icon">ğŸ¯</span>
                                ä¸Šä¸‹æ–‡å·¥ç¨‹
                                <span class="nav-badge">é‡ç‚¹</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="17-mcp.html" class="nav-link">
                                <span class="nav-icon">ğŸ”Œ</span>
                                MCP åè®®
                            </a>
                        </li>
                    </ul>
                </li>


                                <li class="nav-section">
                    <div class="nav-section-title">å®æˆ˜ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="18-customer-service.html" class="nav-link">
                                <span class="nav-icon">ğŸ‘¥</span>
                                å®¢æœæœºå™¨äºº
                                <span class="nav-badge">é‡ç‚¹</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="19-best-practices.html" class="nav-link">
                                <span class="nav-icon">âœ¨</span>
                                æœ€ä½³å®è·µ
                            </a>
                        </li>
                    </ul>
                </li>


                                <li class="nav-section">
                    <div class="nav-section-title">å‚è€ƒç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="20-api-reference.html" class="nav-link">
                                <span class="nav-icon">ğŸ“š</span>
                                API é€ŸæŸ¥è¡¨
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="21-troubleshooting.html" class="nav-link">
                                <span class="nav-icon">ğŸ›</span>
                                æ•…éšœæ’é™¤
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="22-migration.html" class="nav-link">
                                <span class="nav-icon">ğŸ”„</span>
                                è¿ç§»æŒ‡å—
                            </a>
                        </li>
                    </ul>
                </li>


                                <li class="nav-section">
                    <div class="nav-section-title">æ‰©å±•ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="23-structured-output.html" class="nav-link">
                                <span class="nav-icon">ğŸ“Š</span>
                                ç»“æ„åŒ–è¾“å‡º
                            </a>
                        </li>
                    </ul>
                </li>


                                <li class="nav-section">
                    <div class="nav-section-title">DeepAgents ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="24-deepagents-quickstart.html" class="nav-link">
                                <span class="nav-icon">ğŸš€</span>
                                å¿«é€Ÿå¼€å§‹
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="25-deepagents-customization.html" class="nav-link">
                                <span class="nav-icon">ğŸ¨</span>
                                å®šåˆ¶åŒ–
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="26-deepagents-harness.html" class="nav-link">
                                <span class="nav-icon">ğŸ›ï¸</span>
                                Harness ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="27-deepagents-backends.html" class="nav-link">
                                <span class="nav-icon">ğŸ”§</span>
                                åç«¯é…ç½®
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="28-deepagents-subagents.html" class="nav-link">
                                <span class="nav-icon">ğŸ‘¥</span>
                                å­ä»£ç†
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="29-deepagents-hitl.html" class="nav-link">
                                <span class="nav-icon">ğŸ¤</span>
                                äººå·¥ä»‹å…¥
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="30-deepagents-memory.html" class="nav-link">
                                <span class="nav-icon">ğŸ§ </span>
                                é•¿æœŸè®°å¿†
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="31-deepagents-middleware.html" class="nav-link">
                                <span class="nav-icon">âš™ï¸</span>
                                ä¸­é—´ä»¶
                            </a>
                        </li>
                    </ul>
                </li>


                                <li class="nav-section">
                    <div class="nav-section-title">Multi-Agent ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="32-multi-agent-index.html" class="nav-link">
                                <span class="nav-icon">ğŸŒ</span>
                                æ¦‚è¿°
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="33-multi-agent-subagents.html" class="nav-link">
                                <span class="nav-icon">ğŸ‘¥</span>
                                å­ä»£ç†
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="34-multi-agent-handoffs.html" class="nav-link">
                                <span class="nav-icon">ğŸ”„</span>
                                äº¤æ¥æœºåˆ¶
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="35-multi-agent-skills.html" class="nav-link">
                                <span class="nav-icon">ğŸ¯</span>
                                æŠ€èƒ½ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="36-multi-agent-router.html" class="nav-link">
                                <span class="nav-icon">ğŸ§­</span>
                                è·¯ç”±æœºåˆ¶
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="37-multi-agent-workflow.html" class="nav-link">
                                <span class="nav-icon">ğŸ”€</span>
                                è‡ªå®šä¹‰å·¥ä½œæµ
                            </a>
                        </li>
                    </ul>
                </li>
            </ul>
        </nav>

        <!-- ä¸»å†…å®¹åŒºåŸŸ -->
        <!-- ä¸»å†…å®¹åŒºåŸŸ -->
        <main class="main-content">
            <div class="content-wrapper">
                <!-- é¢åŒ…å±‘å¯¼èˆª -->
                <nav class="breadcrumb">
                    <span class="breadcrumb-item">
                        <a href="index.html" class="breadcrumb-link">ä¸»é¡µ</a>
                    </span>
                    <span class="breadcrumb-item">
                        åŸºç¡€ç¯‡
                    </span>
                    <span class="breadcrumb-item">
                        æ¶ˆæ¯ç³»ç»Ÿ
                    </span>
                </nav>

                <!-- é¡µé¢æ ‡é¢˜ -->
                <header class="page-header">
                    <h1 class="page-title">ğŸ’¬ æ¶ˆæ¯ç³»ç»Ÿè¯¦è§£</h1>
                    <p class="page-subtitle">
                        æŒæ¡ LangChain 1.0 çš„æ¶ˆæ¯ç±»å‹å’Œ content_blocks ç»Ÿä¸€å±æ€§ï¼Œ
                        å®ç°è·¨æä¾›å•†çš„æ ‡å‡†åŒ–å†…å®¹å¤„ç†å’Œå¤šæ¨¡æ€è¾“å…¥ã€‚
                    </p>
                </header>

                <!-- ä»€ä¹ˆæ˜¯æ¶ˆæ¯ç³»ç»Ÿ -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ“š ä»€ä¹ˆæ˜¯æ¶ˆæ¯ç³»ç»Ÿï¼Ÿ</h2>
                    <p>
                        <strong>æ¶ˆæ¯ï¼ˆMessagesï¼‰</strong>æ˜¯ LangChain ä¸­æ¨¡å‹ä¸ç”¨æˆ·ã€å·¥å…·ä¹‹é—´äº¤äº’çš„åŸºæœ¬å•ä½ã€‚
                        LangChain 1.0 æä¾›äº†æ ‡å‡†åŒ–çš„æ¶ˆæ¯ç³»ç»Ÿï¼Œè®©ä½ èƒ½å¤Ÿï¼š
                    </p>
                    <ul>
                        <li><strong>ç»Ÿä¸€æ¥å£</strong>ï¼šä½¿ç”¨ä¸€è‡´çš„æ¶ˆæ¯æ ¼å¼ä¸æ‰€æœ‰æ¨¡å‹äº¤äº’</li>
                        <li><strong>ç±»å‹å®‰å…¨</strong>ï¼šæ¸…æ™°çš„æ¶ˆæ¯ç±»å‹åŒºåˆ†ï¼ˆç³»ç»Ÿã€ç”¨æˆ·ã€AIã€å·¥å…·ï¼‰</li>
                        <li><strong>å¤šæ¨¡æ€æ”¯æŒ</strong>ï¼šæ–‡æœ¬ã€å›¾åƒã€éŸ³é¢‘ã€è§†é¢‘ã€æ–‡ä»¶ç­‰å¤šç§å†…å®¹</li>
                        <li><strong>è·¨æä¾›å•†æ ‡å‡†åŒ–</strong>ï¼šè‡ªåŠ¨å°†æä¾›å•†ç‰¹å®šæ ¼å¼è½¬æ¢ä¸ºç»Ÿä¸€æ ¼å¼</li>
                    </ul>

                    <div class="info-box note">
                        <div class="info-box-title">ğŸ’¡ æ ¸å¿ƒä¼˜åŠ¿</div>
                        <p>
                            é€šè¿‡ <code>content_blocks</code> å±æ€§ï¼ŒLangChain 1.0 å°†ä¸åŒæä¾›å•†çš„å“åº”æ ¼å¼
                            ï¼ˆå¦‚ OpenAI çš„ reasoningã€Anthropic çš„ thinkingï¼‰ç»Ÿä¸€è½¬æ¢ä¸ºæ ‡å‡†åŒ–çš„å†…å®¹å—ï¼Œ
                            è®©ä½ çš„ä»£ç æ— éœ€ä¿®æ”¹å³å¯åˆ‡æ¢ä¸åŒæ¨¡å‹ã€‚
                        </p>
                    </div>
                </section>

                <!-- å››ç§æ ¸å¿ƒæ¶ˆæ¯ç±»å‹ -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ”¤ å››ç§æ ¸å¿ƒæ¶ˆæ¯ç±»å‹</h2>

                    <div class="mermaid-wrapper">
                        <div class="mermaid">
graph LR
    A[å¯¹è¯æµç¨‹] --> B[SystemMessage]
    B --> C[HumanMessage]
    C --> D[AIMessage]
    D --> E{éœ€è¦å·¥å…·ï¼Ÿ}

    E -->|æ˜¯| F[ToolMessage]
    F --> C

    E -->|å¦| G[å®Œæˆ]

    style B fill:#6366f1,color:#fff
    style C fill:#10b981,color:#fff
    style D fill:#f59e0b,color:#fff
    style F fill:#8b5cf6,color:#fff
    style G fill:#3b82f6,color:#fff
                        </div>
                    </div>

                    <h3 class="subsection-title">1. SystemMessage - ç³»ç»Ÿæ¶ˆæ¯</h3>
                    <p>
                        è®¾ç½®æ¨¡å‹è¡Œä¸ºçš„åˆå§‹æŒ‡ä»¤ï¼Œå®šä¹‰ Agent è§’è‰²ã€å“åº”é£æ ¼å’Œå·¥ä½œæ–¹å¼ã€‚
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty basic">ğŸŸ¢ åŸºç¡€</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
SystemMessage ç¤ºä¾‹
åŠŸèƒ½ï¼šè®¾ç½®æ¨¡å‹çš„åŸºæœ¬è¡Œä¸ºå’Œè§’è‰²
"""
from langchain.messages import SystemMessage

# åˆ›å»ºç³»ç»Ÿæ¶ˆæ¯
system_msg = SystemMessage("ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„ Python ç¼–ç¨‹åŠ©æ‰‹ã€‚")

# æˆ–è€…ä½¿ç”¨å­—å…¸æ ¼å¼
system_msg = {"role": "system", "content": "ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„ Python ç¼–ç¨‹åŠ©æ‰‹ã€‚"}</code></pre>
                    </div>

                    <h3 class="subsection-title">2. HumanMessage - ç”¨æˆ·æ¶ˆæ¯</h3>
                    <p>
                        ä»£è¡¨ç”¨æˆ·è¾“å…¥ï¼Œæ”¯æŒæ–‡æœ¬ã€å›¾åƒã€éŸ³é¢‘ç­‰å¤šæ¨¡æ€å†…å®¹ã€‚
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty basic">ğŸŸ¢ åŸºç¡€</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
HumanMessage ç¤ºä¾‹
"""
from langchain.messages import HumanMessage

# çº¯æ–‡æœ¬æ¶ˆæ¯
human_msg = HumanMessage("ä½ å¥½ï¼Œè¯·å¸®æˆ‘è§£å†³ä¸€ä¸ªé—®é¢˜ã€‚")

# å¸¦å…ƒæ•°æ®çš„æ¶ˆæ¯
human_msg = HumanMessage(
    content="ä½ å¥½ï¼",
    name="alice",      # ç”¨æˆ·æ ‡è¯†ï¼ˆå¯é€‰ï¼‰
    id="msg_123",      # è¿½è¸ªç”¨çš„å”¯ä¸€ IDï¼ˆå¯é€‰ï¼‰
)

# æˆ–ä½¿ç”¨å­—å…¸æ ¼å¼
human_msg = {"role": "user", "content": "ä½ å¥½ï¼"}</code></pre>
                    </div>

                    <h3 class="subsection-title">3. AIMessage - AI æ¶ˆæ¯</h3>
                    <p>
                        æ¨¡å‹çš„è¾“å‡ºå¯¹è±¡ï¼ŒåŒ…å«æ–‡æœ¬å†…å®¹ã€å·¥å…·è°ƒç”¨å’Œå…ƒæ•°æ®ã€‚
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty intermediate">ğŸŸ¡ ä¸­çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
AIMessage ç¤ºä¾‹
åŠŸèƒ½ï¼šç†è§£ AI å“åº”çš„ç»“æ„
"""
from langchain.chat_models import init_chat_model

model = init_chat_model("gpt-4o")

# è°ƒç”¨æ¨¡å‹ä¼šè¿”å› AIMessage å¯¹è±¡
response = model.invoke("ä»€ä¹ˆæ˜¯ LangChainï¼Ÿ")

# AIMessage çš„å…³é”®å±æ€§
print(f"æ–‡æœ¬å†…å®¹: {response.content}")
print(f"çº¯æ–‡æœ¬: {response.text}")
print(f"å·¥å…·è°ƒç”¨: {response.tool_calls}")
print(f"Token ä½¿ç”¨: {response.usage_metadata}")
print(f"å“åº”å…ƒæ•°æ®: {response.response_metadata}")

# æ‰‹åŠ¨åˆ›å»º AIMessageï¼ˆç”¨äºæ¨¡æ‹Ÿå¯¹è¯å†å²ï¼‰
from langchain.messages import AIMessage

ai_msg = AIMessage("æˆ‘å¾ˆä¹æ„å¸®åŠ©ä½ ï¼")
messages = [
    {"role": "user", "content": "ä½ èƒ½å¸®æˆ‘å—ï¼Ÿ"},
    ai_msg,  # æ’å…¥ä¸ºæ¥è‡ªæ¨¡å‹çš„æ¶ˆæ¯
    {"role": "user", "content": "å¤ªå¥½äº†ï¼2+2 ç­‰äºå¤šå°‘ï¼Ÿ"}
]

response = model.invoke(messages)
print(response.content)  # è¾“å‡ºï¼š2+2 ç­‰äº 4ã€‚</code></pre>
                    </div>

                    <h3 class="subsection-title">4. ToolMessage - å·¥å…·æ¶ˆæ¯</h3>
                    <p>
                        å·¥å…·æ‰§è¡Œç»“æœçš„æ¶ˆæ¯ï¼Œç”¨äºå°†å·¥å…·è¾“å‡ºä¼ å›æ¨¡å‹ã€‚
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty advanced">ğŸ”´ é«˜çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
ToolMessage å®Œæ•´æµç¨‹ç¤ºä¾‹
åŠŸèƒ½ï¼šå±•ç¤ºå·¥å…·è°ƒç”¨ â†’ æ‰§è¡Œ â†’ è¿”å›ç»“æœçš„å®Œæ•´å¾ªç¯
"""
from langchain.chat_models import init_chat_model
from langchain.messages import AIMessage, ToolMessage, HumanMessage
from langchain.tools import tool

@tool
def get_weather(location: str) -> str:
    """è·å–å¤©æ°”ä¿¡æ¯"""
    return f"{location} ä»Šå¤©æ™´æœ—ï¼Œ22Â°C"

model = init_chat_model("gpt-4o")
model_with_tools = model.bind_tools([get_weather])

# ç¬¬ 1 æ­¥ï¼šç”¨æˆ·æé—®
messages = [HumanMessage("æ—§é‡‘å±±ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ")]

# ç¬¬ 2 æ­¥ï¼šæ¨¡å‹ç”Ÿæˆå·¥å…·è°ƒç”¨
ai_message = model_with_tools.invoke(messages)
messages.append(ai_message)

# ç¬¬ 3 æ­¥ï¼šæ‰§è¡Œå·¥å…·å¹¶åˆ›å»º ToolMessage
for tool_call in ai_message.tool_calls:
    # æ‰§è¡Œå·¥å…·
    result = get_weather.invoke(tool_call["args"])

    # åˆ›å»º ToolMessage
    tool_message = ToolMessage(
        content=result,
        tool_call_id=tool_call["id"],  # å¿…é¡»ä¸å·¥å…·è°ƒç”¨ ID åŒ¹é…
        name="get_weather"
    )
    messages.append(tool_message)

# ç¬¬ 4 æ­¥ï¼šæ¨¡å‹æ•´åˆç»“æœç”Ÿæˆæœ€ç»ˆç­”æ¡ˆ
final_response = model_with_tools.invoke(messages)
print(final_response.content)</code></pre>
                    </div>

                    <h3 class="subsection-subtitle">æ¶ˆæ¯ç±»å‹å¯¹æ¯”è¡¨</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>æ¶ˆæ¯ç±»å‹</th>
                                <th>ä½œç”¨</th>
                                <th>è°åˆ›å»º</th>
                                <th>å…¸å‹ç”¨é€”</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>SystemMessage</code></td>
                                <td>è®¾ç½®æ¨¡å‹è¡Œä¸º</td>
                                <td>å¼€å‘è€…</td>
                                <td>å®šä¹‰è§’è‰²ã€é£æ ¼ã€è§„åˆ™</td>
                            </tr>
                            <tr>
                                <td><code>HumanMessage</code></td>
                                <td>ç”¨æˆ·è¾“å…¥</td>
                                <td>ç”¨æˆ·/å¼€å‘è€…</td>
                                <td>æé—®ã€æŒ‡ä»¤ã€å¤šæ¨¡æ€è¾“å…¥</td>
                            </tr>
                            <tr>
                                <td><code>AIMessage</code></td>
                                <td>æ¨¡å‹è¾“å‡º</td>
                                <td>æ¨¡å‹</td>
                                <td>å›ç­”ã€å·¥å…·è°ƒç”¨</td>
                            </tr>
                            <tr>
                                <td><code>ToolMessage</code></td>
                                <td>å·¥å…·æ‰§è¡Œç»“æœ</td>
                                <td>å¼€å‘è€…/ç³»ç»Ÿ</td>
                                <td>è¿”å›å·¥å…·è°ƒç”¨ç»“æœ</td>
                            </tr>
                        </tbody>
                    </table>
                </section>

                <!-- content_blocks ç»Ÿä¸€å±æ€§ -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ§© content_blocks ç»Ÿä¸€å±æ€§</h2>
                    <p>
                        <code>content_blocks</code> æ˜¯ LangChain 1.0 çš„æ ¸å¿ƒåˆ›æ–°ï¼Œå®ƒå°†ä¸åŒæä¾›å•†çš„ç‰¹å®šæ ¼å¼
                        è‡ªåŠ¨è§£æä¸ºæ ‡å‡†åŒ–ã€ç±»å‹å®‰å…¨çš„å†…å®¹å—ã€‚
                    </p>

                    <div class="info-box note">
                        <div class="info-box-title">ğŸ’¡ ä¸ºä»€ä¹ˆéœ€è¦ content_blocksï¼Ÿ</div>
                        <p>
                            ä¸åŒ LLM æä¾›å•†ä½¿ç”¨ä¸åŒçš„å“åº”æ ¼å¼ï¼š
                        </p>
                        <ul>
                            <li><strong>OpenAI</strong>ï¼šä½¿ç”¨ <code>reasoning</code> å­—æ®µè¡¨ç¤ºæ¨ç†æ­¥éª¤</li>
                            <li><strong>Anthropic</strong>ï¼šä½¿ç”¨ <code>thinking</code> å­—æ®µ</li>
                            <li><strong>Google</strong>ï¼šå¯èƒ½ä½¿ç”¨å…¶ä»–æ ¼å¼</li>
                        </ul>
                        <p>
                            <code>content_blocks</code> å°†è¿™äº›æä¾›å•†ç‰¹å®šçš„æ ¼å¼ç»Ÿä¸€è½¬æ¢ä¸º LangChain çš„æ ‡å‡†å—ç±»å‹ï¼Œ
                            è®©ä½ çš„ä»£ç æ— éœ€ä¿®æ”¹å³å¯åˆ‡æ¢æ¨¡å‹ã€‚
                        </p>
                    </div>

                    <h3 class="subsection-title">æ ‡å‡†å†…å®¹å—ç±»å‹</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>ç±»åˆ«</th>
                                <th>å—ç±»å‹</th>
                                <th>è¯´æ˜</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td rowspan="3"><strong>æ–‡æœ¬</strong></td>
                                <td><code>TextContentBlock</code></td>
                                <td>æ ‡å‡†æ–‡æœ¬è¾“å‡º</td>
                            </tr>
                            <tr>
                                <td><code>ReasoningContentBlock</code></td>
                                <td>æ¨¡å‹æ¨ç†æ­¥éª¤ï¼ˆç»Ÿä¸€ OpenAI/Anthropicï¼‰</td>
                            </tr>
                            <tr>
                                <td><code>PlainTextContentBlock</code></td>
                                <td>æ–‡æ¡£æ–‡æœ¬ï¼ˆ.txtã€.mdï¼‰</td>
                            </tr>
                            <tr>
                                <td rowspan="4"><strong>å¤šæ¨¡æ€</strong></td>
                                <td><code>ImageContentBlock</code></td>
                                <td>å›¾åƒï¼ˆURLã€Base64ã€æ–‡ä»¶ IDï¼‰</td>
                            </tr>
                            <tr>
                                <td><code>AudioContentBlock</code></td>
                                <td>éŸ³é¢‘æ•°æ®</td>
                            </tr>
                            <tr>
                                <td><code>VideoContentBlock</code></td>
                                <td>è§†é¢‘æ•°æ®</td>
                            </tr>
                            <tr>
                                <td><code>FileContentBlock</code></td>
                                <td>é€šç”¨æ–‡ä»¶ï¼ˆPDF ç­‰ï¼‰</td>
                            </tr>
                            <tr>
                                <td rowspan="3"><strong>å·¥å…·</strong></td>
                                <td><code>ToolCall</code></td>
                                <td>å‡½æ•°è°ƒç”¨</td>
                            </tr>
                            <tr>
                                <td><code>ToolCallChunk</code></td>
                                <td>æµå¼å·¥å…·è°ƒç”¨ç‰‡æ®µ</td>
                            </tr>
                            <tr>
                                <td><code>InvalidToolCall</code></td>
                                <td>æ ¼å¼é”™è¯¯çš„è°ƒç”¨</td>
                            </tr>
                            <tr>
                                <td rowspan="2"><strong>æœåŠ¡ç«¯</strong></td>
                                <td><code>ServerToolCall</code></td>
                                <td>æœåŠ¡ç«¯æ‰§è¡Œçš„å·¥å…·è°ƒç”¨</td>
                            </tr>
                            <tr>
                                <td><code>ServerToolResult</code></td>
                                <td>æœç´¢ç»“æœ</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3 class="subsection-title">è·¨æä¾›å•†æ ‡å‡†åŒ–ç¤ºä¾‹</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty intermediate">ğŸŸ¡ ä¸­çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
content_blocks è·¨æä¾›å•†æ ‡å‡†åŒ–ç¤ºä¾‹
åŠŸèƒ½ï¼šå±•ç¤ºä¸åŒæä¾›å•†çš„å“åº”å¦‚ä½•ç»Ÿä¸€å¤„ç†
"""
from langchain.messages import AIMessage

# Anthropic çš„å“åº”æ ¼å¼
anthropic_message = AIMessage(
    content=[
        {"type": "thinking", "thinking": "è®©æˆ‘æ€è€ƒä¸€ä¸‹...", "signature": "xyz"},
        {"type": "text", "text": "è¿™æ˜¯æˆ‘çš„ç­”æ¡ˆ"},
    ],
    response_metadata={"model_provider": "anthropic"}
)

# OpenAI çš„å“åº”æ ¼å¼
openai_message = AIMessage(
    content=[
        {
            "type": "reasoning",
            "id": "rs_123",
            "summary": [{"type": "summary_text", "text": "æ¨ç†è¿‡ç¨‹..."}],
        },
        {"type": "text", "text": "è¿™æ˜¯æˆ‘çš„ç­”æ¡ˆ"},
    ],
    response_metadata={"model_provider": "openai"}
)

# ç»Ÿä¸€è®¿é—®å†…å®¹å—ï¼ˆè‡ªåŠ¨è§£æä¸ºæ ‡å‡†æ ¼å¼ï¼‰
for block in anthropic_message.content_blocks:
    if block["type"] == "reasoning":  # è‡ªåŠ¨æ ‡å‡†åŒ–ä¸º "reasoning"
        print(f"æ¨ç†: {block['content']}")
    elif block["type"] == "text":
        print(f"æ–‡æœ¬: {block['text']}")

# ä¸¤ç§æä¾›å•†çš„å¤„ç†ä»£ç å®Œå…¨ç›¸åŒï¼
for block in openai_message.content_blocks:
    if block["type"] == "reasoning":
        print(f"æ¨ç†: {block['content']}")
    elif block["type"] == "text":
        print(f"æ–‡æœ¬: {block['text']}")</code></pre>
                    </div>
                </section>

                <!-- å¤šæ¨¡æ€æ¶ˆæ¯ -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ–¼ï¸ å¤šæ¨¡æ€æ¶ˆæ¯</h2>
                    <p>
                        LangChain æ”¯æŒåœ¨æ¶ˆæ¯ä¸­åŒ…å«å›¾åƒã€éŸ³é¢‘ã€è§†é¢‘ç­‰å¤šç§å†…å®¹ç±»å‹ã€‚
                    </p>

                    <h3 class="subsection-title">å›¾åƒè¾“å…¥</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty intermediate">ğŸŸ¡ ä¸­çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
å¤šæ¨¡æ€æ¶ˆæ¯ç¤ºä¾‹ - å›¾åƒè¾“å…¥
åŠŸèƒ½ï¼šè®©æ¨¡å‹å¤„ç†å›¾åƒå†…å®¹
"""
from langchain.messages import HumanMessage
from langchain.chat_models import init_chat_model

model = init_chat_model("gpt-4o")  # éœ€è¦æ”¯æŒè§†è§‰çš„æ¨¡å‹

# æ–¹å¼ 1ï¼šä½¿ç”¨å›¾åƒ URL
message = HumanMessage(content=[
    {"type": "text", "text": "æè¿°è¿™å¼ å›¾ç‰‡çš„å†…å®¹ã€‚"},
    {"type": "image", "url": "https://example.com/image.jpg"},
])

response = model.invoke([message])
print(response.content)

# æ–¹å¼ 2ï¼šä½¿ç”¨ Base64 ç¼–ç çš„å›¾åƒ
import base64

with open("local_image.jpg", "rb") as image_file:
    base64_image = base64.b64encode(image_file.read()).decode('utf-8')

message = HumanMessage(content=[
    {"type": "text", "text": "è¿™å¼ å›¾ç‰‡é‡Œæœ‰ä»€ä¹ˆï¼Ÿ"},
    {
        "type": "image",
        "base64": base64_image,
        "mime_type": "image/jpeg",
    },
])

response = model.invoke([message])
print(response.content)</code></pre>
                    </div>

                    <div class="info-box warning">
                        <div class="info-box-title">âš ï¸ é‡è¦æç¤º</div>
                        <p>
                            å¹¶éæ‰€æœ‰æ¨¡å‹éƒ½æ”¯æŒæ‰€æœ‰æ–‡ä»¶ç±»å‹ã€‚ä½¿ç”¨å‰è¯·æ£€æŸ¥æ¨¡å‹æä¾›å•†çš„æ–‡æ¡£ï¼Œ
                            äº†è§£æ”¯æŒçš„æ ¼å¼å’Œå¤§å°é™åˆ¶ã€‚ä¾‹å¦‚ï¼š
                        </p>
                        <ul>
                            <li>GPT-4oã€Claude 3.5 Sonnetï¼šæ”¯æŒå›¾åƒ</li>
                            <li>Gemini 2.0ï¼šæ”¯æŒå›¾åƒã€éŸ³é¢‘ã€è§†é¢‘</li>
                            <li>GPT-4o-miniï¼šä»…æ”¯æŒæ–‡æœ¬</li>
                        </ul>
                    </div>
                </section>

                <!-- æ¶ˆæ¯æµè½¬æµç¨‹ -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ”„ æ¶ˆæ¯æµè½¬æµç¨‹</h2>

                    <div class="mermaid-wrapper">
                        <div class="mermaid">
graph TB
    A[å¼€å§‹å¯¹è¯] --> B[SystemMessage:<br/>è®¾ç½®è§’è‰²å’Œè§„åˆ™]
    B --> C[HumanMessage:<br/>ç”¨æˆ·æé—®]
    C --> D[æ¨¡å‹å¤„ç†]
    D --> E[AIMessage:<br/>æ¨¡å‹å“åº”]

    E --> F{åŒ…å«å·¥å…·è°ƒç”¨ï¼Ÿ}

    F -->|æ˜¯| G[æ‰§è¡Œå·¥å…·å‡½æ•°]
    G --> H[ToolMessage:<br/>å·¥å…·ç»“æœ]
    H --> I[ç»§ç»­å¯¹è¯]
    I --> D

    F -->|å¦| J{ç”¨æˆ·ç»§ç»­æé—®ï¼Ÿ}

    J -->|æ˜¯| K[HumanMessage:<br/>æ–°é—®é¢˜]
    K --> D

    J -->|å¦| L[å¯¹è¯ç»“æŸ]

    style B fill:#6366f1,color:#fff
    style C fill:#10b981,color:#fff
    style E fill:#f59e0b,color:#fff
    style H fill:#8b5cf6,color:#fff
    style L fill:#3b82f6,color:#fff
                        </div>
                    </div>

                    <h3 class="subsection-title">å®Œæ•´å¯¹è¯ç¤ºä¾‹</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty advanced">ğŸ”´ é«˜çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
å®Œæ•´å¤šè½®å¯¹è¯ç¤ºä¾‹
åŠŸèƒ½ï¼šå±•ç¤ºæ¶ˆæ¯åœ¨å®Œæ•´å¯¹è¯ä¸­çš„æµè½¬
"""
from langchain.chat_models import init_chat_model
from langchain.messages import SystemMessage, HumanMessage, AIMessage
from langchain.tools import tool

@tool
def calculate(expression: str) -> str:
    """è®¡ç®—æ•°å­¦è¡¨è¾¾å¼"""
    try:
        result = eval(expression)
        return f"è®¡ç®—ç»“æœï¼š{result}"
    except Exception as e:
        return f"è®¡ç®—é”™è¯¯ï¼š{str(e)}"

# åˆå§‹åŒ–æ¨¡å‹
model = init_chat_model("gpt-4o")
model_with_tools = model.bind_tools([calculate])

# æ„å»ºå¯¹è¯å†å²
messages = [
    SystemMessage("ä½ æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„æ•°å­¦åŠ©æ‰‹ã€‚"),
    HumanMessage("ä½ èƒ½å¸®æˆ‘è®¡ç®—å—ï¼Ÿ"),
]

# ç¬¬ 1 è½®ï¼šæ¨¡å‹ç¡®è®¤
response1 = model_with_tools.invoke(messages)
messages.append(response1)
print(f"åŠ©æ‰‹: {response1.content}\n")

# ç¬¬ 2 è½®ï¼šç”¨æˆ·æå‡ºè®¡ç®—é—®é¢˜
messages.append(HumanMessage("è®¡ç®— (25 + 75) * 2"))
response2 = model_with_tools.invoke(messages)
messages.append(response2)

# å¦‚æœæœ‰å·¥å…·è°ƒç”¨ï¼Œæ‰§è¡Œå·¥å…·
if response2.tool_calls:
    for tool_call in response2.tool_calls:
        result = calculate.invoke(tool_call["args"])
        messages.append(result)

    # ç¬¬ 3 è½®ï¼šæ¨¡å‹æ•´åˆå·¥å…·ç»“æœ
    response3 = model_with_tools.invoke(messages)
    messages.append(response3)
    print(f"åŠ©æ‰‹: {response3.content}\n")

# ç¬¬ 4 è½®ï¼šç”¨æˆ·ç»§ç»­æé—®
messages.append(HumanMessage("å¦‚æœå†é™¤ä»¥ 4 æ˜¯å¤šå°‘ï¼Ÿ"))
response4 = model_with_tools.invoke(messages)
messages.append(response4)

# å¤„ç†å·¥å…·è°ƒç”¨
if response4.tool_calls:
    for tool_call in response4.tool_calls:
        result = calculate.invoke(tool_call["args"])
        messages.append(result)

    response5 = model_with_tools.invoke(messages)
    print(f"åŠ©æ‰‹: {response5.content}")

# æŸ¥çœ‹å®Œæ•´å¯¹è¯å†å²
print(f"\næ€»æ¶ˆæ¯æ•°: {len(messages)}")
for i, msg in enumerate(messages):
    print(f"{i+1}. {msg.__class__.__name__}: {msg.content[:50]}...")</code></pre>
                    </div>
                </section>

                <!-- æµå¼æ¶ˆæ¯å¤„ç† -->
                <section class="content-section">
                    <h2 class="section-title">ğŸŒŠ æµå¼æ¶ˆæ¯å¤„ç†</h2>
                    <p>
                        æµå¼è°ƒç”¨è¿”å› <code>AIMessageChunk</code> å¯¹è±¡ï¼Œå¯ä»¥é€å—ç´¯ç§¯æˆå®Œæ•´æ¶ˆæ¯ã€‚
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty intermediate">ğŸŸ¡ ä¸­çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
æµå¼æ¶ˆæ¯å¤„ç†ç¤ºä¾‹
åŠŸèƒ½ï¼šå®æ—¶æ¥æ”¶å’Œç´¯ç§¯æ¶ˆæ¯å—
"""
from langchain.chat_models import init_chat_model

model = init_chat_model("claude-sonnet-4-5-20250929")

# æµå¼è°ƒç”¨
chunks = []
full_message = None

print("æµå¼è¾“å‡º: ", end="")
for chunk in model.stream("ç”¨ä¸‰å¥è¯è§£é‡Šä»€ä¹ˆæ˜¯é‡å­è®¡ç®—"):
    chunks.append(chunk)
    print(chunk.content, end="", flush=True)

    # ç´¯ç§¯å®Œæ•´æ¶ˆæ¯
    if full_message is None:
        full_message = chunk
    else:
        full_message = full_message + chunk  # AIMessageChunk æ”¯æŒåŠ æ³•è¿ç®—

print("\n")

# æŸ¥çœ‹å®Œæ•´æ¶ˆæ¯å±æ€§
print(f"æ€»å—æ•°: {len(chunks)}")
print(f"å®Œæ•´å†…å®¹: {full_message.content}")
print(f"Token ä½¿ç”¨: {full_message.usage_metadata}")</code></pre>
                    </div>
                </section>

                <!-- å¸¦å…ƒæ•°æ®çš„å·¥å…·æ¶ˆæ¯ -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ“ å¸¦å…ƒæ•°æ®çš„å·¥å…·æ¶ˆæ¯</h2>
                    <p>
                        åœ¨ RAG ç­‰åœºæ™¯ä¸­ï¼Œå¯ä»¥åœ¨ ToolMessage ä¸­é™„åŠ å…ƒæ•°æ®ï¼ˆå¦‚æ–‡æ¡£ IDã€é¡µç ï¼‰ï¼Œ
                        ä¾›åº”ç”¨é€»è¾‘è®¿é—®ï¼Œä½†ä¸å‘é€ç»™æ¨¡å‹ã€‚
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty advanced">ğŸ”´ é«˜çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
å¸¦å…ƒæ•°æ®çš„ ToolMessage ç¤ºä¾‹
åŠŸèƒ½ï¼šåœ¨å·¥å…·ç»“æœä¸­é™„åŠ å…ƒæ•°æ®
"""
from langchain.messages import ToolMessage

# å‘é€ç»™æ¨¡å‹çš„å†…å®¹
message_content = "è¿™æ˜¯æ£€ç´¢åˆ°çš„æ–‡æ¡£å†…å®¹ï¼šLangChain æ˜¯ä¸€ä¸ª..."

# åº”ç”¨å¯è®¿é—®çš„å…ƒæ•°æ®ï¼ˆä¸å‘é€ç»™æ¨¡å‹ï¼‰
artifact = {
    "document_id": "doc_12345",
    "page": 3,
    "relevance_score": 0.95,
    "source_url": "https://docs.langchain.com/..."
}

# åˆ›å»ºå¸¦å…ƒæ•°æ®çš„å·¥å…·æ¶ˆæ¯
tool_message = ToolMessage(
    content=message_content,        # ç»™æ¨¡å‹çœ‹çš„å†…å®¹
    tool_call_id="call_123",
    name="search_documents",
    artifact=artifact               # åº”ç”¨å±‚å…ƒæ•°æ®
)

# åº”ç”¨å¯ä»¥è®¿é—®å…ƒæ•°æ®
print(f"æ–‡æ¡£ ID: {tool_message.artifact['document_id']}")
print(f"æ¥æºé¡µç : {tool_message.artifact['page']}")
print(f"ç›¸å…³åº¦: {tool_message.artifact['relevance_score']}")

# ä½†æ¨¡å‹åªçœ‹åˆ° content éƒ¨åˆ†</code></pre>
                    </div>

                    <div class="info-box tip">
                        <div class="info-box-title">âœ… artifact æœ€ä½³å®è·µ</div>
                        <ul>
                            <li><strong>RAG ç³»ç»Ÿ</strong>ï¼šå­˜å‚¨æ–‡æ¡£æ¥æºã€ç›¸å…³åº¦è¯„åˆ†</li>
                            <li><strong>å®¡è®¡æ—¥å¿—</strong>ï¼šè®°å½•å·¥å…·è°ƒç”¨çš„è¯¦ç»†å‚æ•°</li>
                            <li><strong>è°ƒè¯•ä¿¡æ¯</strong>ï¼šä¿å­˜åŸå§‹ API å“åº”</li>
                            <li><strong>ä¸šåŠ¡é€»è¾‘</strong>ï¼šé™„åŠ è®¢å• IDã€ç”¨æˆ· ID ç­‰ä¸šåŠ¡æ•°æ®</li>
                        </ul>
                    </div>
                </section>

                <!-- å¸¸è§é—®é¢˜ -->
                <section class="content-section">
                    <h2 class="section-title">â“ å¸¸è§é—®é¢˜</h2>

                    <h3 class="subsection-subtitle">Q1: content å’Œ content_blocks æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3>
                    <p>
                        <strong>content</strong>ï¼šåŸå§‹æ¶ˆæ¯å†…å®¹ï¼Œæ ¼å¼å› æä¾›å•†è€Œå¼‚ã€‚<br>
                        <strong>content_blocks</strong>ï¼šæ ‡å‡†åŒ–çš„å†…å®¹å—åˆ—è¡¨ï¼ŒLangChain è‡ªåŠ¨è§£æã€‚
                    </p>
                    <p>
                        content_blocks ä¸æ˜¯ content çš„æ›¿ä»£å“ï¼Œè€Œæ˜¯ä¸€ä¸ªæ–°å±æ€§ï¼Œ
                        ç”¨äºä»¥æ ‡å‡†æ ¼å¼è®¿é—®æ¶ˆæ¯å†…å®¹ã€‚ä¸¤è€…éƒ½å¯ä»¥ä½¿ç”¨ï¼Œä½† content_blocks æä¾›æ›´å¥½çš„è·¨æä¾›å•†å…¼å®¹æ€§ã€‚
                    </p>

                    <h3 class="subsection-subtitle">Q2: ä»€ä¹ˆæ—¶å€™ä½¿ç”¨å­—å…¸æ ¼å¼ï¼Œä»€ä¹ˆæ—¶å€™ä½¿ç”¨æ¶ˆæ¯ç±»ï¼Ÿ</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python"># å­—å…¸æ ¼å¼ - ç®€å•å¿«æ·ï¼Œé€‚åˆç®€å•åœºæ™¯
messages = [
    {"role": "system", "content": "ä½ æ˜¯åŠ©æ‰‹"},
    {"role": "user", "content": "ä½ å¥½"}
]

# æ¶ˆæ¯ç±» - æ›´å¼ºå¤§ï¼Œé€‚åˆå¤æ‚åœºæ™¯
from langchain.messages import SystemMessage, HumanMessage

messages = [
    SystemMessage("ä½ æ˜¯åŠ©æ‰‹"),
    HumanMessage("ä½ å¥½", name="alice", id="msg_001")
]

# å»ºè®®ï¼šç®€å•å¯¹è¯ç”¨å­—å…¸ï¼Œå¤æ‚åº”ç”¨ç”¨æ¶ˆæ¯ç±»</code></pre>
                    </div>

                    <h3 class="subsection-subtitle">Q3: å¦‚ä½•å¤„ç†æ¶ˆæ¯å†å²è¿‡é•¿çš„é—®é¢˜ï¼Ÿ</h3>
                    <p>
                        é•¿å¯¹è¯ä¼šè¶…å‡ºæ¨¡å‹çš„ä¸Šä¸‹æ–‡çª—å£é™åˆ¶ã€‚è§£å†³æ–¹æ¡ˆï¼š
                    </p>
                    <ul>
                        <li><strong>æ¶ˆæ¯ä¿®å‰ª</strong>ï¼šåªä¿ç•™æœ€è¿‘ N æ¡æ¶ˆæ¯</li>
                        <li><strong>æ¶ˆæ¯æ€»ç»“</strong>ï¼šå®šæœŸæ€»ç»“å†å²ï¼Œæ›¿æ¢æ—§æ¶ˆæ¯</li>
                        <li><strong>çŸ­æœŸè®°å¿†ç®¡ç†</strong>ï¼šä½¿ç”¨ LangChain çš„è®°å¿†ç®¡ç†åŠŸèƒ½</li>
                    </ul>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python"># ç®€å•çš„æ¶ˆæ¯ä¿®å‰ª
MAX_MESSAGES = 10

if len(messages) > MAX_MESSAGES:
    # ä¿ç•™ SystemMessage å’Œæœ€è¿‘çš„æ¶ˆæ¯
    system_msgs = [m for m in messages if isinstance(m, SystemMessage)]
    recent_msgs = messages[-MAX_MESSAGES:]
    messages = system_msgs + recent_msgs</code></pre>
                    </div>

                    <h3 class="subsection-subtitle">Q4: AIMessage çš„ text å’Œ content æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3>
                    <p>
                        <code>text</code>ï¼šä»…æå–æ–‡æœ¬å†…å®¹å—çš„æ–‡æœ¬éƒ¨åˆ†ï¼ˆæ¨èä½¿ç”¨ï¼‰<br>
                        <code>content</code>ï¼šåŸå§‹å†…å®¹ï¼Œå¯èƒ½æ˜¯å­—ç¬¦ä¸²æˆ–åˆ—è¡¨
                    </p>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">response = model.invoke("ä½ å¥½")

# textï¼šæ€»æ˜¯è¿”å›å­—ç¬¦ä¸²ï¼ˆçº¯æ–‡æœ¬éƒ¨åˆ†ï¼‰
print(response.text)  # "ä½ å¥½ï¼å¾ˆé«˜å…´è§åˆ°ä½ ã€‚"

# contentï¼šå¯èƒ½æ˜¯å­—ç¬¦ä¸²æˆ–åˆ—è¡¨
print(response.content)  # å¯èƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œä¹Ÿå¯èƒ½æ˜¯ [{"type": "text", ...}]

# å»ºè®®ï¼šéœ€è¦çº¯æ–‡æœ¬æ—¶ä½¿ç”¨ text å±æ€§</code></pre>
                    </div>

                    <h3 class="subsection-subtitle">Q5: å¦‚ä½•å¯ç”¨æ ‡å‡†åŒ–è¾“å‡ºæ ¼å¼ï¼Ÿ</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">from langchain.chat_models import init_chat_model

# å¯ç”¨ v1 æ ‡å‡†åŒ–è¾“å‡º
model = init_chat_model("gpt-4o", output_version="v1")

# æ¶ˆæ¯å†…å®¹å°†ä»¥æ ‡å‡†å†…å®¹å—æ ¼å¼å­˜å‚¨
response = model.invoke("è§£é‡Š AI")
print(response.content_blocks)  # æ ‡å‡†åŒ–çš„å—åˆ—è¡¨</code></pre>
                    </div>
                </section>

                <!-- å‚è€ƒèµ„æº -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ”— å‚è€ƒèµ„æº</h2>
                    <ul>
                        <li>
                            <a href="https://docs.langchain.com/oss/python/langchain/messages" target="_blank">
                                LangChain å®˜æ–¹ Messages æ–‡æ¡£
                            </a>
                        </li>
                        <li>
                            <a href="https://python.langchain.com/docs/concepts/#messages" target="_blank">
                                Messages æ ¸å¿ƒæ¦‚å¿µ
                            </a>
                        </li>
                        <li>
                            <a href="https://reference.langchain.com/python/langchain/messages.html" target="_blank">
                                Messages API å‚è€ƒ
                            </a>
                        </li>
                        <li>
                            <a href="https://docs.langchain.com/oss/python/langchain/short-term-memory" target="_blank">
                                çŸ­æœŸè®°å¿†ç®¡ç†
                            </a>
                        </li>
                    </ul>
                </section>

                <!-- é¡µé¢å¯¼èˆª -->
                                <nav class="page-navigation">
                    <a href="03-models.html" class="nav-button prev">
                        â† ä¸Šä¸€é¡µ:æ¨¡å‹æ¥å£
                    </a>
                    <a href="05-tools.html" class="nav-button next">
                        ä¸‹ä¸€é¡µ:å·¥å…·ç³»ç»Ÿ â†’
                    </a>
                </nav>
            </div>
        </main>
    </div>

    <!-- è¿”å›é¡¶éƒ¨æŒ‰é’® -->
    <button class="back-to-top" aria-label="è¿”å›é¡¶éƒ¨">â†‘</button>

    <!-- JavaScript -->
    <script src="assets/js/mermaid-init.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
</body>
</html>
