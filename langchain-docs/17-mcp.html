<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="LangChain 1.0 Model Context Protocol (MCP) - æ ‡å‡†åŒ– LLM å·¥å…·å’Œä¸Šä¸‹æ–‡æä¾›çš„å¼€æ”¾åè®®">
    <title>Model Context Protocol (MCP) | LangChain 1.0 Python çŸ¥è¯†æ–‡æ¡£</title>
    <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
    <button class="mobile-menu-button" aria-label="æ‰“å¼€èœå•">â˜°</button>

    <div class="container">
        <!-- ä¾§è¾¹æ å¯¼èˆª -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <h1 class="sidebar-title">ğŸ¦œ LangChain 1.0</h1>
                <p class="sidebar-subtitle">Python å®Œæ•´å­¦ä¹ æŒ‡å—</p>
            </div>

            <ul class="nav-menu">
                <li class="nav-section">
                    <div class="nav-section-title">å¼€å§‹</div>
                    <ul>
                        <li class="nav-item">
                            <a href="index.html" class="nav-link">
                                <span class="nav-icon">ğŸ </span>
                                ä¸»é¡µ
                            </a>
                        </li>
                    </ul>
                </li>

                <li class="nav-section">
                    <div class="nav-section-title">åŸºç¡€ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="01-introduction.html" class="nav-link">
                                <span class="nav-icon">ğŸ“–</span>
                                LangChain ç®€ä»‹
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="02-architecture.html" class="nav-link">
                                <span class="nav-icon">ğŸ—ï¸</span>
                                æ ¸å¿ƒæ¶æ„
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="03-models.html" class="nav-link">
                                <span class="nav-icon">ğŸ¤–</span>
                                æ¨¡å‹æ¥å£
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="04-messages.html" class="nav-link">
                                <span class="nav-icon">ğŸ’¬</span>
                                æ¶ˆæ¯ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="05-tools.html" class="nav-link">
                                <span class="nav-icon">ğŸ”§</span>
                                å·¥å…·ç³»ç»Ÿ
                            </a>
                        </li>
                    </ul>
                </li>

                <li class="nav-section">
                    <div class="nav-section-title">è¿›é˜¶ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="06-agents.html" class="nav-link">
                                <span class="nav-icon">ğŸ¯</span>
                                Agent åŸºç¡€
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="07-middleware.html" class="nav-link">
                                <span class="nav-icon">âš™ï¸</span>
                                ä¸­é—´ä»¶ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="08-rag.html" class="nav-link">
                                <span class="nav-icon">ğŸ”</span>
                                RAG è¯¦è§£
                                <span class="nav-badge">é‡ç‚¹</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="09-lcel.html" class="nav-link">
                                <span class="nav-icon">ğŸ”—</span>
                                LCEL è¡¨è¾¾å¼
                            </a>
                        </li>
                    </ul>
                </li>

                                <li class="nav-section">
                    <div class="nav-section-title">é«˜çº§åº”ç”¨</div>
                    <ul>
                        <li class="nav-item">
                            <a href="10-runtime.html" class="nav-link">
                                <span class="nav-icon">ğŸ”Œ</span>
                                Runtime ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="11-checkpointer.html" class="nav-link">
                                <span class="nav-icon">ğŸ’¾</span>
                                æŒä¹…åŒ–ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="12-streaming.html" class="nav-link">
                                <span class="nav-icon">ğŸŒŠ</span>
                                æµå¼è¾“å‡º
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="13-human-in-loop.html" class="nav-link">
                                <span class="nav-icon">ğŸ‘¤</span>
                                äººå·¥ä»‹å…¥
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="14-long-term-memory.html" class="nav-link">
                                <span class="nav-icon">ğŸ—„ï¸</span>
                                é•¿æœŸè®°å¿†
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="15-langgraph.html" class="nav-link">
                                <span class="nav-icon">ğŸ“Š</span>
                                LangGraph
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="16-context-engineering.html" class="nav-link">
                                <span class="nav-icon">ğŸ¯</span>
                                ä¸Šä¸‹æ–‡å·¥ç¨‹
                                <span class="nav-badge">é‡ç‚¹</span>
                            </a>
                        </li>
                        <li class="nav-item active">
                            <a href="17-mcp.html" class="nav-link">
                                <span class="nav-icon">ğŸ”Œ</span>
                                MCP åè®®
                            </a>
                        </li>
                    </ul>
                </li>


                                <li class="nav-section">
                    <div class="nav-section-title">å®æˆ˜ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="18-customer-service.html" class="nav-link">
                                <span class="nav-icon">ğŸ‘¥</span>
                                å®¢æœæœºå™¨äºº
                                <span class="nav-badge">é‡ç‚¹</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="19-best-practices.html" class="nav-link">
                                <span class="nav-icon">âœ¨</span>
                                æœ€ä½³å®è·µ
                            </a>
                        </li>
                    </ul>
                </li>


                                <li class="nav-section">
                    <div class="nav-section-title">å‚è€ƒç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="20-api-reference.html" class="nav-link">
                                <span class="nav-icon">ğŸ“š</span>
                                API é€ŸæŸ¥è¡¨
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="21-troubleshooting.html" class="nav-link">
                                <span class="nav-icon">ğŸ›</span>
                                æ•…éšœæ’é™¤
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="22-migration.html" class="nav-link">
                                <span class="nav-icon">ğŸ”„</span>
                                è¿ç§»æŒ‡å—
                            </a>
                        </li>
                    </ul>
                </li>


                                <li class="nav-section">
                    <div class="nav-section-title">æ‰©å±•ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="23-structured-output.html" class="nav-link">
                                <span class="nav-icon">ğŸ“Š</span>
                                ç»“æ„åŒ–è¾“å‡º
                            </a>
                        </li>
                    </ul>
                </li>


                                <li class="nav-section">
                    <div class="nav-section-title">DeepAgents ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="24-deepagents-quickstart.html" class="nav-link">
                                <span class="nav-icon">ğŸš€</span>
                                å¿«é€Ÿå¼€å§‹
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="25-deepagents-customization.html" class="nav-link">
                                <span class="nav-icon">ğŸ¨</span>
                                å®šåˆ¶åŒ–
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="26-deepagents-harness.html" class="nav-link">
                                <span class="nav-icon">ğŸ›ï¸</span>
                                Harness ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="27-deepagents-backends.html" class="nav-link">
                                <span class="nav-icon">ğŸ”§</span>
                                åç«¯é…ç½®
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="28-deepagents-subagents.html" class="nav-link">
                                <span class="nav-icon">ğŸ‘¥</span>
                                å­ä»£ç†
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="29-deepagents-hitl.html" class="nav-link">
                                <span class="nav-icon">ğŸ¤</span>
                                äººå·¥ä»‹å…¥
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="30-deepagents-memory.html" class="nav-link">
                                <span class="nav-icon">ğŸ§ </span>
                                é•¿æœŸè®°å¿†
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="31-deepagents-middleware.html" class="nav-link">
                                <span class="nav-icon">âš™ï¸</span>
                                ä¸­é—´ä»¶
                            </a>
                        </li>
                    </ul>
                </li>


                                <li class="nav-section">
                    <div class="nav-section-title">Multi-Agent ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="32-multi-agent-index.html" class="nav-link">
                                <span class="nav-icon">ğŸŒ</span>
                                æ¦‚è¿°
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="33-multi-agent-subagents.html" class="nav-link">
                                <span class="nav-icon">ğŸ‘¥</span>
                                å­ä»£ç†
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="34-multi-agent-handoffs.html" class="nav-link">
                                <span class="nav-icon">ğŸ”„</span>
                                äº¤æ¥æœºåˆ¶
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="35-multi-agent-skills.html" class="nav-link">
                                <span class="nav-icon">ğŸ¯</span>
                                æŠ€èƒ½ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="36-multi-agent-router.html" class="nav-link">
                                <span class="nav-icon">ğŸ§­</span>
                                è·¯ç”±æœºåˆ¶
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="37-multi-agent-workflow.html" class="nav-link">
                                <span class="nav-icon">ğŸ”€</span>
                                è‡ªå®šä¹‰å·¥ä½œæµ
                            </a>
                        </li>
                    </ul>
                </li>
            </ul>
        </nav>

        <!-- ä¸»å†…å®¹åŒºåŸŸ -->
        <main class="main-content">
            <div class="content-wrapper">
                <!-- é¢åŒ…å±‘å¯¼èˆª -->
                <nav class="breadcrumb">
                    <span class="breadcrumb-item">
                        <a href="index.html" class="breadcrumb-link">ä¸»é¡µ</a>
                    </span>
                    <span class="breadcrumb-item">
                        é«˜çº§åº”ç”¨
                    </span>
                    <span class="breadcrumb-item">
                        MCP
                    </span>
                </nav>

                <!-- é¡µé¢æ ‡é¢˜ -->
                <header class="page-header">
                    <h1 class="page-title">ğŸ”Œ Model Context Protocol (MCP)</h1>
                    <p class="page-subtitle">
                        æ ‡å‡†åŒ– LLM å·¥å…·å’Œä¸Šä¸‹æ–‡æä¾›çš„å¼€æ”¾åè®®
                    </p>
                </header>

                <!-- æ¦‚è¿° -->
                <section class="content-section">
                    <p>
                        <a href="https://modelcontextprotocol.io/introduction" target="_blank">Model Context Protocol (MCP)</a>
                        æ˜¯ä¸€ä¸ªå¼€æ”¾åè®®ï¼Œç”¨äºæ ‡å‡†åŒ–åº”ç”¨ç¨‹åºå¦‚ä½•å‘ LLM æä¾›å·¥å…·å’Œä¸Šä¸‹æ–‡ã€‚
                        LangChain Agent å¯ä»¥ä½¿ç”¨ MCP æœåŠ¡å™¨ä¸Šå®šä¹‰çš„å·¥å…·ï¼Œé€šè¿‡
                        <a href="https://github.com/langchain-ai/langchain-mcp-adapters" target="_blank"><code>langchain-mcp-adapters</code></a>
                        åº“æ¥å®ç°ã€‚
                    </p>
                </section>

                <!-- Quickstart -->
                <section class="content-section">
                    <h2 class="section-title">å¿«é€Ÿå¼€å§‹</h2>

                    <p>å®‰è£… <code>langchain-mcp-adapters</code> åº“ï¼š</p>

                    <div class="tabs-container">
                        <div class="tabs-header">
                            <button class="tab-button active" data-tab="install-pip">pip</button>
                            <button class="tab-button" data-tab="install-uv">uv</button>
                        </div>

                        <div class="tab-content active" data-tab="install-pip">
                            <div class="code-block-wrapper">
                                <div class="code-block-header">
                                    <span class="code-language">Bash</span>
                                    <span class="code-difficulty basic">ğŸŸ¢ åŸºç¡€</span>
                                    <button class="copy-button">å¤åˆ¶ä»£ç </button>
                                </div>
                                <pre><code class="language-bash">pip install langchain-mcp-adapters</code></pre>
                            </div>
                        </div>

                        <div class="tab-content" data-tab="install-uv">
                            <div class="code-block-wrapper">
                                <div class="code-block-header">
                                    <span class="code-language">Bash</span>
                                    <span class="code-difficulty basic">ğŸŸ¢ åŸºç¡€</span>
                                    <button class="copy-button">å¤åˆ¶ä»£ç </button>
                                </div>
                                <pre><code class="language-bash">uv add langchain-mcp-adapters</code></pre>
                            </div>
                        </div>
                    </div>

                    <p>
                        <code>langchain-mcp-adapters</code> ä½¿ Agent èƒ½å¤Ÿä½¿ç”¨è·¨ä¸€ä¸ªæˆ–å¤šä¸ª MCP æœåŠ¡å™¨å®šä¹‰çš„å·¥å…·ã€‚
                    </p>

                    <div class="info-box note">
                        <div class="info-box-title">âš ï¸ æ³¨æ„</div>
                        <p>
                            <code>MultiServerMCPClient</code> <strong>é»˜è®¤æ˜¯æ— çŠ¶æ€çš„</strong>ã€‚
                            æ¯æ¬¡å·¥å…·è°ƒç”¨éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ MCP <code>ClientSession</code>ï¼Œ
                            æ‰§è¡Œå·¥å…·ï¼Œç„¶åæ¸…ç†ã€‚æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…<a href="#stateful-sessions">æœ‰çŠ¶æ€ä¼šè¯</a>éƒ¨åˆ†ã€‚
                        </p>
                    </div>

                    <h3 class="subsection-title">è®¿é—®å¤šä¸ª MCP æœåŠ¡å™¨</h3>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty advanced">ğŸ”´ é«˜çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">from langchain_mcp_adapters.client import MultiServerMCPClient  # [!code highlight]
from langchain.agents import create_agent


client = MultiServerMCPClient(  # [!code highlight]
    {
        "math": {
            "transport": "stdio",  # Local subprocess communication
            "command": "python",
            # Absolute path to your math_server.py file
            "args": ["/path/to/math_server.py"],
        },
        "weather": {
            "transport": "http",  # HTTP-based remote server
            # Ensure you start your weather server on port 8000
            "url": "http://localhost:8000/mcp",
        }
    }
)

tools = await client.get_tools()  # [!code highlight]
agent = create_agent(
    "claude-sonnet-4-5-20250929",
    tools  # [!code highlight]
)
math_response = await agent.ainvoke(
    {"messages": [{"role": "user", "content": "what's (3 + 5) x 12?"}]}
)
weather_response = await agent.ainvoke(
    {"messages": [{"role": "user", "content": "what is the weather in nyc?"}]}
)</code></pre>
                    </div>
                </section>

                <!-- Custom servers -->
                <section class="content-section">
                    <h2 class="section-title">è‡ªå®šä¹‰æœåŠ¡å™¨</h2>

                    <p>è¦åˆ›å»ºè‡ªå®šä¹‰ MCP æœåŠ¡å™¨ï¼Œè¯·ä½¿ç”¨ <a href="https://gofastmcp.com/getting-started/welcome" target="_blank">FastMCP</a> åº“ï¼š</p>

                    <div class="tabs-container">
                        <div class="tabs-header">
                            <button class="tab-button active" data-tab="fastmcp-pip">pip</button>
                            <button class="tab-button" data-tab="fastmcp-uv">uv</button>
                        </div>

                        <div class="tab-content active" data-tab="fastmcp-pip">
                            <div class="code-block-wrapper">
                                <div class="code-block-header">
                                    <span class="code-language">Bash</span>
                                    <span class="code-difficulty basic">ğŸŸ¢ åŸºç¡€</span>
                                    <button class="copy-button">å¤åˆ¶ä»£ç </button>
                                </div>
                                <pre><code class="language-bash">pip install fastmcp</code></pre>
                            </div>
                        </div>

                        <div class="tab-content" data-tab="fastmcp-uv">
                            <div class="code-block-wrapper">
                                <div class="code-block-header">
                                    <span class="code-language">Bash</span>
                                    <span class="code-difficulty basic">ğŸŸ¢ åŸºç¡€</span>
                                    <button class="copy-button">å¤åˆ¶ä»£ç </button>
                                </div>
                                <pre><code class="language-bash">uv add fastmcp</code></pre>
                            </div>
                        </div>
                    </div>

                    <p>è¦ä½¿ç”¨ MCP å·¥å…·æœåŠ¡å™¨æµ‹è¯•æ‚¨çš„ Agentï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹ç¤ºä¾‹ï¼š</p>

                    <div class="tabs-container">
                        <div class="tabs-header">
                            <button class="tab-button active" data-tab="server-math">Math server (stdio)</button>
                            <button class="tab-button" data-tab="server-weather">Weather server (HTTP)</button>
                        </div>

                        <div class="tab-content active" data-tab="server-math">
                            <div class="code-block-wrapper">
                                <div class="code-block-header">
                                    <span class="code-language">Python</span>
                                    <span class="code-difficulty basic">ğŸŸ¢ åŸºç¡€</span>
                                    <button class="copy-button">å¤åˆ¶ä»£ç </button>
                                </div>
                                <pre><code class="language-python">from fastmcp import FastMCP

mcp = FastMCP("Math")

@mcp.tool()
def add(a: int, b: int) -> int:
    """Add two numbers"""
    return a + b

@mcp.tool()
def multiply(a: int, b: int) -> int:
    """Multiply two numbers"""
    return a * b

if __name__ == "__main__":
    mcp.run(transport="stdio")</code></pre>
                            </div>
                        </div>

                        <div class="tab-content" data-tab="server-weather">
                            <div class="code-block-wrapper">
                                <div class="code-block-header">
                                    <span class="code-language">Python</span>
                                    <span class="code-difficulty basic">ğŸŸ¢ åŸºç¡€</span>
                                    <button class="copy-button">å¤åˆ¶ä»£ç </button>
                                </div>
                                <pre><code class="language-python">from fastmcp import FastMCP

mcp = FastMCP("Weather")

@mcp.tool()
async def get_weather(location: str) -> str:
    """Get weather for location."""
    return "It's always sunny in New York"

if __name__ == "__main__":
    mcp.run(transport="streamable-http")</code></pre>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Transports -->
                <section class="content-section">
                    <h2 class="section-title">ä¼ è¾“åè®®ï¼ˆTransportsï¼‰</h2>

                    <p>MCP æ”¯æŒä¸åŒçš„ä¼ è¾“æœºåˆ¶ç”¨äºå®¢æˆ·ç«¯-æœåŠ¡å™¨é€šä¿¡ã€‚</p>

                    <h3 class="subsection-title">HTTP</h3>

                    <p>
                        <code>http</code> ä¼ è¾“ï¼ˆä¹Ÿç§°ä¸º <code>streamable-http</code>ï¼‰ä½¿ç”¨ HTTP è¯·æ±‚è¿›è¡Œå®¢æˆ·ç«¯-æœåŠ¡å™¨é€šä¿¡ã€‚
                        æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…
                        <a href="https://modelcontextprotocol.io/specification/2025-03-26/basic/transports#streamable-http" target="_blank">MCP HTTP ä¼ è¾“è§„èŒƒ</a>ã€‚
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty basic">ğŸŸ¢ åŸºç¡€</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">client = MultiServerMCPClient(
    {
        "weather": {
            "transport": "http",
            "url": "http://localhost:8000/mcp",
        }
    }
)</code></pre>
                    </div>

                    <h4 class="subsection-subtitle">ä¼ é€’ Headers</h4>

                    <p>
                        å½“é€šè¿‡ HTTP è¿æ¥åˆ° MCP æœåŠ¡å™¨æ—¶ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨è¿æ¥é…ç½®ä¸­çš„ <code>headers</code> å­—æ®µ
                        åŒ…å«è‡ªå®šä¹‰æ ‡å¤´ï¼ˆä¾‹å¦‚ï¼Œç”¨äºèº«ä»½éªŒè¯æˆ–è·Ÿè¸ªï¼‰ã€‚è¿™æ”¯æŒ <code>sse</code>ï¼ˆMCP è§„èŒƒå·²å¼ƒç”¨ï¼‰
                        å’Œ <code>streamable_http</code> ä¼ è¾“ã€‚
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty intermediate">ğŸŸ¡ ä¸­çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">from langchain_mcp_adapters.client import MultiServerMCPClient
from langchain.agents import create_agent

client = MultiServerMCPClient(
    {
        "weather": {
            "transport": "http",
            "url": "http://localhost:8000/mcp",
            "headers": {  # [!code highlight]
                "Authorization": "Bearer YOUR_TOKEN",  # [!code highlight]
                "X-Custom-Header": "custom-value"  # [!code highlight]
            },  # [!code highlight]
        }
    }
)
tools = await client.get_tools()
agent = create_agent("openai:gpt-4.1", tools)
response = await agent.ainvoke({"messages": "what is the weather in nyc?"})</code></pre>
                    </div>

                    <h4 class="subsection-subtitle">èº«ä»½éªŒè¯</h4>

                    <p>
                        <code>langchain-mcp-adapters</code> åº“åœ¨åº•å±‚ä½¿ç”¨å®˜æ–¹çš„
                        <a href="https://github.com/modelcontextprotocol/python-sdk" target="_blank">MCP SDK</a>ï¼Œ
                        å®ƒå…è®¸æ‚¨é€šè¿‡å®ç° <code>httpx.Auth</code> æ¥å£æ¥æä¾›è‡ªå®šä¹‰èº«ä»½éªŒè¯æœºåˆ¶ã€‚
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty basic">ğŸŸ¢ åŸºç¡€</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">from langchain_mcp_adapters.client import MultiServerMCPClient

client = MultiServerMCPClient(
    {
        "weather": {
            "transport": "http",
            "url": "http://localhost:8000/mcp",
            "auth": auth, # [!code highlight]
        }
    }
)</code></pre>
                    </div>

                    <ul>
                        <li><a href="https://github.com/modelcontextprotocol/python-sdk/blob/main/examples/clients/simple-auth-client/mcp_simple_auth_client/main.py" target="_blank">ç¤ºä¾‹è‡ªå®šä¹‰èº«ä»½éªŒè¯å®ç°</a></li>
                        <li><a href="https://github.com/modelcontextprotocol/python-sdk/blob/main/src/mcp/client/auth.py#L179" target="_blank">å†…ç½® OAuth æµç¨‹</a></li>
                    </ul>

                    <h3 class="subsection-title">stdio</h3>

                    <p>
                        å®¢æˆ·ç«¯å°†æœåŠ¡å™¨ä½œä¸ºå­è¿›ç¨‹å¯åŠ¨ï¼Œå¹¶é€šè¿‡æ ‡å‡†è¾“å…¥/è¾“å‡ºè¿›è¡Œé€šä¿¡ã€‚
                        æœ€é€‚åˆæœ¬åœ°å·¥å…·å’Œç®€å•è®¾ç½®ã€‚
                    </p>

                    <div class="info-box note">
                        <div class="info-box-title">âš ï¸ æ³¨æ„</div>
                        <p>
                            ä¸ HTTP ä¼ è¾“ä¸åŒï¼Œ<code>stdio</code> è¿æ¥æœ¬è´¨ä¸Šæ˜¯<strong>æœ‰çŠ¶æ€çš„</strong>â€”â€”
                            å­è¿›ç¨‹åœ¨å®¢æˆ·ç«¯è¿æ¥çš„ç”Ÿå‘½å‘¨æœŸå†…æŒç»­å­˜åœ¨ã€‚ä½†æ˜¯ï¼Œå½“ä½¿ç”¨ <code>MultiServerMCPClient</code>
                            è€Œä¸è¿›è¡Œæ˜¾å¼ä¼šè¯ç®¡ç†æ—¶ï¼Œæ¯æ¬¡å·¥å…·è°ƒç”¨ä»ä¼šåˆ›å»ºä¸€ä¸ªæ–°ä¼šè¯ã€‚
                            è¯·å‚é˜…<a href="#stateful-sessions">æœ‰çŠ¶æ€ä¼šè¯</a>ä»¥ç®¡ç†æŒä¹…è¿æ¥ã€‚
                        </p>
                    </div>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty basic">ğŸŸ¢ åŸºç¡€</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">client = MultiServerMCPClient(
    {
        "math": {
            "transport": "stdio",
            "command": "python",
            "args": ["/path/to/math_server.py"],
        }
    }
)</code></pre>
                    </div>
                </section>

                <!-- Stateful sessions -->
                <section class="content-section">
                    <h2 class="section-title" id="stateful-sessions">æœ‰çŠ¶æ€ä¼šè¯</h2>

                    <p>
                        é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>MultiServerMCPClient</code> æ˜¯<strong>æ— çŠ¶æ€çš„</strong>â€”â€”
                        æ¯æ¬¡å·¥å…·è°ƒç”¨éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ MCP ä¼šè¯ï¼Œæ‰§è¡Œå·¥å…·ï¼Œç„¶åæ¸…ç†ã€‚
                    </p>

                    <p>
                        å¦‚æœæ‚¨éœ€è¦æ§åˆ¶ MCP ä¼šè¯çš„<a href="https://modelcontextprotocol.io/specification/2025-03-26/basic/lifecycle" target="_blank">ç”Ÿå‘½å‘¨æœŸ</a>
                        ï¼ˆä¾‹å¦‚ï¼Œå½“ä½¿ç”¨åœ¨å·¥å…·è°ƒç”¨ä¹‹é—´ç»´æŠ¤ä¸Šä¸‹æ–‡çš„æœ‰çŠ¶æ€æœåŠ¡å™¨æ—¶ï¼‰ï¼Œ
                        æ‚¨å¯ä»¥ä½¿ç”¨ <code>client.session()</code> åˆ›å»ºæŒä¹…çš„ <code>ClientSession</code>ã€‚
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty intermediate">ğŸŸ¡ ä¸­çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">from langchain_mcp_adapters.client import MultiServerMCPClient
from langchain_mcp_adapters.tools import load_mcp_tools
from langchain.agents import create_agent

client = MultiServerMCPClient({...})

# Create a session explicitly
async with client.session("server_name") as session:  # [!code highlight]
    # Pass the session to load tools, resources, or prompts
    tools = await load_mcp_tools(session)  # [!code highlight]
    agent = create_agent(
        "anthropic:claude-3-7-sonnet-latest",
        tools
    )</code></pre>
                    </div>
                </section>

                <!-- Core features -->
                <section class="content-section">
                    <h2 class="section-title">æ ¸å¿ƒåŠŸèƒ½</h2>

                    <h3 class="subsection-title">å·¥å…·ï¼ˆToolsï¼‰</h3>

                    <p>
                        <a href="https://modelcontextprotocol.io/docs/concepts/tools" target="_blank">å·¥å…·</a>
                        å…è®¸ MCP æœåŠ¡å™¨å…¬å¼€ LLM å¯ä»¥è°ƒç”¨ä»¥æ‰§è¡Œæ“ä½œçš„å¯æ‰§è¡Œå‡½æ•°â€”â€”
                        ä¾‹å¦‚æŸ¥è¯¢æ•°æ®åº“ã€è°ƒç”¨ API æˆ–ä¸å¤–éƒ¨ç³»ç»Ÿäº¤äº’ã€‚
                        LangChain å°† MCP å·¥å…·è½¬æ¢ä¸º LangChain <a href="05-tools.html">å·¥å…·</a>ï¼Œ
                        ä½¿å®ƒä»¬å¯ä»¥ç›´æ¥åœ¨ä»»ä½• LangChain Agent æˆ–å·¥ä½œæµä¸­ä½¿ç”¨ã€‚
                    </p>

                    <h4 class="subsection-subtitle">åŠ è½½å·¥å…·</h4>

                    <p>ä½¿ç”¨ <code>client.get_tools()</code> ä» MCP æœåŠ¡å™¨æ£€ç´¢å·¥å…·å¹¶å°†å®ƒä»¬ä¼ é€’ç»™æ‚¨çš„ Agentï¼š</p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty basic">ğŸŸ¢ åŸºç¡€</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">from langchain_mcp_adapters.client import MultiServerMCPClient
from langchain.agents import create_agent

client = MultiServerMCPClient({...})
tools = await client.get_tools()  # [!code highlight]
agent = create_agent("claude-sonnet-4-5-20250929", tools)</code></pre>
                    </div>

                    <h4 class="subsection-subtitle">ç»“æ„åŒ–å†…å®¹</h4>

                    <p>
                        MCP å·¥å…·å¯ä»¥åœ¨äººç±»å¯è¯»çš„æ–‡æœ¬å“åº”ä¹‹å¤–è¿”å›
                        <a href="https://modelcontextprotocol.io/specification/2025-03-26/server/tools#structured-content" target="_blank">ç»“æ„åŒ–å†…å®¹</a>ã€‚
                        å½“å·¥å…·éœ€è¦è¿”å›æœºå™¨å¯è§£æçš„æ•°æ®ï¼ˆå¦‚ JSONï¼‰ä»¥åŠæ˜¾ç¤ºç»™æ¨¡å‹çš„æ–‡æœ¬æ—¶ï¼Œè¿™éå¸¸æœ‰ç”¨ã€‚
                    </p>

                    <p>
                        å½“ MCP å·¥å…·è¿”å› <code>structuredContent</code> æ—¶ï¼Œé€‚é…å™¨å°†å…¶åŒ…è£…åœ¨
                        <code>MCPToolArtifact</code> ä¸­å¹¶å°†å…¶ä½œä¸ºå·¥å…·çš„ artifact è¿”å›ã€‚
                        æ‚¨å¯ä»¥ä½¿ç”¨ <code>ToolMessage</code> ä¸Šçš„ <code>artifact</code> å­—æ®µè®¿é—®å®ƒã€‚
                        æ‚¨è¿˜å¯ä»¥ä½¿ç”¨<a href="#tool-interceptors">æ‹¦æˆªå™¨</a>è‡ªåŠ¨å¤„ç†æˆ–è½¬æ¢ç»“æ„åŒ–å†…å®¹ã€‚
                    </p>

                    <p><strong>ä» artifact æå–ç»“æ„åŒ–å†…å®¹</strong></p>

                    <p>è°ƒç”¨ Agent åï¼Œæ‚¨å¯ä»¥ä»å“åº”ä¸­çš„å·¥å…·æ¶ˆæ¯è®¿é—®ç»“æ„åŒ–å†…å®¹ï¼š</p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty intermediate">ğŸŸ¡ ä¸­çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">from langchain_mcp_adapters.client import MultiServerMCPClient
from langchain.agents import create_agent
from langchain.messages import ToolMessage

client = MultiServerMCPClient({...})
tools = await client.get_tools()
agent = create_agent("claude-sonnet-4-5-20250929", tools)

result = await agent.ainvoke(
    {"messages": [{"role": "user", "content": "Get data from the server"}]}
)

# Extract structured content from tool messages
for message in result["messages"]:
    if isinstance(message, ToolMessage) and message.artifact:
        structured_content = message.artifact["structured_content"]</code></pre>
                    </div>

                    <p><strong>é€šè¿‡æ‹¦æˆªå™¨é™„åŠ ç»“æ„åŒ–å†…å®¹</strong></p>

                    <p>
                        å¦‚æœæ‚¨å¸Œæœ›ç»“æ„åŒ–å†…å®¹åœ¨å¯¹è¯å†å²ä¸­å¯è§ï¼ˆå¯¹æ¨¡å‹å¯è§ï¼‰ï¼Œ
                        æ‚¨å¯ä»¥ä½¿ç”¨<a href="#tool-interceptors">æ‹¦æˆªå™¨</a>è‡ªåŠ¨å°†ç»“æ„åŒ–å†…å®¹é™„åŠ åˆ°å·¥å…·ç»“æœï¼š
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty intermediate">ğŸŸ¡ ä¸­çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">import json

from langchain_mcp_adapters.client import MultiServerMCPClient
from langchain_mcp_adapters.interceptors import MCPToolCallRequest
from mcp.types import TextContent

async def append_structured_content(request: MCPToolCallRequest, handler):
    """Append structured content from artifact to tool message."""
    result = await handler(request)
    if result.structuredContent:
        result.content += [
            TextContent(type="text", text=json.dumps(result.structuredContent)),
        ]
    return result

client = MultiServerMCPClient({...}, tool_interceptors=[append_structured_content])</code></pre>
                    </div>

                    <h4 class="subsection-subtitle">å¤šæ¨¡æ€å·¥å…·å†…å®¹</h4>

                    <p>
                        MCP å·¥å…·å¯ä»¥åœ¨å…¶å“åº”ä¸­è¿”å›
                        <a href="https://modelcontextprotocol.io/specification/2025-03-26/server/tools#tool-result" target="_blank">å¤šæ¨¡æ€å†…å®¹</a>
                        ï¼ˆå›¾åƒã€æ–‡æœ¬ç­‰ï¼‰ã€‚å½“ MCP æœåŠ¡å™¨è¿”å›å…·æœ‰å¤šä¸ªéƒ¨åˆ†ï¼ˆä¾‹å¦‚ï¼Œæ–‡æœ¬å’Œå›¾åƒï¼‰çš„å†…å®¹æ—¶ï¼Œ
                        é€‚é…å™¨å°†å®ƒä»¬è½¬æ¢ä¸º LangChain çš„<a href="04-messages.html#standard-content-blocks">æ ‡å‡†å†…å®¹å—</a>ã€‚
                        æ‚¨å¯ä»¥é€šè¿‡ <code>ToolMessage</code> ä¸Šçš„ <code>content_blocks</code> å±æ€§è®¿é—®æ ‡å‡†åŒ–è¡¨ç¤ºï¼š
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty intermediate">ğŸŸ¡ ä¸­çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">from langchain_mcp_adapters.client import MultiServerMCPClient
from langchain.agents import create_agent

client = MultiServerMCPClient({...})
tools = await client.get_tools()
agent = create_agent("claude-sonnet-4-5-20250929", tools)

result = await agent.ainvoke(
    {"messages": [{"role": "user", "content": "Take a screenshot of the current page"}]}
)

# Access multimodal content from tool messages
for message in result["messages"]:
    if message.type == "tool":
        # Raw content in provider-native format
        print(f"Raw content: {message.content}")

        # Standardized content blocks  # [!code highlight]
        for block in message.content_blocks:  # [!code highlight]
            if block["type"] == "text":  # [!code highlight]
                print(f"Text: {block['text']}")  # [!code highlight]
            elif block["type"] == "image":  # [!code highlight]
                print(f"Image URL: {block.get('url')}")  # [!code highlight]
                print(f"Image base64: {block.get('base64', '')[:50]}...")  # [!code highlight]</code></pre>
                    </div>

                    <p>
                        è¿™å…è®¸æ‚¨ä»¥ä¸æä¾›è€…æ— å…³çš„æ–¹å¼å¤„ç†å¤šæ¨¡æ€å·¥å…·å“åº”ï¼Œ
                        æ— è®ºåº•å±‚ MCP æœåŠ¡å™¨å¦‚ä½•æ ¼å¼åŒ–å…¶å†…å®¹ã€‚
                    </p>

                    <h3 class="subsection-title">èµ„æºï¼ˆResourcesï¼‰</h3>

                    <p>
                        <a href="https://modelcontextprotocol.io/docs/concepts/resources" target="_blank">èµ„æº</a>
                        å…è®¸ MCP æœåŠ¡å™¨å…¬å¼€æ•°æ®â€”â€”ä¾‹å¦‚æ–‡ä»¶ã€æ•°æ®åº“è®°å½•æˆ– API å“åº”â€”â€”
                        å®¢æˆ·ç«¯å¯ä»¥è¯»å–è¿™äº›æ•°æ®ã€‚LangChain å°† MCP èµ„æºè½¬æ¢ä¸º Blob å¯¹è±¡ï¼Œ
                        æä¾›äº†ç»Ÿä¸€çš„æ¥å£æ¥å¤„ç†æ–‡æœ¬å’ŒäºŒè¿›åˆ¶å†…å®¹ã€‚
                    </p>

                    <h4 class="subsection-subtitle">åŠ è½½èµ„æº</h4>

                    <p>ä½¿ç”¨ <code>client.get_resources()</code> ä» MCP æœåŠ¡å™¨åŠ è½½èµ„æºï¼š</p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty basic">ğŸŸ¢ åŸºç¡€</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">from langchain_mcp_adapters.client import MultiServerMCPClient

client = MultiServerMCPClient({...})

# Load all resources from a server
blobs = await client.get_resources("server_name")  # [!code highlight]

# Or load specific resources by URI
blobs = await client.get_resources("server_name", uris=["file:///path/to/file.txt"])  # [!code highlight]

for blob in blobs:
    print(f"URI: {blob.metadata['uri']}, MIME type: {blob.mimetype}")
    print(blob.as_string())  # For text content</code></pre>
                    </div>

                    <p>
                        æ‚¨è¿˜å¯ä»¥ç›´æ¥ä½¿ç”¨ä¼šè¯ä¸ <code>load_mcp_resources</code> ä¸€èµ·ä½¿ç”¨ä»¥è·å¾—æ›´å¤šæ§åˆ¶ï¼š
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty intermediate">ğŸŸ¡ ä¸­çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">from langchain_mcp_adapters.client import MultiServerMCPClient
from langchain_mcp_adapters.resources import load_mcp_resources

client = MultiServerMCPClient({...})

async with client.session("server_name") as session:
    # Load all resources
    blobs = await load_mcp_resources(session)

    # Or load specific resources by URI
    blobs = await load_mcp_resources(session, uris=["file:///path/to/file.txt"])</code></pre>
                    </div>

                    <h3 class="subsection-title">æç¤ºè¯ï¼ˆPromptsï¼‰</h3>

                    <p>
                        <a href="https://modelcontextprotocol.io/docs/concepts/prompts" target="_blank">æç¤ºè¯</a>
                        å…è®¸ MCP æœåŠ¡å™¨å…¬å¼€å®¢æˆ·ç«¯å¯ä»¥æ£€ç´¢å’Œä½¿ç”¨çš„å¯é‡ç”¨æç¤ºè¯æ¨¡æ¿ã€‚
                        LangChain å°† MCP æç¤ºè¯è½¬æ¢ä¸º<a href="04-messages.html">æ¶ˆæ¯</a>ï¼Œ
                        ä½¿å®ƒä»¬æ˜“äºé›†æˆåˆ°åŸºäºèŠå¤©çš„å·¥ä½œæµä¸­ã€‚
                    </p>

                    <h4 class="subsection-subtitle">åŠ è½½æç¤ºè¯</h4>

                    <p>ä½¿ç”¨ <code>client.get_prompt()</code> ä» MCP æœåŠ¡å™¨åŠ è½½æç¤ºè¯ï¼š</p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty basic">ğŸŸ¢ åŸºç¡€</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">from langchain_mcp_adapters.client import MultiServerMCPClient

client = MultiServerMCPClient({...})

# Load a prompt by name
messages = await client.get_prompt("server_name", "summarize")  # [!code highlight]

# Load a prompt with arguments
messages = await client.get_prompt(  # [!code highlight]
    "server_name",  # [!code highlight]
    "code_review",  # [!code highlight]
    arguments={"language": "python", "focus": "security"}  # [!code highlight]
)  # [!code highlight]

# Use the messages in your workflow
for message in messages:
    print(f"{message.type}: {message.content}")</code></pre>
                    </div>

                    <p>
                        æ‚¨è¿˜å¯ä»¥ç›´æ¥ä½¿ç”¨ä¼šè¯ä¸ <code>load_mcp_prompt</code> ä¸€èµ·ä½¿ç”¨ä»¥è·å¾—æ›´å¤šæ§åˆ¶ï¼š
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty intermediate">ğŸŸ¡ ä¸­çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">from langchain_mcp_adapters.client import MultiServerMCPClient
from langchain_mcp_adapters.prompts import load_mcp_prompt

client = MultiServerMCPClient({...})

async with client.session("server_name") as session:
    # Load a prompt by name
    messages = await load_mcp_prompt(session, "summarize")

    # Load a prompt with arguments
    messages = await load_mcp_prompt(
        session,
        "code_review",
        arguments={"language": "python", "focus": "security"}
    )</code></pre>
                    </div>
                </section>

                <!-- Advanced features -->
                <section class="content-section">
                    <h2 class="section-title">é«˜çº§åŠŸèƒ½</h2>

                    <h3 class="subsection-title" id="tool-interceptors">å·¥å…·æ‹¦æˆªå™¨</h3>

                    <p>
                        MCP æœåŠ¡å™¨ä½œä¸ºç‹¬ç«‹è¿›ç¨‹è¿è¡Œâ€”â€”å®ƒä»¬æ— æ³•è®¿é—® LangGraph è¿è¡Œæ—¶ä¿¡æ¯ï¼Œ
                        å¦‚ storeã€context æˆ– Agent çŠ¶æ€ã€‚
                        <strong>æ‹¦æˆªå™¨å¼¥åˆäº†è¿™ä¸€å·®è·</strong>ï¼Œåœ¨ MCP å·¥å…·æ‰§è¡ŒæœŸé—´ä¸ºæ‚¨æä¾›å¯¹æ­¤è¿è¡Œæ—¶ä¸Šä¸‹æ–‡çš„è®¿é—®ã€‚
                    </p>

                    <p>
                        æ‹¦æˆªå™¨è¿˜ä¸ºå·¥å…·è°ƒç”¨æä¾›ç±»ä¼¼ä¸­é—´ä»¶çš„æ§åˆ¶ï¼š
                        æ‚¨å¯ä»¥ä¿®æ”¹è¯·æ±‚ã€å®ç°é‡è¯•ã€åŠ¨æ€æ·»åŠ æ ‡å¤´æˆ–å®Œå…¨çŸ­è·¯æ‰§è¡Œã€‚
                    </p>

                    <table>
                        <thead>
                            <tr>
                                <th>éƒ¨åˆ†</th>
                                <th>æè¿°</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><a href="#accessing-runtime-context">è®¿é—®è¿è¡Œæ—¶ä¸Šä¸‹æ–‡</a></td>
                                <td>è¯»å–ç”¨æˆ· IDã€API å¯†é’¥ã€å­˜å‚¨æ•°æ®å’Œ Agent çŠ¶æ€</td>
                            </tr>
                            <tr>
                                <td><a href="#state-updates-and-commands">çŠ¶æ€æ›´æ–°å’Œå‘½ä»¤</a></td>
                                <td>ä½¿ç”¨ <code>Command</code> æ›´æ–° Agent çŠ¶æ€æˆ–æ§åˆ¶å›¾æµç¨‹</td>
                            </tr>
                            <tr>
                                <td><a href="#custom-interceptors">è‡ªå®šä¹‰æ‹¦æˆªå™¨</a></td>
                                <td>ä¿®æ”¹è¯·æ±‚ã€ç»„åˆæ‹¦æˆªå™¨å’Œé”™è¯¯å¤„ç†çš„æ¨¡å¼</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4 class="subsection-subtitle" id="accessing-runtime-context">è®¿é—®è¿è¡Œæ—¶ä¸Šä¸‹æ–‡</h4>

                    <p>
                        å½“ MCP å·¥å…·åœ¨ LangChain Agentï¼ˆé€šè¿‡ <code>create_agent</code>ï¼‰ä¸­ä½¿ç”¨æ—¶ï¼Œ
                        æ‹¦æˆªå™¨æ¥æ”¶å¯¹ <code>ToolRuntime</code> ä¸Šä¸‹æ–‡çš„è®¿é—®ã€‚
                        è¿™æä¾›äº†å¯¹å·¥å…·è°ƒç”¨ IDã€çŠ¶æ€ã€é…ç½®å’Œå­˜å‚¨çš„è®¿é—®â€”â€”
                        å®ç°è®¿é—®ç”¨æˆ·æ•°æ®ã€æŒä¹…åŒ–ä¿¡æ¯å’Œæ§åˆ¶ Agent è¡Œä¸ºçš„å¼ºå¤§æ¨¡å¼ã€‚
                    </p>

                    <div class="tabs-container">
                        <div class="tabs-header">
                            <button class="tab-button active" data-tab="interceptor-context">Runtime Context</button>
                            <button class="tab-button" data-tab="interceptor-store">Store</button>
                            <button class="tab-button" data-tab="interceptor-state">State</button>
                            <button class="tab-button" data-tab="interceptor-toolid">Tool Call ID</button>
                        </div>

                        <div class="tab-content active" data-tab="interceptor-context">
                            <p>è®¿é—®åœ¨è°ƒç”¨æ—¶ä¼ é€’çš„ç”¨æˆ·ç‰¹å®šé…ç½®ï¼Œå¦‚ç”¨æˆ· IDã€API å¯†é’¥æˆ–æƒé™ï¼š</p>
                            <div class="code-block-wrapper">
                                <div class="code-block-header">
                                    <span class="code-language">Python</span>
                                    <span class="code-difficulty advanced">ğŸ”´ é«˜çº§</span>
                                    <button class="copy-button">å¤åˆ¶ä»£ç </button>
                                </div>
                                <pre><code class="language-python">from dataclasses import dataclass
from langchain_mcp_adapters.client import MultiServerMCPClient
from langchain_mcp_adapters.interceptors import MCPToolCallRequest
from langchain.agents import create_agent

@dataclass
class Context:
    user_id: str
    api_key: str

async def inject_user_context(
    request: MCPToolCallRequest,
    handler,
):
    """Inject user credentials into MCP tool calls."""
    runtime = request.runtime
    user_id = runtime.context.user_id  # [!code highlight]
    api_key = runtime.context.api_key  # [!code highlight]

    # Add user context to tool arguments
    modified_request = request.override(
        args={**request.args, "user_id": user_id}
    )
    return await handler(modified_request)

client = MultiServerMCPClient(
    {...},
    tool_interceptors=[inject_user_context],
)
tools = await client.get_tools()
agent = create_agent("gpt-4o", tools, context_schema=Context)

# Invoke with user context
result = await agent.ainvoke(
    {"messages": [{"role": "user", "content": "Search my orders"}]},
    context={"user_id": "user_123", "api_key": "sk-..."}
)</code></pre>
                            </div>
                        </div>

                        <div class="tab-content" data-tab="interceptor-store">
                            <p>è®¿é—®é•¿æœŸè®°å¿†ä»¥æ£€ç´¢ç”¨æˆ·åå¥½æˆ–è·¨å¯¹è¯æŒä¹…åŒ–æ•°æ®ï¼š</p>
                            <div class="code-block-wrapper">
                                <div class="code-block-header">
                                    <span class="code-language">Python</span>
                                    <span class="code-difficulty advanced">ğŸ”´ é«˜çº§</span>
                                    <button class="copy-button">å¤åˆ¶ä»£ç </button>
                                </div>
                                <pre><code class="language-python">from dataclasses import dataclass
from langchain_mcp_adapters.client import MultiServerMCPClient
from langchain_mcp_adapters.interceptors import MCPToolCallRequest
from langchain.agents import create_agent
from langgraph.store.memory import InMemoryStore

@dataclass
class Context:
    user_id: str

async def personalize_search(
    request: MCPToolCallRequest,
    handler,
):
    """Personalize MCP tool calls using stored preferences."""
    runtime = request.runtime
    user_id = runtime.context.user_id
    store = runtime.store  # [!code highlight]

    # Read user preferences from store
    prefs = store.get(("preferences",), user_id)  # [!code highlight]

    if prefs and request.name == "search":
        # Apply user's preferred language and result limit
        modified_args = {
            **request.args,
            "language": prefs.value.get("language", "en"),
            "limit": prefs.value.get("result_limit", 10),
        }
        request = request.override(args=modified_args)

    return await handler(request)

client = MultiServerMCPClient(
    {...},
    tool_interceptors=[personalize_search],
)
tools = await client.get_tools()
agent = create_agent(
    "gpt-4o",
    tools,
    context_schema=Context,
    store=InMemoryStore()
)</code></pre>
                            </div>
                        </div>

                        <div class="tab-content" data-tab="interceptor-state">
                            <p>è®¿é—®å¯¹è¯çŠ¶æ€ä»¥æ ¹æ®å½“å‰ä¼šè¯åšå‡ºå†³ç­–ï¼š</p>
                            <div class="code-block-wrapper">
                                <div class="code-block-header">
                                    <span class="code-language">Python</span>
                                    <span class="code-difficulty advanced">ğŸ”´ é«˜çº§</span>
                                    <button class="copy-button">å¤åˆ¶ä»£ç </button>
                                </div>
                                <pre><code class="language-python">from langchain_mcp_adapters.client import MultiServerMCPClient
from langchain_mcp_adapters.interceptors import MCPToolCallRequest
from langchain.messages import ToolMessage

async def require_authentication(
    request: MCPToolCallRequest,
    handler,
):
    """Block sensitive MCP tools if user is not authenticated."""
    runtime = request.runtime
    state = runtime.state  # [!code highlight]
    is_authenticated = state.get("authenticated", False)  # [!code highlight]

    sensitive_tools = ["delete_file", "update_settings", "export_data"]

    if request.name in sensitive_tools and not is_authenticated:
        # Return error instead of calling tool
        return ToolMessage(
            content="Authentication required. Please log in first.",
            tool_call_id=runtime.tool_call_id,
        )

    return await handler(request)

client = MultiServerMCPClient(
    {...},
    tool_interceptors=[require_authentication],
)</code></pre>
                            </div>
                        </div>

                        <div class="tab-content" data-tab="interceptor-toolid">
                            <p>è®¿é—®å·¥å…·è°ƒç”¨ ID ä»¥è¿”å›æ­£ç¡®æ ¼å¼çš„å“åº”æˆ–è·Ÿè¸ªå·¥å…·æ‰§è¡Œï¼š</p>
                            <div class="code-block-wrapper">
                                <div class="code-block-header">
                                    <span class="code-language">Python</span>
                                    <span class="code-difficulty intermediate">ğŸŸ¡ ä¸­çº§</span>
                                    <button class="copy-button">å¤åˆ¶ä»£ç </button>
                                </div>
                                <pre><code class="language-python">from langchain_mcp_adapters.client import MultiServerMCPClient
from langchain_mcp_adapters.interceptors import MCPToolCallRequest
from langchain.messages import ToolMessage

async def rate_limit_interceptor(
    request: MCPToolCallRequest,
    handler,
):
    """Rate limit expensive MCP tool calls."""
    runtime = request.runtime
    tool_call_id = runtime.tool_call_id  # [!code highlight]

    # Check rate limit (simplified example)
    if is_rate_limited(request.name):
        return ToolMessage(
            content="Rate limit exceeded. Please try again later.",
            tool_call_id=tool_call_id,  # [!code highlight]
        )

    result = await handler(request)

    # Log successful tool call
    log_tool_execution(tool_call_id, request.name, success=True)

    return result

client = MultiServerMCPClient(
    {...},
    tool_interceptors=[rate_limit_interceptor],
)</code></pre>
                            </div>
                        </div>
                    </div>

                    <p>
                        æœ‰å…³æ›´å¤šä¸Šä¸‹æ–‡å·¥ç¨‹æ¨¡å¼ï¼Œè¯·å‚é˜…<a href="38-context-engineering.html">ä¸Šä¸‹æ–‡å·¥ç¨‹</a>å’Œ<a href="05-tools.html">å·¥å…·</a>ã€‚
                    </p>

                    <h4 class="subsection-subtitle" id="state-updates-and-commands">çŠ¶æ€æ›´æ–°å’Œå‘½ä»¤</h4>

                    <p>
                        æ‹¦æˆªå™¨å¯ä»¥è¿”å› <code>Command</code> å¯¹è±¡æ¥æ›´æ–° Agent çŠ¶æ€æˆ–æ§åˆ¶å›¾æ‰§è¡Œæµç¨‹ã€‚
                        è¿™å¯¹äºè·Ÿè¸ªä»»åŠ¡è¿›åº¦ã€åœ¨ Agent ä¹‹é—´åˆ‡æ¢æˆ–æå‰ç»“æŸæ‰§è¡Œå¾ˆæœ‰ç”¨ã€‚
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty advanced">ğŸ”´ é«˜çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">from langchain.agents import AgentState, create_agent
from langchain_mcp_adapters.interceptors import MCPToolCallRequest
from langchain.messages import ToolMessage
from langgraph.types import Command

async def handle_task_completion(
    request: MCPToolCallRequest,
    handler,
):
    """Mark task complete and hand off to summary agent."""
    result = await handler(request)

    if request.name == "submit_order":
        return Command(
            update={
                "messages": [result] if isinstance(result, ToolMessage) else [],
                "task_status": "completed",  # [!code highlight]
            },
            goto="summary_agent",  # [!code highlight]
        )

    return result</code></pre>
                    </div>

                    <p>ä½¿ç”¨ <code>Command</code> å’Œ <code>goto="__end__"</code> æå‰ç»“æŸæ‰§è¡Œï¼š</p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty intermediate">ğŸŸ¡ ä¸­çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">async def end_on_success(
    request: MCPToolCallRequest,
    handler,
):
    """End agent run when task is marked complete."""
    result = await handler(request)

    if request.name == "mark_complete":
        return Command(
            update={"messages": [result], "status": "done"},
            goto="__end__",  # [!code highlight]
        )

    return result</code></pre>
                    </div>

                    <h4 class="subsection-subtitle" id="custom-interceptors">è‡ªå®šä¹‰æ‹¦æˆªå™¨</h4>

                    <p>
                        æ‹¦æˆªå™¨æ˜¯åŒ…è£…å·¥å…·æ‰§è¡Œçš„å¼‚æ­¥å‡½æ•°ï¼Œå®ç°è¯·æ±‚/å“åº”ä¿®æ”¹ã€é‡è¯•é€»è¾‘å’Œå…¶ä»–æ¨ªåˆ‡å…³æ³¨ç‚¹ã€‚
                        å®ƒä»¬éµå¾ª"æ´‹è‘±"æ¨¡å¼ï¼Œå…¶ä¸­åˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªæ‹¦æˆªå™¨æ˜¯æœ€å¤–å±‚ã€‚
                    </p>

                    <p><strong>åŸºæœ¬æ¨¡å¼</strong></p>

                    <p>
                        æ‹¦æˆªå™¨æ˜¯ä¸€ä¸ªå¼‚æ­¥å‡½æ•°ï¼Œæ¥æ”¶è¯·æ±‚å’Œå¤„ç†ç¨‹åºã€‚
                        æ‚¨å¯ä»¥åœ¨è°ƒç”¨å¤„ç†ç¨‹åºä¹‹å‰ä¿®æ”¹è¯·æ±‚ï¼Œä¹‹åä¿®æ”¹å“åº”ï¼Œæˆ–å®Œå…¨è·³è¿‡å¤„ç†ç¨‹åºã€‚
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty basic">ğŸŸ¢ åŸºç¡€</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">from langchain_mcp_adapters.client import MultiServerMCPClient
from langchain_mcp_adapters.interceptors import MCPToolCallRequest

async def logging_interceptor(
    request: MCPToolCallRequest,
    handler,
):
    """Log tool calls before and after execution."""
    print(f"Calling tool: {request.name} with args: {request.args}")
    result = await handler(request)
    print(f"Tool {request.name} returned: {result}")
    return result

client = MultiServerMCPClient(
    {"math": {"transport": "stdio", "command": "python", "args": ["/path/to/server.py"]}},
    tool_interceptors=[logging_interceptor],  # [!code highlight]
)</code></pre>
                    </div>

                    <p><strong>ä¿®æ”¹è¯·æ±‚</strong></p>

                    <p>
                        ä½¿ç”¨ <code>request.override()</code> åˆ›å»ºä¿®æ”¹åçš„è¯·æ±‚ã€‚
                        è¿™éµå¾ªä¸å¯å˜æ¨¡å¼ï¼Œä½¿åŸå§‹è¯·æ±‚ä¿æŒä¸å˜ã€‚
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty intermediate">ğŸŸ¡ ä¸­çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">async def double_args_interceptor(
    request: MCPToolCallRequest,
    handler,
):
    """Double all numeric arguments before execution."""
    modified_args = {k: v * 2 for k, v in request.args.items()}
    modified_request = request.override(args=modified_args)  # [!code highlight]
    return await handler(modified_request)

# Original call: add(a=2, b=3) becomes add(a=4, b=6)</code></pre>
                    </div>

                    <p><strong>è¿è¡Œæ—¶ä¿®æ”¹æ ‡å¤´</strong></p>

                    <p>æ‹¦æˆªå™¨å¯ä»¥æ ¹æ®è¯·æ±‚ä¸Šä¸‹æ–‡åŠ¨æ€ä¿®æ”¹ HTTP æ ‡å¤´ï¼š</p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty intermediate">ğŸŸ¡ ä¸­çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">async def auth_header_interceptor(
    request: MCPToolCallRequest,
    handler,
):
    """Add authentication headers based on the tool being called."""
    token = get_token_for_tool(request.name)
    modified_request = request.override(
        headers={"Authorization": f"Bearer {token}"}  # [!code highlight]
    )
    return await handler(modified_request)</code></pre>
                    </div>

                    <p><strong>ç»„åˆæ‹¦æˆªå™¨</strong></p>

                    <p>å¤šä¸ªæ‹¦æˆªå™¨ä»¥"æ´‹è‘±"é¡ºåºç»„åˆâ€”â€”åˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªæ‹¦æˆªå™¨æ˜¯æœ€å¤–å±‚ï¼š</p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty intermediate">ğŸŸ¡ ä¸­çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">async def outer_interceptor(request, handler):
    print("outer: before")
    result = await handler(request)
    print("outer: after")
    return result

async def inner_interceptor(request, handler):
    print("inner: before")
    result = await handler(request)
    print("inner: after")
    return result

client = MultiServerMCPClient(
    {...},
    tool_interceptors=[outer_interceptor, inner_interceptor],  # [!code highlight]
)

# Execution order:
# outer: before -> inner: before -> tool execution -> inner: after -> outer: after</code></pre>
                    </div>

                    <p><strong>é”™è¯¯å¤„ç†</strong></p>

                    <p>ä½¿ç”¨æ‹¦æˆªå™¨æ•è·å·¥å…·æ‰§è¡Œé”™è¯¯å¹¶å®ç°é‡è¯•é€»è¾‘ï¼š</p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty advanced">ğŸ”´ é«˜çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">import asyncio

async def retry_interceptor(
    request: MCPToolCallRequest,
    handler,
    max_retries: int = 3,
    delay: float = 1.0,
):
    """Retry failed tool calls with exponential backoff."""
    last_error = None
    for attempt in range(max_retries):
        try:
            return await handler(request)
        except Exception as e:
            last_error = e
            if attempt < max_retries - 1:
                wait_time = delay * (2 ** attempt)  # Exponential backoff
                print(f"Tool {request.name} failed (attempt {attempt + 1}), retrying in {wait_time}s...")
                await asyncio.sleep(wait_time)
    raise last_error

client = MultiServerMCPClient(
    {...},
    tool_interceptors=[retry_interceptor],  # [!code highlight]
)</code></pre>
                    </div>

                    <p>æ‚¨è¿˜å¯ä»¥æ•è·ç‰¹å®šé”™è¯¯ç±»å‹å¹¶è¿”å›å›é€€å€¼ï¼š</p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty intermediate">ğŸŸ¡ ä¸­çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">async def fallback_interceptor(
    request: MCPToolCallRequest,
    handler,
):
    """Return a fallback value if tool execution fails."""
    try:
        return await handler(request)
    except TimeoutError:
        return f"Tool {request.name} timed out. Please try again later."
    except ConnectionError:
        return f"Could not connect to {request.name} service. Using cached data."</code></pre>
                    </div>

                    <h3 class="subsection-title">è¿›åº¦é€šçŸ¥</h3>

                    <p>è®¢é˜…é•¿æ—¶é—´è¿è¡Œçš„å·¥å…·æ‰§è¡Œçš„è¿›åº¦æ›´æ–°ï¼š</p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty intermediate">ğŸŸ¡ ä¸­çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">from langchain_mcp_adapters.client import MultiServerMCPClient
from langchain_mcp_adapters.callbacks import Callbacks, CallbackContext

async def on_progress(
    progress: float,
    total: float | None,
    message: str | None,
    context: CallbackContext,
):
    """Handle progress updates from MCP servers."""
    percent = (progress / total * 100) if total else progress
    tool_info = f" ({context.tool_name})" if context.tool_name else ""
    print(f"[{context.server_name}{tool_info}] Progress: {percent:.1f}% - {message}")

client = MultiServerMCPClient(
    {...},
    callbacks=Callbacks(on_progress=on_progress),  # [!code highlight]
)</code></pre>
                    </div>

                    <p><code>CallbackContext</code> æä¾›ï¼š</p>
                    <ul>
                        <li><code>server_name</code>ï¼šMCP æœåŠ¡å™¨çš„åç§°</li>
                        <li><code>tool_name</code>ï¼šæ­£åœ¨æ‰§è¡Œçš„å·¥å…·åç§°ï¼ˆåœ¨å·¥å…·è°ƒç”¨æœŸé—´å¯ç”¨ï¼‰</li>
                    </ul>

                    <h3 class="subsection-title">æ—¥å¿—è®°å½•</h3>

                    <p>
                        MCP åè®®æ”¯æŒæ¥è‡ªæœåŠ¡å™¨çš„<a href="https://modelcontextprotocol.io/specification/2025-03-26/server/utilities/logging#log-levels" target="_blank">æ—¥å¿—è®°å½•</a>é€šçŸ¥ã€‚
                        ä½¿ç”¨ <code>Callbacks</code> ç±»è®¢é˜…è¿™äº›äº‹ä»¶ã€‚
                    </p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty intermediate">ğŸŸ¡ ä¸­çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">from langchain_mcp_adapters.client import MultiServerMCPClient
from langchain_mcp_adapters.callbacks import Callbacks, CallbackContext
from mcp.types import LoggingMessageNotificationParams

async def on_logging_message(
    params: LoggingMessageNotificationParams,
    context: CallbackContext,
):
    """Handle log messages from MCP servers."""
    print(f"[{context.server_name}] {params.level}: {params.data}")

client = MultiServerMCPClient(
    {...},
    callbacks=Callbacks(on_logging_message=on_logging_message),  # [!code highlight]
)</code></pre>
                    </div>

                    <h3 class="subsection-title">å¯å‘ï¼ˆElicitationï¼‰</h3>

                    <p>
                        <a href="https://modelcontextprotocol.io/specification/2025-11-25/client/elicitation#elicitation" target="_blank">å¯å‘</a>
                        å…è®¸ MCP æœåŠ¡å™¨åœ¨å·¥å…·æ‰§è¡ŒæœŸé—´å‘ç”¨æˆ·è¯·æ±‚é¢å¤–è¾“å…¥ã€‚
                        æœåŠ¡å™¨å¯ä»¥äº¤äº’å¼åœ°æ ¹æ®éœ€è¦è¯¢é—®ä¿¡æ¯ï¼Œè€Œä¸æ˜¯é¢„å…ˆè¦æ±‚æ‰€æœ‰è¾“å…¥ã€‚
                    </p>

                    <h4 class="subsection-subtitle">æœåŠ¡å™¨è®¾ç½®</h4>

                    <p>å®šä¹‰ä¸€ä¸ªä½¿ç”¨ <code>ctx.elicit()</code> è¯·æ±‚ç”¨æˆ·è¾“å…¥çš„å·¥å…·ï¼š</p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty intermediate">ğŸŸ¡ ä¸­çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">from pydantic import BaseModel
from mcp.server.fastmcp import Context, FastMCP

server = FastMCP("Profile")

class UserDetails(BaseModel):
    email: str
    age: int

@server.tool()
async def create_profile(name: str, ctx: Context) -> str:
    """Create a user profile, requesting details via elicitation."""
    result = await ctx.elicit(  # [!code highlight]
        message=f"Please provide details for {name}'s profile:",  # [!code highlight]
        schema=UserDetails,  # [!code highlight]
    )  # [!code highlight]
    if result.action == "accept" and result.data:
        return f"Created profile for {name}: email={result.data.email}, age={result.data.age}"
    if result.action == "decline":
        return f"User declined. Created minimal profile for {name}."
    return "Profile creation cancelled."

if __name__ == "__main__":
    server.run(transport="http")</code></pre>
                    </div>

                    <h4 class="subsection-subtitle">å®¢æˆ·ç«¯è®¾ç½®</h4>

                    <p>é€šè¿‡å‘ <code>MultiServerMCPClient</code> æä¾›å›è°ƒæ¥å¤„ç†å¯å‘è¯·æ±‚ï¼š</p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty advanced">ğŸ”´ é«˜çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">from langchain_mcp_adapters.client import MultiServerMCPClient
from langchain_mcp_adapters.callbacks import Callbacks, CallbackContext
from mcp.shared.context import RequestContext
from mcp.types import ElicitRequestParams, ElicitResult

async def on_elicitation(
    mcp_context: RequestContext,
    params: ElicitRequestParams,
    context: CallbackContext,
) -> ElicitResult:
    """Handle elicitation requests from MCP servers."""
    # In a real application, you would prompt the user for input
    # based on params.message and params.requestedSchema
    return ElicitResult(  # [!code highlight]
        action="accept",  # [!code highlight]
        content={"email": "user@example.com", "age": 25},  # [!code highlight]
    )  # [!code highlight]

client = MultiServerMCPClient(
    {
        "profile": {
            "url": "http://localhost:8000/mcp",
            "transport": "http",
        }
    },
    callbacks=Callbacks(on_elicitation=on_elicitation),  # [!code highlight]
)</code></pre>
                    </div>

                    <h4 class="subsection-subtitle">å“åº”åŠ¨ä½œ</h4>

                    <p>å¯å‘å›è°ƒå¯ä»¥è¿”å›ä¸‰ç§åŠ¨ä½œä¹‹ä¸€ï¼š</p>

                    <table>
                        <thead>
                            <tr>
                                <th>åŠ¨ä½œ</th>
                                <th>æè¿°</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>accept</code></td>
                                <td>ç”¨æˆ·æä¾›äº†æœ‰æ•ˆè¾“å…¥ã€‚åœ¨ <code>content</code> å­—æ®µä¸­åŒ…å«æ•°æ®ã€‚</td>
                            </tr>
                            <tr>
                                <td><code>decline</code></td>
                                <td>ç”¨æˆ·é€‰æ‹©ä¸æä¾›è¯·æ±‚çš„ä¿¡æ¯ã€‚</td>
                            </tr>
                            <tr>
                                <td><code>cancel</code></td>
                                <td>ç”¨æˆ·å®Œå…¨å–æ¶ˆäº†æ“ä½œã€‚</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty basic">ğŸŸ¢ åŸºç¡€</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python"># Accept with data
ElicitResult(action="accept", content={"email": "user@example.com", "age": 25})

# Decline (user doesn't want to provide info)
ElicitResult(action="decline")

# Cancel (abort the operation)
ElicitResult(action="cancel")</code></pre>
                    </div>
                </section>

                <!-- Additional resources -->
                <section class="content-section">
                    <h2 class="section-title">å…¶ä»–èµ„æº</h2>
                    <ul>
                        <li><a href="https://modelcontextprotocol.io/introduction" target="_blank">MCP æ–‡æ¡£</a></li>
                        <li><a href="https://modelcontextprotocol.io/docs/concepts/transports" target="_blank">MCP ä¼ è¾“æ–‡æ¡£</a></li>
                        <li><a href="https://github.com/langchain-ai/langchain-mcp-adapters" target="_blank"><code>langchain-mcp-adapters</code></a></li>
                    </ul>
                </section>

                <!-- é¡µé¢å¯¼èˆª -->
                <nav class="page-navigation">
                    <a href="16-context-engineering.html" class="nav-button prev">
                        â† ä¸Šä¸€é¡µ:ä¸Šä¸‹æ–‡å·¥ç¨‹
                    </a>
                    <a href="18-customer-service.html" class="nav-button next">
                        ä¸‹ä¸€é¡µ:å®¢æœæœºå™¨äºº â†’
                    </a>
                </nav>
            </div>
        </main>
    </div>

    <!-- è¿”å›é¡¶éƒ¨æŒ‰é’® -->
    <button class="back-to-top" aria-label="è¿”å›é¡¶éƒ¨">â†‘</button>

    <!-- JavaScript -->
    <script src="assets/js/main.js"></script>
</body>
</html>
