<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="LangChain 1.0 æ ¸å¿ƒæ¶æ„ - æ·±å…¥ç†è§£ LangChain çš„è®¾è®¡å“²å­¦å’Œæ¨¡å—ç»„ç»‡">
    <title>æ ¸å¿ƒæ¶æ„ | LangChain 1.0 Python çŸ¥è¯†æ–‡æ¡£</title>
    <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
    <button class="mobile-menu-button" aria-label="æ‰“å¼€èœå•">â˜°</button>

    <div class="container">
        <!-- ä¾§è¾¹æ å¯¼èˆª -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <h1 class="sidebar-title">ğŸ¦œ LangChain 1.0</h1>
                <p class="sidebar-subtitle">Python å®Œæ•´å­¦ä¹ æŒ‡å—</p>
            </div>

            <ul class="nav-menu">
                <li class="nav-section">
                    <div class="nav-section-title">å¼€å§‹</div>
                    <ul>
                        <li class="nav-item">
                            <a href="index.html" class="nav-link">
                                <span class="nav-icon">ğŸ </span>
                                ä¸»é¡µ
                            </a>
                        </li>
                    </ul>
                </li>

                <li class="nav-section">
                    <div class="nav-section-title">åŸºç¡€ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="01-introduction.html" class="nav-link">
                                <span class="nav-icon">ğŸ“–</span>
                                LangChain ç®€ä»‹
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="02-architecture.html" class="nav-link">
                                <span class="nav-icon">ğŸ—ï¸</span>
                                æ ¸å¿ƒæ¶æ„
                            </a>
                        </li>
                        <li class="nav-item active">
                            <a href="03-models.html" class="nav-link">
                                <span class="nav-icon">ğŸ¤–</span>
                                æ¨¡å‹æ¥å£
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="04-messages.html" class="nav-link">
                                <span class="nav-icon">ğŸ’¬</span>
                                æ¶ˆæ¯ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="05-tools.html" class="nav-link">
                                <span class="nav-icon">ğŸ”§</span>
                                å·¥å…·ç³»ç»Ÿ
                            </a>
                        </li>
                    </ul>
                </li>

                <li class="nav-section">
                    <div class="nav-section-title">è¿›é˜¶ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="06-agents.html" class="nav-link">
                                <span class="nav-icon">ğŸ¯</span>
                                Agent åŸºç¡€
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="07-middleware.html" class="nav-link">
                                <span class="nav-icon">âš™ï¸</span>
                                ä¸­é—´ä»¶ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="08-rag.html" class="nav-link">
                                <span class="nav-icon">ğŸ”</span>
                                RAG è¯¦è§£
                                <span class="nav-badge">é‡ç‚¹</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="09-lcel.html" class="nav-link">
                                <span class="nav-icon">ğŸ”—</span>
                                LCEL è¡¨è¾¾å¼
                            </a>
                        </li>
                    </ul>
                </li>

                                <li class="nav-section">
                    <div class="nav-section-title">é«˜çº§åº”ç”¨</div>
                    <ul>
                        <li class="nav-item">
                            <a href="10-runtime.html" class="nav-link">
                                <span class="nav-icon">ğŸ”Œ</span>
                                Runtime ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="11-checkpointer.html" class="nav-link">
                                <span class="nav-icon">ğŸ’¾</span>
                                æŒä¹…åŒ–ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="12-streaming.html" class="nav-link">
                                <span class="nav-icon">ğŸŒŠ</span>
                                æµå¼è¾“å‡º
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="13-human-in-loop.html" class="nav-link">
                                <span class="nav-icon">ğŸ‘¤</span>
                                äººå·¥ä»‹å…¥
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="14-long-term-memory.html" class="nav-link">
                                <span class="nav-icon">ğŸ—„ï¸</span>
                                é•¿æœŸè®°å¿†
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="15-langgraph.html" class="nav-link">
                                <span class="nav-icon">ğŸ“Š</span>
                                LangGraph
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="16-context-engineering.html" class="nav-link">
                                <span class="nav-icon">ğŸ¯</span>
                                ä¸Šä¸‹æ–‡å·¥ç¨‹
                                <span class="nav-badge">é‡ç‚¹</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="17-mcp.html" class="nav-link">
                                <span class="nav-icon">ğŸ”Œ</span>
                                MCP åè®®
                            </a>
                        </li>
                    </ul>
                </li>


                                <li class="nav-section">
                    <div class="nav-section-title">å®æˆ˜ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="18-customer-service.html" class="nav-link">
                                <span class="nav-icon">ğŸ‘¥</span>
                                å®¢æœæœºå™¨äºº
                                <span class="nav-badge">é‡ç‚¹</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="19-best-practices.html" class="nav-link">
                                <span class="nav-icon">âœ¨</span>
                                æœ€ä½³å®è·µ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="38-chat.html" class="nav-link">
                                <span class="nav-icon">ğŸ’¬</span>
                                åœ¨çº¿å¯¹è¯åŠ©æ‰‹
                                <span class="nav-badge">NEW</span>
                            </a>
                        </li>
                    </ul>
                </li>


                                <li class="nav-section">
                    <div class="nav-section-title">å‚è€ƒç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="20-api-reference.html" class="nav-link">
                                <span class="nav-icon">ğŸ“š</span>
                                API é€ŸæŸ¥è¡¨
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="21-troubleshooting.html" class="nav-link">
                                <span class="nav-icon">ğŸ›</span>
                                æ•…éšœæ’é™¤
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="22-migration.html" class="nav-link">
                                <span class="nav-icon">ğŸ”„</span>
                                è¿ç§»æŒ‡å—
                            </a>
                        </li>
                    </ul>
                </li>


                                <li class="nav-section">
                    <div class="nav-section-title">æ‰©å±•ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="23-structured-output.html" class="nav-link">
                                <span class="nav-icon">ğŸ“Š</span>
                                ç»“æ„åŒ–è¾“å‡º
                            </a>
                        </li>
                    </ul>
                </li>


                                <li class="nav-section">
                    <div class="nav-section-title">DeepAgents ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="24-deepagents-quickstart.html" class="nav-link">
                                <span class="nav-icon">ğŸš€</span>
                                å¿«é€Ÿå¼€å§‹
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="25-deepagents-customization.html" class="nav-link">
                                <span class="nav-icon">ğŸ¨</span>
                                å®šåˆ¶åŒ–
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="26-deepagents-harness.html" class="nav-link">
                                <span class="nav-icon">ğŸ›ï¸</span>
                                Harness ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="27-deepagents-backends.html" class="nav-link">
                                <span class="nav-icon">ğŸ”§</span>
                                åç«¯é…ç½®
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="28-deepagents-subagents.html" class="nav-link">
                                <span class="nav-icon">ğŸ‘¥</span>
                                å­ä»£ç†
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="29-deepagents-hitl.html" class="nav-link">
                                <span class="nav-icon">ğŸ¤</span>
                                äººå·¥ä»‹å…¥
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="30-deepagents-memory.html" class="nav-link">
                                <span class="nav-icon">ğŸ§ </span>
                                é•¿æœŸè®°å¿†
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="31-deepagents-middleware.html" class="nav-link">
                                <span class="nav-icon">âš™ï¸</span>
                                ä¸­é—´ä»¶
                            </a>
                        </li>
                    </ul>
                </li>


                                <li class="nav-section">
                    <div class="nav-section-title">Multi-Agent ç¯‡</div>
                    <ul>
                        <li class="nav-item">
                            <a href="32-multi-agent-index.html" class="nav-link">
                                <span class="nav-icon">ğŸŒ</span>
                                æ¦‚è¿°
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="33-multi-agent-subagents.html" class="nav-link">
                                <span class="nav-icon">ğŸ‘¥</span>
                                å­ä»£ç†
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="34-multi-agent-handoffs.html" class="nav-link">
                                <span class="nav-icon">ğŸ”„</span>
                                äº¤æ¥æœºåˆ¶
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="35-multi-agent-skills.html" class="nav-link">
                                <span class="nav-icon">ğŸ¯</span>
                                æŠ€èƒ½ç³»ç»Ÿ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="36-multi-agent-router.html" class="nav-link">
                                <span class="nav-icon">ğŸ§­</span>
                                è·¯ç”±æœºåˆ¶
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="37-multi-agent-workflow.html" class="nav-link">
                                <span class="nav-icon">ğŸ”€</span>
                                è‡ªå®šä¹‰å·¥ä½œæµ
                            </a>
                        </li>
                    </ul>
                </li>
            </ul>
        </nav>

        <!-- ä¸»å†…å®¹åŒºåŸŸ -->
        <!-- ä¸»å†…å®¹åŒºåŸŸ -->
        <main class="main-content">
            <div class="content-wrapper">
                <!-- é¢åŒ…å±‘å¯¼èˆª -->
                <nav class="breadcrumb">
                    <span class="breadcrumb-item">
                        <a href="index.html" class="breadcrumb-link">ä¸»é¡µ</a>
                    </span>
                    <span class="breadcrumb-item">
                        åŸºç¡€ç¯‡
                    </span>
                    <span class="breadcrumb-item">
                        æ¨¡å‹æ¥å£
                    </span>
                </nav>

                <!-- é¡µé¢æ ‡é¢˜ -->
                <header class="page-header">
                    <h1 class="page-title">ğŸ¤– æ¨¡å‹æ¥å£è¯¦è§£</h1>
                    <p class="page-subtitle">
                        æŒæ¡ LangChain 1.0 çš„ç»Ÿä¸€æ¨¡å‹æ¥å£ï¼Œä½¿ç”¨ init_chat_model() è½»æ¾åˆ‡æ¢
                        OpenAIã€Anthropicã€Google ç­‰å¤šå®¶æä¾›å•†çš„ LLM æ¨¡å‹ã€‚
                    </p>
                </header>

                <!-- ä»€ä¹ˆæ˜¯æ¨¡å‹æ¥å£ -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ“š ä»€ä¹ˆæ˜¯æ¨¡å‹æ¥å£ï¼Ÿ</h2>
                    <p>
                        <strong>æ¨¡å‹ï¼ˆModelsï¼‰</strong>æ˜¯ LangChain åº”ç”¨çš„æ ¸å¿ƒæ¨ç†å¼•æ“ã€‚
                        LangChain 1.0 æä¾›äº†ç»Ÿä¸€çš„æ¨¡å‹æ¥å£ï¼Œè®©ä½ èƒ½å¤Ÿï¼š
                    </p>
                    <ul>
                        <li><strong>æ— ç¼åˆ‡æ¢</strong>ï¼šåœ¨ä¸åŒ LLM æä¾›å•†ä¹‹é—´è½»æ¾åˆ‡æ¢</li>
                        <li><strong>æ ‡å‡†åŒ– API</strong>ï¼šä½¿ç”¨ç»Ÿä¸€çš„æ¥å£è°ƒç”¨æ‰€æœ‰æ¨¡å‹</li>
                        <li><strong>ä¸°å¯ŒåŠŸèƒ½</strong>ï¼šæ”¯æŒå·¥å…·è°ƒç”¨ã€ç»“æ„åŒ–è¾“å‡ºã€å¤šæ¨¡æ€ç­‰é«˜çº§ç‰¹æ€§</li>
                        <li><strong>çµæ´»é…ç½®</strong>ï¼šåŠ¨æ€è°ƒæ•´æ¨¡å‹å‚æ•°å’Œæä¾›å•†</li>
                    </ul>

                    <div class="info-box note">
                        <div class="info-box-title">ğŸ’¡ LangChain 1.0 çš„æ ¸å¿ƒä¼˜åŠ¿</div>
                        <p>
                            ä½¿ç”¨ <code>init_chat_model()</code> å‡½æ•°ï¼Œä½ å¯ä»¥ç”¨åŒä¸€å¥—ä»£ç è°ƒç”¨
                            GPT-4ã€Claudeã€Gemini ç­‰ä¸åŒæ¨¡å‹ï¼Œåªéœ€ä¿®æ”¹æ¨¡å‹åç§°å³å¯ã€‚
                            è¿™å¤§å¤§ç®€åŒ–äº†å¤šæ¨¡å‹åº”ç”¨çš„å¼€å‘å’Œæµ‹è¯•ã€‚
                        </p>
                    </div>
                </section>

                <!-- init_chat_model() è¯¦è§£ -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ”§ init_chat_model() å‡½æ•°è¯¦è§£</h2>
                    <p>
                        <code>init_chat_model()</code> æ˜¯ LangChain 1.0 åˆå§‹åŒ–èŠå¤©æ¨¡å‹çš„ç»Ÿä¸€å…¥å£ã€‚
                    </p>

                    <h3 class="subsection-title">åŸºç¡€ç”¨æ³•</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty basic">ğŸŸ¢ åŸºç¡€</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
init_chat_model() åŸºç¡€ç¤ºä¾‹
åŠŸèƒ½ï¼šå¿«é€Ÿåˆå§‹åŒ–èŠå¤©æ¨¡å‹
"""
from langchain.chat_models import init_chat_model

# æ–¹å¼ 1ï¼šä»…æŒ‡å®šæ¨¡å‹åç§°ï¼ˆæœ€ç®€å•ï¼‰
model = init_chat_model("gpt-4")

# æ–¹å¼ 2ï¼šä½¿ç”¨ "æä¾›å•†:æ¨¡å‹å" æ ¼å¼
model = init_chat_model("google_genai:gemini-2.5-flash-lite")

# æ–¹å¼ 3ï¼šæ˜¾å¼æŒ‡å®šæä¾›å•†
model = init_chat_model(
    "claude-sonnet-4-5-20250929",
    model_provider="anthropic"
)

# è°ƒç”¨æ¨¡å‹
response = model.invoke("ä¸ºä»€ä¹ˆé¹¦é¹‰æœ‰å½©è‰²çš„ç¾½æ¯›ï¼Ÿ")
print(response.content)</code></pre>
                    </div>

                    <h3 class="subsection-title">æ”¯æŒçš„æ¨¡å‹æä¾›å•†</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>æä¾›å•†</th>
                                <th>å®‰è£…å‘½ä»¤</th>
                                <th>ç¤ºä¾‹æ¨¡å‹</th>
                                <th>API Key ç¯å¢ƒå˜é‡</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>OpenAI</strong></td>
                                <td><code>pip install -U "langchain[openai]"</code></td>
                                <td><code>gpt-4o</code>, <code>gpt-4-turbo</code></td>
                                <td><code>OPENAI_API_KEY</code></td>
                            </tr>
                            <tr>
                                <td><strong>Anthropic</strong></td>
                                <td><code>pip install -U "langchain[anthropic]"</code></td>
                                <td><code>claude-sonnet-4-5-20250929</code></td>
                                <td><code>ANTHROPIC_API_KEY</code></td>
                            </tr>
                            <tr>
                                <td><strong>Google</strong></td>
                                <td><code>pip install -U "langchain[google-genai]"</code></td>
                                <td><code>gemini-2.5-flash-lite</code></td>
                                <td><code>GOOGLE_API_KEY</code></td>
                            </tr>
                            <tr>
                                <td><strong>Azure OpenAI</strong></td>
                                <td><code>pip install -U "langchain[openai]"</code></td>
                                <td>è‡ªå®šä¹‰éƒ¨ç½²åç§°</td>
                                <td><code>AZURE_OPENAI_API_KEY</code></td>
                            </tr>
                            <tr>
                                <td><strong>AWS Bedrock</strong></td>
                                <td><code>pip install -U "langchain[bedrock]"</code></td>
                                <td><code>anthropic.claude-3-5-sonnet...</code></td>
                                <td>AWS å‡­è¯</td>
                            </tr>
                            <tr>
                                <td><strong>HuggingFace</strong></td>
                                <td><code>pip install -U "langchain[huggingface]"</code></td>
                                <td><code>microsoft/Phi-3-mini-4k-instruct</code></td>
                                <td><code>HUGGINGFACEHUB_API_TOKEN</code></td>
                            </tr>
                        </tbody>
                    </table>

                    <h3 class="subsection-title">æ ¸å¿ƒå‚æ•°è¯´æ˜</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>å‚æ•°</th>
                                <th>ç±»å‹</th>
                                <th>é»˜è®¤å€¼</th>
                                <th>è¯´æ˜</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>model</code></td>
                                <td>str</td>
                                <td>å¿…éœ€</td>
                                <td>æ¨¡å‹æ ‡è¯†ç¬¦ï¼ˆæ”¯æŒ "æä¾›å•†:æ¨¡å‹" æ ¼å¼ï¼‰</td>
                            </tr>
                            <tr>
                                <td><code>model_provider</code></td>
                                <td>str</td>
                                <td>è‡ªåŠ¨æ£€æµ‹</td>
                                <td>æŒ‡å®šæä¾›å•†ï¼ˆopenai/anthropic/google-genai ç­‰ï¼‰</td>
                            </tr>
                            <tr>
                                <td><code>api_key</code></td>
                                <td>str</td>
                                <td>ç¯å¢ƒå˜é‡</td>
                                <td>API è®¤è¯å¯†é’¥</td>
                            </tr>
                            <tr>
                                <td><code>temperature</code></td>
                                <td>float</td>
                                <td>0.7</td>
                                <td>æ§åˆ¶éšæœºæ€§ï¼ˆ0=ç¡®å®šæ€§ï¼Œæ›´é«˜=åˆ›é€ æ€§ï¼‰</td>
                            </tr>
                            <tr>
                                <td><code>max_tokens</code></td>
                                <td>int</td>
                                <td>None</td>
                                <td>é™åˆ¶å“åº”é•¿åº¦ï¼ˆä»¤ç‰Œæ•°ï¼‰</td>
                            </tr>
                            <tr>
                                <td><code>timeout</code></td>
                                <td>int</td>
                                <td>60</td>
                                <td>è¯·æ±‚è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰</td>
                            </tr>
                            <tr>
                                <td><code>max_retries</code></td>
                                <td>int</td>
                                <td>2</td>
                                <td>å¤±è´¥è¯·æ±‚çš„é‡è¯•æ¬¡æ•°</td>
                            </tr>
                            <tr>
                                <td><code>base_url</code></td>
                                <td>str</td>
                                <td>None</td>
                                <td>è‡ªå®šä¹‰ API ç«¯ç‚¹ï¼ˆç”¨äºä»£ç†æˆ–å…¼å®¹ APIï¼‰</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3 class="subsection-title">å®Œæ•´é…ç½®ç¤ºä¾‹</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty intermediate">ğŸŸ¡ ä¸­çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
æ¨¡å‹ç²¾ç»†é…ç½®ç¤ºä¾‹
åŠŸèƒ½ï¼šå±•ç¤ºæ‰€æœ‰å¸¸ç”¨é…ç½®é€‰é¡¹
"""
from langchain.chat_models import init_chat_model

# å®Œæ•´å‚æ•°é…ç½®
model = init_chat_model(
    model="claude-sonnet-4-5-20250929",
    model_provider="anthropic",

    # æ€§èƒ½å‚æ•°
    temperature=0.3,        # é™ä½éšæœºæ€§ï¼Œæé«˜å‡†ç¡®æ€§
    max_tokens=2000,        # é™åˆ¶è¾“å‡ºé•¿åº¦

    # ç½‘ç»œå‚æ•°
    timeout=30,             # 30 ç§’è¶…æ—¶
    max_retries=3,          # å¤±è´¥åé‡è¯• 3 æ¬¡

    # è®¤è¯ï¼ˆå¯é€‰ï¼Œé»˜è®¤ä»ç¯å¢ƒå˜é‡è¯»å–ï¼‰
    # api_key="your-api-key-here"
)

# æµ‹è¯•è°ƒç”¨
response = model.invoke("ç”¨ç®€æ´çš„è¯­è¨€è§£é‡Šä»€ä¹ˆæ˜¯é‡å­è®¡ç®—")
print(response.content)

# æŸ¥çœ‹æ¨¡å‹é…ç½®ä¿¡æ¯
print(f"\næ¨¡å‹é…ç½®: {model.profile}")</code></pre>
                    </div>
                </section>

                <!-- æ¨¡å‹è°ƒç”¨æ–¹æ³• -->
                <section class="content-section">
                    <h2 class="section-title">ğŸš€ æ¨¡å‹è°ƒç”¨æ–¹æ³•</h2>
                    <p>
                        LangChain æ¨¡å‹æä¾›ä¸‰ç§ä¸»è¦è°ƒç”¨æ–¹å¼ï¼Œé€‚ç”¨äºä¸åŒåœºæ™¯ï¼š
                    </p>

                    <div class="mermaid-wrapper">
                        <div class="mermaid">
graph LR
    A[è¾“å…¥æ¶ˆæ¯] --> B{è°ƒç”¨æ–¹å¼}

    B -->|å•æ¬¡è°ƒç”¨| C[invoke]
    C --> D[å®Œæ•´å“åº”]

    B -->|å®æ—¶è¾“å‡º| E[stream]
    E --> F[é€å—è¿”å›]
    F --> G[ç´¯ç§¯å®Œæ•´ç»“æœ]

    B -->|æ‰¹é‡å¤„ç†| H[batch]
    H --> I[å¹¶è¡Œæ‰§è¡Œ]
    I --> J[è¿”å›ç»“æœåˆ—è¡¨]

    style C fill:#3b82f6,color:#fff
    style E fill:#10b981,color:#fff
    style H fill:#f59e0b,color:#fff
    style D fill:#8b5cf6,color:#fff
    style G fill:#8b5cf6,color:#fff
    style J fill:#8b5cf6,color:#fff
                        </div>
                    </div>

                    <h3 class="subsection-title">1. invoke() - å•æ¬¡è°ƒç”¨</h3>
                    <p>é€‚ç”¨äºæ ‡å‡†çš„ä¸€é—®ä¸€ç­”åœºæ™¯ï¼Œç­‰å¾…å®Œæ•´å“åº”åè¿”å›ã€‚</p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty basic">ğŸŸ¢ åŸºç¡€</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
invoke() å•æ¬¡è°ƒç”¨ç¤ºä¾‹
"""
from langchain.chat_models import init_chat_model

model = init_chat_model("gpt-4o")

# æ–¹å¼ 1ï¼šç›´æ¥ä¼ å…¥å­—ç¬¦ä¸²
response = model.invoke("ä¸ºä»€ä¹ˆé¹¦é¹‰ä¼šè¯´è¯ï¼Ÿ")
print(response.content)

# æ–¹å¼ 2ï¼šä¼ å…¥å¯¹è¯å†å²ï¼ˆå­—å…¸æ ¼å¼ï¼‰
conversation = [
    {"role": "system", "content": "ä½ æ˜¯ä¸€ä¸ªç¿»è¯‘åŠ©æ‰‹ã€‚"},
    {"role": "user", "content": "ç¿»è¯‘ï¼šI love programming."},
    {"role": "assistant", "content": "æˆ‘çˆ±ç¼–ç¨‹ã€‚"},
    {"role": "user", "content": "ç¿»è¯‘ï¼šI love building applications."}
]

response = model.invoke(conversation)
print(response.content)  # è¾“å‡ºï¼šæˆ‘çˆ±æ„å»ºåº”ç”¨ç¨‹åºã€‚</code></pre>
                    </div>

                    <h3 class="subsection-title">2. stream() - æµå¼è¾“å‡º</h3>
                    <p>å®æ—¶é€å—è¿”å›å“åº”ï¼Œé€‚åˆéœ€è¦å³æ—¶åé¦ˆçš„åœºæ™¯ï¼ˆå¦‚èŠå¤©ç•Œé¢ï¼‰ã€‚</p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty intermediate">ğŸŸ¡ ä¸­çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
stream() æµå¼è¾“å‡ºç¤ºä¾‹
åŠŸèƒ½ï¼šå®æ—¶æ˜¾ç¤ºæ¨¡å‹ç”Ÿæˆè¿‡ç¨‹
"""
from langchain.chat_models import init_chat_model

model = init_chat_model("claude-sonnet-4-5-20250929")

# æ–¹å¼ 1ï¼šé€å—æ‰“å°
print("æµå¼è¾“å‡º: ", end="")
for chunk in model.stream("ä¸ºä»€ä¹ˆé¹¦é¹‰æœ‰å½©è‰²çš„ç¾½æ¯›ï¼Ÿ"):
    print(chunk.content, end="", flush=True)
print("\n")

# æ–¹å¼ 2ï¼šç´¯ç§¯å®Œæ•´æ¶ˆæ¯
full_response = None
for chunk in model.stream("å¤©ç©ºæ˜¯ä»€ä¹ˆé¢œè‰²ï¼Ÿ"):
    if full_response is None:
        full_response = chunk
    else:
        full_response = full_response + chunk  # ç´¯åŠ å—

print("å®Œæ•´å“åº”:", full_response.content)</code></pre>
                    </div>

                    <h3 class="subsection-title">3. batch() - æ‰¹é‡è°ƒç”¨</h3>
                    <p>å¹¶è¡Œå¤„ç†å¤šä¸ªè¯·æ±‚ï¼Œæé«˜æ•ˆç‡ï¼Œé€‚åˆæ‰¹é‡æ•°æ®å¤„ç†ã€‚</p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty intermediate">ğŸŸ¡ ä¸­çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
batch() æ‰¹é‡è°ƒç”¨ç¤ºä¾‹
åŠŸèƒ½ï¼šå¹¶è¡Œå¤„ç†å¤šä¸ªé—®é¢˜
"""
from langchain.chat_models import init_chat_model

model = init_chat_model("gpt-4o-mini")

# æ‰¹é‡é—®é¢˜åˆ—è¡¨
questions = [
    "ä¸ºä»€ä¹ˆé¹¦é¹‰æœ‰å½©è‰²çš„ç¾½æ¯›ï¼Ÿ",
    "é£æœºæ˜¯å¦‚ä½•é£è¡Œçš„ï¼Ÿ",
    "ä»€ä¹ˆæ˜¯é‡å­è®¡ç®—ï¼Ÿ"
]

# æ‰¹é‡è°ƒç”¨ï¼ˆå¹¶è¡Œæ‰§è¡Œï¼‰
responses = model.batch(questions)

# æ‰“å°æ‰€æœ‰å“åº”
for i, response in enumerate(responses, 1):
    print(f"\né—®é¢˜ {i}: {questions[i-1]}")
    print(f"å›ç­”: {response.content[:100]}...")

# æ§åˆ¶å¹¶å‘æ•°é‡
responses = model.batch(
    questions,
    config={"max_concurrency": 2}  # æœ€å¤šåŒæ—¶å¤„ç† 2 ä¸ªè¯·æ±‚
)</code></pre>
                    </div>

                    <div class="info-box tip">
                        <div class="info-box-title">âœ… è°ƒç”¨æ–¹å¼é€‰æ‹©å»ºè®®</div>
                        <ul>
                            <li><strong>invoke()</strong>ï¼šç®€å•é—®ç­”ã€è„šæœ¬åŒ–å¤„ç†</li>
                            <li><strong>stream()</strong>ï¼šèŠå¤©ç•Œé¢ã€éœ€è¦å³æ—¶åé¦ˆçš„åœºæ™¯</li>
                            <li><strong>batch()</strong>ï¼šæ‰¹é‡ç¿»è¯‘ã€æ•°æ®æ ‡æ³¨ã€å¤§è§„æ¨¡å¤„ç†</li>
                        </ul>
                    </div>
                </section>

                <!-- å·¥å…·è°ƒç”¨ -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ”§ å·¥å…·è°ƒç”¨ï¼ˆTool Callingï¼‰</h2>
                    <p>
                        å·¥å…·è°ƒç”¨è®©æ¨¡å‹èƒ½å¤Ÿè°ƒç”¨å¤–éƒ¨å‡½æ•°è·å–ä¿¡æ¯æˆ–æ‰§è¡Œæ“ä½œã€‚
                        ä½¿ç”¨ <code>bind_tools()</code> æ–¹æ³•å°†å·¥å…·ç»‘å®šåˆ°æ¨¡å‹ã€‚
                    </p>

                    <div class="mermaid-wrapper">
                        <div class="mermaid">
graph LR
    A[ç”¨æˆ·é—®é¢˜] --> B[æ¨¡å‹ + å·¥å…·]
    B --> C{éœ€è¦å·¥å…·ï¼Ÿ}

    C -->|æ˜¯| D[ç”Ÿæˆå·¥å…·è°ƒç”¨]
    D --> E[æ‰§è¡Œå·¥å…·å‡½æ•°]
    E --> F[è¿”å›ç»“æœ]
    F --> G[æ¨¡å‹æ•´åˆç»“æœ]
    G --> H[ç”Ÿæˆæœ€ç»ˆç­”æ¡ˆ]

    C -->|å¦| H

    style B fill:#3b82f6,color:#fff
    style D fill:#10b981,color:#fff
    style E fill:#f59e0b,color:#fff
    style H fill:#8b5cf6,color:#fff
                        </div>
                    </div>

                    <h3 class="subsection-title">åŸºç¡€å·¥å…·ç»‘å®š</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty basic">ğŸŸ¢ åŸºç¡€</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
å·¥å…·è°ƒç”¨åŸºç¡€ç¤ºä¾‹
åŠŸèƒ½ï¼šè®©æ¨¡å‹è°ƒç”¨å¤©æ°”æŸ¥è¯¢å·¥å…·
"""
from langchain.chat_models import init_chat_model
from langchain.tools import tool

# å®šä¹‰å·¥å…·
@tool
def get_weather(location: str) -> str:
    """è·å–æŒ‡å®šåœ°ç‚¹çš„å¤©æ°”ä¿¡æ¯ã€‚

    Args:
        location: åœ°ç‚¹åç§°

    Returns:
        å¤©æ°”æè¿°
    """
    # æ¨¡æ‹Ÿå¤©æ°”æŸ¥è¯¢
    return f"{location} ä»Šå¤©å¤©æ°”æ™´æœ—ï¼Œæ¸©åº¦ 22Â°Cã€‚"

# åˆå§‹åŒ–æ¨¡å‹
model = init_chat_model("gpt-4o")

# ç»‘å®šå·¥å…·åˆ°æ¨¡å‹
model_with_tools = model.bind_tools([get_weather])

# è°ƒç”¨æ¨¡å‹ï¼ˆæ¨¡å‹ä¼šå†³å®šæ˜¯å¦éœ€è¦ä½¿ç”¨å·¥å…·ï¼‰
response = model_with_tools.invoke("æ³¢å£«é¡¿ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ")

# æ£€æŸ¥æ˜¯å¦æœ‰å·¥å…·è°ƒç”¨
if response.tool_calls:
    for tool_call in response.tool_calls:
        print(f"å·¥å…·: {tool_call['name']}")
        print(f"å‚æ•°: {tool_call['args']}")
else:
    print(f"ç›´æ¥å›ç­”: {response.content}")</code></pre>
                    </div>

                    <h3 class="subsection-title">å®Œæ•´å·¥å…·æ‰§è¡Œå¾ªç¯</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty advanced">ğŸ”´ é«˜çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
å®Œæ•´çš„å·¥å…·è°ƒç”¨å¾ªç¯
åŠŸèƒ½ï¼šæ¨¡å‹è°ƒç”¨å·¥å…· â†’ æ‰§è¡Œå·¥å…· â†’ è¿”å›ç»“æœ â†’ ç”Ÿæˆæœ€ç»ˆç­”æ¡ˆ
"""
from langchain.chat_models import init_chat_model
from langchain.tools import tool
from langchain.messages import ToolMessage

@tool
def get_weather(location: str) -> str:
    """è·å–å¤©æ°”ä¿¡æ¯"""
    weather_data = {
        "æ³¢å£«é¡¿": "æ™´æœ—ï¼Œ18Â°C",
        "çº½çº¦": "å¤šäº‘ï¼Œ20Â°C",
        "æ—§é‡‘å±±": "å¤šé›¾ï¼Œ15Â°C"
    }
    return weather_data.get(location, f"{location} å¤©æ°”æ™´æœ—")

# åˆå§‹åŒ–æ¨¡å‹å¹¶ç»‘å®šå·¥å…·
model = init_chat_model("gpt-4o")
model_with_tools = model.bind_tools([get_weather])

# ç¬¬ 1 æ­¥ï¼šç”¨æˆ·æé—®
messages = [{"role": "user", "content": "æ³¢å£«é¡¿ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ"}]

# ç¬¬ 2 æ­¥ï¼šæ¨¡å‹æ¨ç†ï¼ˆå¯èƒ½ç”Ÿæˆå·¥å…·è°ƒç”¨ï¼‰
ai_message = model_with_tools.invoke(messages)
messages.append(ai_message)

# ç¬¬ 3 æ­¥ï¼šæ‰§è¡Œå·¥å…·è°ƒç”¨
for tool_call in ai_message.tool_calls:
    # è·å–å·¥å…·å‡½æ•°
    selected_tool = {"get_weather": get_weather}[tool_call["name"]]

    # æ‰§è¡Œå·¥å…·
    tool_result = selected_tool.invoke(tool_call)

    # å°†å·¥å…·ç»“æœæ·»åŠ åˆ°æ¶ˆæ¯å†å²
    messages.append(tool_result)

# ç¬¬ 4 æ­¥ï¼šæ¨¡å‹æ•´åˆå·¥å…·ç»“æœï¼Œç”Ÿæˆæœ€ç»ˆç­”æ¡ˆ
final_response = model_with_tools.invoke(messages)

print("æœ€ç»ˆç­”æ¡ˆ:", final_response.content)</code></pre>
                    </div>

                    <h3 class="subsection-title">å·¥å…·è°ƒç”¨é€‰é¡¹</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python"># å¼ºåˆ¶ä½¿ç”¨ä»»ä¸€å·¥å…·ï¼ˆä¸ç›´æ¥å›ç­”ï¼‰
model_with_tools = model.bind_tools([tool1, tool2], tool_choice="any")

# ç¦ç”¨å¹¶è¡Œå·¥å…·è°ƒç”¨ï¼ˆä¸€æ¬¡åªè°ƒç”¨ä¸€ä¸ªå·¥å…·ï¼‰
model_with_tools = model.bind_tools([get_weather], parallel_tool_calls=False)</code></pre>
                    </div>
                </section>

                <!-- ç»“æ„åŒ–è¾“å‡º -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ“‹ ç»“æ„åŒ–è¾“å‡ºï¼ˆStructured Outputï¼‰</h2>
                    <p>
                        ä½¿ç”¨ <code>with_structured_output()</code> æ–¹æ³•ç¡®ä¿æ¨¡å‹è¿”å›ç¬¦åˆæŒ‡å®šæ ¼å¼çš„æ•°æ®ï¼Œ
                        éå¸¸é€‚åˆéœ€è¦è§£æå’Œå¤„ç†æ¨¡å‹è¾“å‡ºçš„åœºæ™¯ã€‚
                    </p>

                    <h3 class="subsection-title">ä½¿ç”¨ Pydantic æ¨¡å‹</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty intermediate">ğŸŸ¡ ä¸­çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
ç»“æ„åŒ–è¾“å‡ºç¤ºä¾‹ï¼ˆPydanticï¼‰
åŠŸèƒ½ï¼šè®©æ¨¡å‹è¿”å›ç¬¦åˆ Pydantic æ¨¡å‹çš„ç»“æ„åŒ–æ•°æ®
"""
from langchain.chat_models import init_chat_model
from pydantic import BaseModel, Field

# å®šä¹‰è¾“å‡ºç»“æ„
class Movie(BaseModel):
    """ç”µå½±ä¿¡æ¯"""
    title: str = Field(..., description="ç”µå½±æ ‡é¢˜")
    year: int = Field(..., description="ä¸Šæ˜ å¹´ä»½")
    director: str = Field(..., description="å¯¼æ¼”å§“å")
    rating: float = Field(..., description="è¯„åˆ†ï¼ˆ1-10ï¼‰")
    summary: str = Field(..., description="ç®€çŸ­æ‘˜è¦")

# åˆå§‹åŒ–æ¨¡å‹
model = init_chat_model("gpt-4o")

# ç»‘å®šç»“æ„åŒ–è¾“å‡º
structured_model = model.with_structured_output(Movie)

# è°ƒç”¨ï¼ˆæ¨¡å‹ä¼šè¿”å› Movie å¯¹è±¡ï¼‰
result = structured_model.invoke("ç»™æˆ‘ã€Šç›—æ¢¦ç©ºé—´ã€‹çš„è¯¦ç»†ä¿¡æ¯")

# ç»“æœæ˜¯ Pydantic å¯¹è±¡
print(f"æ ‡é¢˜: {result.title}")
print(f"å¹´ä»½: {result.year}")
print(f"å¯¼æ¼”: {result.director}")
print(f"è¯„åˆ†: {result.rating}")
print(f"ç®€ä»‹: {result.summary}")</code></pre>
                    </div>

                    <h3 class="subsection-title">ä½¿ç”¨ TypedDict</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty intermediate">ğŸŸ¡ ä¸­çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
ç»“æ„åŒ–è¾“å‡ºç¤ºä¾‹ï¼ˆTypedDictï¼‰
åŠŸèƒ½ï¼šä½¿ç”¨ TypedDict å®šä¹‰è¾“å‡ºç»“æ„
"""
from typing_extensions import TypedDict, Annotated
from langchain.chat_models import init_chat_model

class MovieDict(TypedDict):
    """ç”µå½±ä¿¡æ¯å­—å…¸"""
    title: Annotated[str, "ç”µå½±æ ‡é¢˜"]
    year: Annotated[int, "ä¸Šæ˜ å¹´ä»½"]
    director: Annotated[str, "å¯¼æ¼”"]
    rating: Annotated[float, "è¯„åˆ†ï¼ˆ1-10ï¼‰"]

model = init_chat_model("claude-sonnet-4-5-20250929")
structured_model = model.with_structured_output(MovieDict)

result = structured_model.invoke("ã€Šæ˜Ÿé™…ç©¿è¶Šã€‹çš„ä¿¡æ¯")

# ç»“æœæ˜¯å­—å…¸
print(result)  # {"title": "æ˜Ÿé™…ç©¿è¶Š", "year": 2014, ...}</code></pre>
                    </div>

                    <h3 class="subsection-title">åŒ…å«åŸå§‹å“åº”</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python"># åŒæ—¶è¿”å›è§£æç»“æœå’ŒåŸå§‹å“åº”
structured_model = model.with_structured_output(Movie, include_raw=True)

result = structured_model.invoke("ã€Šç›—æ¢¦ç©ºé—´ã€‹ä¿¡æ¯")

# ç»“æœåŒ…å«ä¸‰ä¸ªå­—æ®µ
print(result["parsed"])         # Movie å¯¹è±¡
print(result["raw"])            # AIMessage åŸå§‹å“åº”
print(result["parsing_error"])  # è§£æé”™è¯¯ï¼ˆå¦‚æœ‰ï¼‰</code></pre>
                    </div>
                </section>

                <!-- é«˜çº§ç‰¹æ€§ -->
                <section class="content-section">
                    <h2 class="section-title">ğŸš€ é«˜çº§ç‰¹æ€§</h2>

                    <h3 class="subsection-title">åŠ¨æ€æ¨¡å‹åˆ‡æ¢</h3>
                    <p>åœ¨è¿è¡Œæ—¶åŠ¨æ€é€‰æ‹©ä¸åŒçš„æ¨¡å‹ï¼Œæ— éœ€ä¿®æ”¹ä»£ç ã€‚</p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty advanced">ğŸ”´ é«˜çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
åŠ¨æ€æ¨¡å‹åˆ‡æ¢ç¤ºä¾‹
åŠŸèƒ½ï¼šæ ¹æ®é…ç½®åŠ¨æ€é€‰æ‹©ä¸åŒæ¨¡å‹
"""
from langchain.chat_models import init_chat_model

# åˆ›å»ºå¯é…ç½®çš„æ¨¡å‹
configurable_model = init_chat_model(
    model="gpt-4o-mini",  # é»˜è®¤æ¨¡å‹
    temperature=0
)

# åœºæ™¯ 1ï¼šä½¿ç”¨é»˜è®¤æ¨¡å‹
response1 = configurable_model.invoke("ä½ çš„åå­—æ˜¯ä»€ä¹ˆï¼Ÿ")
print(f"é»˜è®¤æ¨¡å‹å“åº”: {response1.content}")

# åœºæ™¯ 2ï¼šè¿è¡Œæ—¶åˆ‡æ¢åˆ° GPT-4
response2 = configurable_model.invoke(
    "ä½ çš„åå­—æ˜¯ä»€ä¹ˆï¼Ÿ",
    config={"configurable": {"model": "gpt-4o"}}
)
print(f"GPT-4 å“åº”: {response2.content}")

# åœºæ™¯ 3ï¼šè¿è¡Œæ—¶åˆ‡æ¢åˆ° Claude
response3 = configurable_model.invoke(
    "ä½ çš„åå­—æ˜¯ä»€ä¹ˆï¼Ÿ",
    config={"configurable": {"model": "claude-sonnet-4-5-20250929"}}
)
print(f"Claude å“åº”: {response3.content}")</code></pre>
                    </div>

                    <h3 class="subsection-title">æ¨¡å‹é…ç½®æ–‡ä»¶ï¼ˆProfileï¼‰</h3>
                    <p>æŸ¥çœ‹æ¨¡å‹æ”¯æŒçš„åŠŸèƒ½å’Œé™åˆ¶ã€‚</p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">from langchain.chat_models import init_chat_model

model = init_chat_model("gpt-4o")

# æŸ¥çœ‹æ¨¡å‹é…ç½®
print(model.profile)

# è¾“å‡ºç¤ºä¾‹:
# {
#     "max_input_tokens": 128000,
#     "image_inputs": True,
#     "reasoning_output": True,
#     "tool_calling": True,
# }

# è‡ªå®šä¹‰é…ç½®æ–‡ä»¶
custom_model = init_chat_model(
    "custom-model",
    profile={
        "max_input_tokens": 100_000,
        "tool_calling": True,
        "image_inputs": False
    }
)</code></pre>
                    </div>

                    <h3 class="subsection-title">é€Ÿç‡é™åˆ¶</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
é€Ÿç‡é™åˆ¶ç¤ºä¾‹
åŠŸèƒ½ï¼šæ§åˆ¶ API è°ƒç”¨é¢‘ç‡
"""
from langchain_core.rate_limiters import InMemoryRateLimiter
from langchain.chat_models import init_chat_model

# åˆ›å»ºé€Ÿç‡é™åˆ¶å™¨ï¼ˆæ¯ç§’æœ€å¤š 0.1 ä¸ªè¯·æ±‚ï¼‰
rate_limiter = InMemoryRateLimiter(
    requests_per_second=0.1,     # æ¯ç§’è¯·æ±‚æ•°
    check_every_n_seconds=0.1,   # æ£€æŸ¥é—´éš”
    max_bucket_size=10,          # ä»¤ç‰Œæ¡¶å¤§å°
)

# åº”ç”¨é€Ÿç‡é™åˆ¶
model = init_chat_model("gpt-4o", rate_limiter=rate_limiter)

# è°ƒç”¨ä¼šè‡ªåŠ¨éµå®ˆé€Ÿç‡é™åˆ¶
for i in range(5):
    response = model.invoke(f"é—®é¢˜ {i+1}")
    print(f"å“åº” {i+1}: {response.content[:50]}...")</code></pre>
                    </div>

                    <h3 class="subsection-title">è‡ªå®šä¹‰ API ç«¯ç‚¹å’Œä»£ç†</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python"># ä½¿ç”¨è‡ªå®šä¹‰ API ç«¯ç‚¹ï¼ˆå…¼å®¹ OpenAI æ ¼å¼çš„ APIï¼‰
model = init_chat_model(
    model="custom-model-name",
    model_provider="openai",
    base_url="https://api.custom-provider.com/v1",
    api_key="your-custom-api-key"
)

# ä½¿ç”¨ HTTP ä»£ç†
from langchain_openai import ChatOpenAI

model = ChatOpenAI(
    model="gpt-4o",
    openai_proxy="http://proxy.example.com:8080"
)</code></pre>
                    </div>
                </section>

                <!-- ä½¿ç”¨é‡è¿½è¸ª -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ“Š ä½¿ç”¨é‡è¿½è¸ª</h2>
                    <p>ç›‘æ§ Token ä½¿ç”¨æƒ…å†µï¼Œä¼˜åŒ–æˆæœ¬å’Œæ€§èƒ½ã€‚</p>

                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <span class="code-difficulty intermediate">ğŸŸ¡ ä¸­çº§</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">"""
Token ä½¿ç”¨é‡è¿½è¸ªç¤ºä¾‹
åŠŸèƒ½ï¼šç›‘æ§å¤šæ¬¡è°ƒç”¨çš„ Token æ¶ˆè€—
"""
from langchain.chat_models import init_chat_model
from langchain_core.callbacks import get_usage_metadata_callback

model = init_chat_model("gpt-4o-mini")

# ä½¿ç”¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨è¿½è¸ªä½¿ç”¨é‡
with get_usage_metadata_callback() as callback:
    # ç¬¬ä¸€æ¬¡è°ƒç”¨
    response1 = model.invoke("ä»€ä¹ˆæ˜¯ LangChainï¼Ÿ")

    # ç¬¬äºŒæ¬¡è°ƒç”¨
    response2 = model.invoke("ä»€ä¹ˆæ˜¯ Agentï¼Ÿ")

    # ç¬¬ä¸‰æ¬¡è°ƒç”¨
    response3 = model.invoke("ä»€ä¹ˆæ˜¯ RAGï¼Ÿ")

    # æŸ¥çœ‹æ€»ä½¿ç”¨é‡
    usage = callback.usage_metadata
    print(f"\næ€»ä½¿ç”¨ç»Ÿè®¡:")
    print(f"  è¾“å…¥ Token: {usage['input_tokens']}")
    print(f"  è¾“å‡º Token: {usage['output_tokens']}")
    print(f"  æ€» Token: {usage['total_tokens']}")</code></pre>
                    </div>
                </section>

                <!-- å¸¸è§é—®é¢˜ -->
                <section class="content-section">
                    <h2 class="section-title">â“ å¸¸è§é—®é¢˜</h2>

                    <h3 class="subsection-subtitle">Q1: å¦‚ä½•é€‰æ‹©åˆé€‚çš„æ¨¡å‹ï¼Ÿ</h3>
                    <p>æ ¹æ®ä»¥ä¸‹å› ç´ é€‰æ‹©ï¼š</p>
                    <ul>
                        <li><strong>ä»»åŠ¡å¤æ‚åº¦</strong>ï¼šç®€å•ä»»åŠ¡ç”¨ mini/lite æ¨¡å‹ï¼Œå¤æ‚æ¨ç†ç”¨æ——èˆ°æ¨¡å‹</li>
                        <li><strong>æˆæœ¬</strong>ï¼šè¾ƒå°æ¨¡å‹æˆæœ¬æ›´ä½ï¼Œé€‚åˆå¤§é‡è°ƒç”¨</li>
                        <li><strong>é€Ÿåº¦</strong>ï¼šmini æ¨¡å‹å“åº”æ›´å¿«</li>
                        <li><strong>ç‰¹æ®ŠåŠŸèƒ½</strong>ï¼šæ£€æŸ¥æ¨¡å‹æ˜¯å¦æ”¯æŒå·¥å…·è°ƒç”¨ã€è§†è§‰è¾“å…¥ç­‰</li>
                    </ul>

                    <h3 class="subsection-subtitle">Q2: temperature å‚æ•°å¦‚ä½•è®¾ç½®ï¼Ÿ</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python"># temperature = 0ï¼šç¡®å®šæ€§è¾“å‡ºï¼Œé€‚åˆéœ€è¦ç¨³å®šç»“æœçš„åœºæ™¯
model_deterministic = init_chat_model("gpt-4o", temperature=0)

# temperature = 0.7ï¼šå¹³è¡¡åˆ›é€ æ€§å’Œå‡†ç¡®æ€§ï¼ˆé»˜è®¤å€¼ï¼‰
model_balanced = init_chat_model("gpt-4o", temperature=0.7)

# temperature = 1.0+ï¼šé«˜åˆ›é€ æ€§ï¼Œé€‚åˆåˆ›æ„å†™ä½œ
model_creative = init_chat_model("gpt-4o", temperature=1.2)</code></pre>
                    </div>

                    <h3 class="subsection-subtitle">Q3: å¦‚ä½•å¤„ç† API é”™è¯¯å’Œè¶…æ—¶ï¼Ÿ</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">from langchain.chat_models import init_chat_model

# é…ç½®é‡è¯•å’Œè¶…æ—¶
model = init_chat_model(
    "gpt-4o",
    timeout=60,        # 60 ç§’è¶…æ—¶
    max_retries=3      # å¤±è´¥åé‡è¯• 3 æ¬¡
)

# ä½¿ç”¨ try-except æ•è·é”™è¯¯
try:
    response = model.invoke("ä½ çš„é—®é¢˜")
except Exception as e:
    print(f"è°ƒç”¨å¤±è´¥: {e}")
    # å®ç°é™çº§é€»è¾‘
    fallback_model = init_chat_model("gpt-4o-mini")
    response = fallback_model.invoke("ä½ çš„é—®é¢˜")</code></pre>
                    </div>

                    <h3 class="subsection-subtitle">Q4: invoke() å’Œ stream() çš„æ€§èƒ½å·®å¼‚ï¼Ÿ</h3>
                    <p>
                        <strong>invoke()</strong>ï¼šç­‰å¾…å®Œæ•´å“åº”åè¿”å›ï¼Œé€‚åˆéäº¤äº’åœºæ™¯ã€‚<br>
                        <strong>stream()</strong>ï¼šé€å—è¿”å›ï¼Œç”¨æˆ·æ„ŸçŸ¥å»¶è¿Ÿæ›´ä½ï¼Œä½†æ€»ä½“ç½‘ç»œæ—¶é—´ç›¸è¿‘ã€‚
                        å¯¹äºèŠå¤©ç•Œé¢ï¼Œstream() èƒ½æä¾›æ›´å¥½çš„ç”¨æˆ·ä½“éªŒã€‚
                    </p>

                    <h3 class="subsection-subtitle">Q5: å¦‚ä½•åœ¨ Agent ä¸­ä½¿ç”¨ä¸åŒæ¨¡å‹ï¼Ÿ</h3>
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-language">Python</span>
                            <button class="copy-button">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre><code class="language-python">from langchain.agents import create_agent
from langchain.chat_models import init_chat_model

# ä¸º Agent æŒ‡å®šæ¨¡å‹
model = init_chat_model("claude-sonnet-4-5-20250929", temperature=0.1)

agent = create_agent(
    model=model,  # ä¼ å…¥é…ç½®å¥½çš„æ¨¡å‹å®ä¾‹
    tools=[...],
    system_prompt="..."
)</code></pre>
                    </div>
                </section>

                <!-- å‚è€ƒèµ„æº -->
                <section class="content-section">
                    <h2 class="section-title">ğŸ”— å‚è€ƒèµ„æº</h2>
                    <ul>
                        <li>
                            <a href="https://docs.langchain.com/oss/python/langchain/models" target="_blank">
                                LangChain å®˜æ–¹ Models æ–‡æ¡£
                            </a>
                        </li>
                        <li>
                            <a href="https://python.langchain.com/docs/integrations/chat/" target="_blank">
                                Chat Models é›†æˆåˆ—è¡¨
                            </a>
                        </li>
                        <li>
                            <a href="https://python.langchain.com/docs/how_to/#chat-models" target="_blank">
                                Chat Models ä½¿ç”¨æŒ‡å—
                            </a>
                        </li>
                        <li>
                            <a href="https://reference.langchain.com/python/langchain/chat_models.html" target="_blank">
                                API å‚è€ƒæ–‡æ¡£
                            </a>
                        </li>
                    </ul>
                </section>

                <!-- é¡µé¢å¯¼èˆª -->
                                <nav class="page-navigation">
                    <a href="02-architecture.html" class="nav-button prev">
                        â† ä¸Šä¸€é¡µ:æ ¸å¿ƒæ¶æ„
                    </a>
                    <a href="04-messages.html" class="nav-button next">
                        ä¸‹ä¸€é¡µ:æ¶ˆæ¯ç³»ç»Ÿ â†’
                    </a>
                </nav>
            </div>
        </main>
    </div>

    <!-- è¿”å›é¡¶éƒ¨æŒ‰é’® -->
    <button class="back-to-top" aria-label="è¿”å›é¡¶éƒ¨">â†‘</button>

    <!-- JavaScript -->
    <script src="assets/js/mermaid-init.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
</body>
</html>
